<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
    <title>PolyQuery</title>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <style type="text/css">
        @import "//ajax.googleapis.com/ajax/libs/dojo/1.10.3/dojo/resources/dojo.css";
        @import "//ajax.googleapis.com/ajax/libs/dojo/1.10.3/dijit/themes/claro/claro.css";
        @import "//ajax.googleapis.com/ajax/libs/dojo/1.10.3/dojox/grid/resources/claroGrid.css";
		@import "//ajax.googleapis.com/ajax/libs/dojo/1.10.3/dojox/grid/enhanced/resources/claro/EnhancedGrid.css";
		@import "//ajax.googleapis.com/ajax/libs/dojo/1.10.3/dojox/grid/enhanced/resources/EnhancedGrid_rtl.css";
        @import "../css/polycss/myMblSwitch.css";
        @import "../css/polycss/header-footer.css";
        @import "../css/polycss/general.css";
        @import "../css/polycss/button.css";
        @import "../css/polycss/filter.css";
        @import "../css/polycss/login.css";
        @import "../viewer/viewer.css";
        @import "../js/cbtree/themes/claro/claro.css";

        body, html {
            margin:0; padding:0; width:100%; background:#fff;
            font-family: Helvetica,Verdana,Arial,sans-serif;
            font-size : 11px;
            color:#000;
            margin:0; padding:0; width:100%; background:#fff;
        }

        .claro .dijitArrowButtonInner {
            width: 15px;
            height: 15px;
            margin: 0 auto;
            background-repeat: no-repeat;
            background-position: -51px 53%;
            vertical-align:middle;
        }

        .claro #toolbar.dijitToolbar {
            height: 50px;
            background-image: url(/icons/Polyicons/subtitle_greyblack.png);
            background-repeat: repeat-x;
        }
                
        .dijitTextBox {
            border: 1px double #BFBFBF;
            border-radius: 10px;
            height: 15px;
            vertical-align: middle;
            padding-left:15px;
            padding-top:1px;
            padding-right:5px;
            width: 15em;
            height:20;
            font-size:9px;
            font-style:italic;
        }

        .mblToolBarButtonDisabled {
            opacity: 0.5;
        } 
        
        .blueButton {
			border-radius: 10px;
			border-color: white;
			background-image: url(images/red-button-bg.png);
			background: -webkit-gradient(linear, left top, left bottom, from(#1e5799), to(#7db9e8), color-stop(0.5, #7db9e8), color-stop(0.5, #1e5799));
		}
        
        .redButton {
			border-radius: 10px;
			border-color: #cc3333;
			background-image: url(images/red-button-bg.png);
			background: -webkit-gradient(linear, left top, left bottom, from(#D3656D), to(#BC1320), color-stop(0.5, #C9404B), color-stop(0.5, #BC1421));
		}
		.redButtonSelected {
			border-radius: 10px;
			background-image: url(images/red-button-sel-bg.png);
			background: -webkit-gradient(linear, left top, left bottom, from(#AF333C), to(#880E17), color-stop(0.5, #952B33), color-stop(0.5, #870F18));
		}
		.no-click {
		    pointer-events: none;
		}
    </style>
    
    <script>
        dojoConfig = {
            isDebug: true,
            parseOnLoad: true,
            packages: [
              { name: "cbtree", location: "/polyweb/js/cbtree" }
            ]
           
        };
    </script>
    <!--
    <script type="text/javascript" src="//d3js.org/d3.v3.js"></script>
    <script type='text/javascript' src="http://bost.ocks.org/mike/fisheye/fisheye.js?0.0.3"> </script>
    <style type="text/css">
        .link {
          stroke: #ccc;
        }
        
        .node text {
          pointer-events: none;
          font: 10px sans-serif;
        }
    </style>
    -->
    
    <!-- jQuery UI CSS -->
    <link rel="stylesheet" type="text/css" href="https://ajax.googleapis.com/ajax/libs/jqueryui/1.11.2/themes/smoothness/jquery-ui.css"/>

    <!-- Font Awesome CSS -->
    <link rel="stylesheet" type="text/css" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.2.0/css/font-awesome.min.css"/>

    <!-- IGV CSS -->
    <script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
    <script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.11.2/jquery-ui.min.js"></script>
    <script type="text/javascript" src="../js/igv/igv-1.0.9.js" djConfig="parseOnLoad: true"></script>
    <link rel="stylesheet" type="text/css" href="../js/igv/igv-1.0.9.css">        
    
    <script src="//ajax.googleapis.com/ajax/libs/dojo/1.13.0/dojo/dojo.js" type="text/javascript"></script>
    <script type="text/javascript" src="../js/polyjs/include.js"> </script>
    <script type="text/javascript" src="../js/polyjs//Utility/vpVector.js" ></script>
    <script type="text/javascript" src="../js/polyjs/Utility/viewVarVector.js" ></script>
    <script type="text/javascript" src="../js/polyjs/Utility/utilGrid2.js"  ></script>
    <script type="text/javascript" src="../js/polyjs/Utility/TableFilter2.js"  ></script>
    <script type="text/javascript" src="../js/polyjs/changeStatus.js"></script>
    <script type="text/javascript" src="../viewer/viewer.js"  >    </script>
    <script type="text/javascript" src="../js/polyjs/Utility/my_formatter.js"  ></script>
    <script type="text/javascript" src="../js/polyjs/layoutVarVector.js"  ></script>
    <script type="text/javascript" src="../viewer/patient.js"  ></script>
    <script type="text/javascript" src="../viewer/viewer.js"  >    </script>
    <script type="text/javascript" src="../js/polyjs/Utility/waiting.js"  ></script>
    <script type="text/javascript" src="../js/polyjs/igv_methods.js"  ></script>
        <script type="text/javascript" src="../js/polyjs/igv_view_methods.js" djConfig="parseOnLoad: true"></script>
    <script type="text/javascript" src="../viewer/variation.js"  ></script>
    <script type="text/javascript" src="../viewer/cnv.js"  ></script>
    <script type="text/javascript" src="../viewer/indicator.js"  ></script>
    <script type="text/javascript" src="../viewer/transcript.js"  ></script>
    
    <script type="text/javascript">
    
dojo.require("dojox.widget.DialogSimple");
dojo.require("dojox.widget.Dialog");
dojo.require("dojo.fx.easing");
dojo.require("dijit.Dialog");
dojo.require("dojox.grid.DataGrid");
dojo.require("dojox.grid.EnhancedGrid");
dojo.require("dojox.grid.enhanced.plugins.NestedSorting");
dojo.require("dojox.grid.enhanced.plugins.IndirectSelection");
dojo.require("dojo.data.ItemFileReadStore");
dojo.require("dojo.data.ItemFileWriteStore");
dojo.require("dojo.parser");    
dojo.require("dijit.layout.BorderContainer");
dojo.require("dijit.layout.SplitContainer");
dojo.require("dijit.form.Button");
dojo.require("dijit.layout.TabContainer");
dojo.require("dijit.form.FilteringSelect");
dojo.require("dijit.form.ComboBox");
dojo.require("dijit.Dialog");
dojo.require("dojox.gfx");
dojo.require("dojo.colors");
dojo.require("dojo.data.ItemFileReadStore");
dojo.require("dijit.form.NumberTextBox");
dojo.require("dijit.form.SimpleTextarea");
dojo.require("dijit.form.Select");
dojo.require("dijit.layout.AccordionContainer");
dojo.require("dijit.form.Form");
dojo.require("dijit.Toolbar");
dojo.require("dijit.form.MultiSelect");
//dojo.require("dijit.form.CheckBox");
dojo.require("dijit.form.NumberSpinner");
dojo.require("dijit.Tree");
dojo.require("dijit.Menu");
dojo.require("dojox.widget.PlaceholderMenuItem");
dojo.require("dijit.form.Slider");
dojo.require("dijit.TitlePane");
dojo.require("dojo.store.JsonRest");
dojo.require("dojo.store.Cache");
dojo.require("dojox.mobile");
dojo.require("dojox.mobile.parser"); 
dojo.require("dojox.mobile.Switch"); 
dojo.require("dijit.registry");
dojo.require("dijit.Tooltip");
dojo.require("dojo.promise.all");
dojo.require("dojo.Deferred");
dojo.require("dojo.dom");
dojo.require("dojo.on");
dojo.require("dojo.json");
dojo.require("dojo.domReady!");
dojo.require("dojox.grid.cells");
dojo.require("dojo.dom-construct");

require(["dojo/parser", "dijit/MenuBar", "dijit/MenuBarItem", "dijit/PopupMenuBarItem", "dijit/DropDownMenu", "dijit/MenuItem"]);
//recupration des valeurs contenues dans les input cachs (cf title.html)
var projectName = param("project");
document.title = "PolyQuery [" + projectName + "]";
var project_type = param("type");
var use_args = param("use_args");
var max_project;
var projectId;//parent.haut.document.getElementById('project_id').value;
var user_name;// = dojo.cookie("username");
//definition des diffrentes url pour rcuprer les donnes grace aux cgi
//var geneurl = url_cache+"?type=genes&project="+projectName;
var gene_url = url_cache_gene_vector+"?project="+projectName+"&type=genes";//&filter_public=new&filter_consequence=coding";
var patient_url = url_cache_gene_vector+"?project="+projectName+"&type=genes&stat=patient";
var diseases_tree_url = url_cache_gene_vector+"?project="+projectName+"&type=genes&stat=diseases";
var button_url = url_cache_gene_vector+"?project="+projectName+"&type=genes&stat=button";
var region_url = url_cache_gene_vector+"?project="+projectName+"&type=genes&stat=region";
var cache_all_url =  url_cache_gene_vector+"?project="+projectName+"&stat=all";
var chr_url =  url_cache_gene_vector+"?project="+projectName+"&type=genes&stat=gene";
var staturl = url_cache_gene_vector+"?project="+projectName+"&stat=gene";//&filter_public=new&filter_consequence=coding";
var staturlpatient = url_cache_gene_vector+"?project="+projectName+"&type=genes&stat=patient";
var is_cache_url = is_cache+"?project="+projectName+"&type=all";
var geneexporturl = url_query+"?type=gene&projectName="+projectName+"&xls=1";
url_view_filter_vector += "?project="+projectName;
url_region += "?project="+projectName;
var selectGene="toto";
var reference="titi";
var show_graph = 0;
url_get_filter += "?project="+projectName+"&user=";//+user_name;
var use_freq = 0;
var famind = 'Ind';
var patients_status = new Array();
var families_status = new Array();
var ped_modified = 0;

/****************************************************
 * 
 * LAYOUTS
 * 
*****************************************************/
var layoutChromosome = [
    { name: "N", field: "name", width:"5px", styles: 'text-align:center;display:none;'},  
    { name: "Chr",field: "id",  width: "10%", styles: 'text-align:center;'},
    { name: "Genes ",field: "genes", width: "25%" , styles: 'text-align:center;'},
    { name: "Sub",field: "substitutions", width: "25%" , styles: 'text-align:center;'},
    { name: "Del",field: "deletions", width: "18%" , styles: 'text-align:center;'},
    { name: "Ins",field: "insertions", width: "18%" , styles: 'text-align:center;'},
    { name: "Cnv",field: "cnvs", width: "18%" , styles: 'text-align:center;'},
    
    { name: "He",field: "heterozygote", width: "15%" , styles: 'text-align:center;display:none;' },
    { name: "Ho",field: "homozygote", width: "15%" , styles: 'text-align:center;display:none;'},
    { name: "Cache",field: "vector_cache", width: "15%" , styles: 'text-align:center;display:none;'},
    { name: "Size",field: "vector_size", width: "15%" , styles: 'text-align:center;display:none;'},
    { name: "Enum",field: "vector_enum", width: "15%" , styles: 'text-align:center;display:none;'},
 ];
            
 var layoutRegion = [
    { name: "Row", get: getRow, width: "3em",styles: 'font-size:8px;text-align:center;display:none;'},
    { name: "Chr",field: "chromosome",  width: "10%", styles: 'font-size:8px;text-align:center;'},
    { name: "Start",field: "start", width: "10%" , styles: 'font-size:8px;text-align:center;'},
    { name: "End",field: "end", width: "10%" , styles: 'font-size:8px;text-align:center;'},
    { name: "Genes ",field: "genes", width: "10%" , styles: 'font-size:8px;text-align:center;'},
    { name: "Sub",field: "substitution", width: "20%" , styles: 'font-size:8px;text-align:center;'},
    { name: "Del",field: "deletion", width: "15%" , styles: 'font-size:8px;text-align:center;'},
    { name: "Ins",field: "insertion", width: "15%" , styles: 'font-size:8px;text-align:center;'},
    { field: 'include', name: 'Sl.',formatter:formatInclude, width: "10%", styles: 'font-size:8px;text-align:center;'},   
];

var layoutGridGenesUser = [
// { name: "Row", get: getRow, width: "3em",styles: 'font-size:8px;text-align:center;'},
// { field: 'found', name: 'Found',width: "25%", styles: 'text-align:center;', formatter:dejavu_genes}, 
 { field: 'name', name: 'Gene Name',width: "65%", styles: 'text-align:center;'}, 
];

var layoutGridRegionsHoRec = [
 { field: 'chr', name: 'Chr',width: "10%", styles: 'text-align:center;', formatter:formatColorCell}, 
 { field: 'start', name: 'Start',width: "12%", styles: 'text-align:center;', formatter:formatColorCell}, 
 { field: 'end', name: 'End',width: "12%", styles: 'text-align:center;', formatter:formatColorCell},
 { field: 'fam', name: 'Family',width: "20%", styles: 'text-align:center;', formatter:formatColorCell},
 { field: 'name', name: 'Patient',width: "20%", styles: 'text-align:center;', formatter:formatColorCell},
 { field: 'status', name: 'St',width: "5%", styles: 'text-align:center;', formatter:formatDisease2}, 
 { field: 'length', name: 'Length',width: "12%", styles: 'text-align:center;', formatter:formatColorCell}, 
 { field: 'nb_var_ho_before', name: 'Nb Var Ho (Before Filters)',width: "10%", styles: 'text-align:center;', formatter:formatColorCell}, 
 { field: 'nb_var_ho_after', name: 'Nb Var Ho (After Filters)',width: "10%", styles: 'text-align:center;', formatter:formatColorCell},
 { field: 'has_gene_diag', name: 'Gene(s) in Diag Capture',width: "8%", styles: 'text-align:center;', formatter:dejavu_capture_diag},
 { field: 'is_omim', name: 'Gene(s) in Omim',width: "8%", styles: 'text-align:center;', formatter:dejavu_capture_diag},
 { field: 'link_ucsc', name: ' ',width: "5%", styles: 'text-align:center;', formatter:formatHoRegionUcsc}, 
 { field: 'link_ensembl', name: ' ',width: "8%", styles: 'text-align:center;', formatter:formatHoRegionEnsembl}, 
];

var layoutGridCommonPatients = [
 { name: "Row", get: getRow, width: "3em",styles: 'font-size:8px;text-align:center;'},
 { field: 'fam', name: 'Family',width: "25%", styles: 'text-align:center;',}, 
 { field: 'name', name: 'Name',width: "65%", styles: 'text-align:center;'}, 
];

 var layoutCaptures = [
    { name: "Row", get: getRow, width: "3em",styles: 'font-size:8px;text-align:center;display:none;'},
    { name: "Name",field: "name",  width: "30%", styles: 'font-size:8px;text-align:center;'},
    { name: "Description",field: "description", width: "70%" , styles: 'font-size:8px;text-align:center;'},
];

var layoutViewFilter = [
 { field: 'name', name: 'name',width: "25%", styles: 'text-align:center;'}, 
 { field: 'value', name: 'value',width: "70%", styles: 'text-align:center;'}, 
];

var layoutViewCapture = [
 { name: "Row", get: getRow, width: "3em",styles: 'font-size:8px;text-align:center;'},
 { field: 'name', name: 'Gene Name',width: "75%", styles: 'text-align:center;'}, 
 { field: 'in_analyse', name: ' ',width: "15%", styles: 'text-align:center;', formatter:formatShowYourVariations}, 
];

var store_region;

var layoutGroups = [
    { name: "Gr",field: "name",  width: "20%", styles: 'text-align:center;'},      
    { name: "Pat",field: "nb", width:  "7%", styles: 'text-align:center;'},
    { name: "Sub",field: "substitution", width:  "15%", styles: 'text-align:center;'},
    { name: "Del",field: "deletion", width:  "13%", styles: 'text-align:center;'},
    { name: "Ins",field: "insertion", width:  "12%", styles: 'text-align:center;'},
    { name: "Gene",field: "genes", width:  "12%", styles: 'text-align:center;'},
    { field: 'include', name: 'Sl.',formatter:formatInclude, width:  "6%", styles: 'text-align: center;'},  
    { name: "Model",field: "model", width:  "14%", styles: 'text-align:center;'},
];

var layoutFamilies = [
    { name:' ', field: 'found',width: "5%", styles: 'text-align:center;', formatter:dejavu_genes},
    { name: "Fam",field: "name",  width: "16%", styles: 'text-align:center;'},      
    { name: "Pat",field: "nb", width:  "7%", styles: 'text-align:center;'},
    { name: "Sub",field: "substitution", width:  "15%", styles: 'text-align:center;'},
    { name: "Del",field: "deletion", width:  "11%", styles: 'text-align:center;'},
    { name: "Ins",field: "insertion", width:  "10%", styles: 'text-align:center;'},
    { name: "Cnv",field: "cnv", width:  "10%", styles: 'text-align:center;'},
    { name: "Gene",field: "genes", width:  "12%", styles: 'text-align:center;'},
    { field: 'include', name: 'Sl.',formatter:formatInclude, width:  "6%", styles: 'text-align: center;'},  
    { name: "Model",field: "model", width:  "14%", styles: 'text-align:center;'},
];

var structure_name = 'layoutPatient';

var layoutPatient = [
    { name: ' ', field: 'found',width: "5%", styles: 'text-align:center;', formatter:dejavu_genes},
    { name: "N", get: getRow, width:"5%", styles: 'text-align:center;display:none;'},        
    { name: "bam", field: "bam", width:"5%", styles: 'text-align:center;display:none;'},  
    { name: "Patients",field: "name",  width:"15%", styles: 'text-align:center;'},      
    { name: "Sub",field: "substitutions", width: "10%", styles: 'text-align:center;'},
    { name: "Del",field: "deletions", width: "5%", styles: 'text-align:center;'},
    { name: "Ins",field: "insertions", width: "5%", styles: 'text-align:center;'},
    { name: "He",field: "heterozygote", width: "5%", styles: 'text-align:center;'}, 
    { name: "Ho",field: "homozygote", width: "5%", styles: 'text-align:center;'},
    { name: "Genes",field: "genes", width: "7%", styles: 'text-align:center;'}, 
    //{ name: "Comp",field: "composite", width: "7%", styles: 'text-align:center;'},
    { name: "Cov",field: "coverage", width: "6%", styles: 'text-align:center;'},
    { name: "15x",field: "15x", width: "5%", styles: 'text-align:center;'},
    { name: "30x",field: "30x", width: "5%", styles: 'text-align:center;'},
    { field: "filter_heho",name: 'He',formatter:formathe, width: "5%", styles: 'text-align: center;'},
    { field: "filter_heho",name: 'Ho',formatter:formatho, width: "5%", styles: 'text-align: center;'},
    { field: 'include', name: 'Sl.',formatter:formatInclude, width: "5%", styles: 'text-align: center;'},
];
    
var layoutPatient_fam_somatic = [
    { name:' ', field: 'found',width: "5%", styles: 'text-align:center;', formatter:dejavu_genes},
    { name: "N", get: getRow, width:"5%", styles: 'text-align:center;display:none;'},       
    { name: "bam", field: "bam", width:"5%", styles: 'text-align:center;display:none;'},  
    { field: "fam",name: 'Fam', width:"5%", styles: 'text-align: center;'}, 
    { field: "group",name: 'Group', width:"5%", styles: 'text-align: center;'}, 
    { name: "Patients",field: "name",  width:"7%", styles: 'text-align:center;'},
    { field: "child",name: 'Ped', width:"6%", formatter:formatChild,styles: 'text-align: center;'},
    { field: "status",name: 'St', width:"6%",formatter:formatDisease, styles: 'text-align: center;'},           
    { field: "tissue",name: 'Tis', width:"6%", styles: 'text-align: center;'},  
    { name: "Sub",field: "substitutions", width:"5%", styles: 'text-align:center;'},
    { name: "Del",field: "deletions", width:"5%", styles: 'text-align:center;'},
    { name: "Ins",field: "insertions", width:"5%", styles: 'text-align:center;'},
    { name: "Cnv",field: "cnvs", width:"5%", styles: 'text-align:center;'},
    { name: "He",field: "heterozygote", width:"5%", styles: 'text-align:center;'},  
    { name: "Ho",field: "homozygote", width:"5%", styles: 'text-align:center;'},
    { name: "Genes",field: "genes", width:"5%", styles: 'text-align:center;'},  
    //{ name: "Comp",field: "composite", width:"5%", styles: 'text-align:center;'},
    { name: "Cov",field: "coverage", width:"5%", styles: 'text-align:center;'},
    { name: "15x",field: "15x", width: "5%", styles: 'text-align:center;'},
    { name: "30x",field: "30x", width: "5%", styles: 'text-align:center;'},
    { field: "filter_heho",name: 'He',formatter:formathe, width:"5%", styles: 'text-align: center;'},
    { field: "filter_heho",name: 'Ho',formatter:formatho, width:"5%", styles: 'text-align: center;'},
    { field: 'include', name: 'Sl.',formatter:formatInclude, width:"5%", styles: 'text-align: center;'},    
];
    
var layoutPatient_fam = [
    { name:' ', field: 'found',width: "5%", styles: 'text-align:center;', formatter:dejavu_genes},
    { name: "N", get: getRow, width:"3%", styles: 'text-align:center;display:none;'},       
    { name: "bam", field: "bam", width:"5%", styles: 'text-align:center;display:none;'},      
    //{ field: 'include', name: 'Sl.f',formatter:formatIncludeF, width: 2, styles: 'text-align: center;'},
    { field: "fam",name: 'Fam', width:"7%", styles: 'text-align: center;'}, 
    { name: "Patients",field: "name",  width:"10%", styles: 'text-align:center;'},
    { field: "child",name: 'Ped', width:"5%", formatter:formatChild,styles: 'text-align: center;'},
    { field: "status",name: 'St', width:"4%",formatter:formatDisease, styles: 'text-align: center;'},           
    { name: "Sub",field: "substitutions", width:"10%", styles: 'text-align:center;'},
    { name: "Del",field: "deletions", width:"7%", styles: 'text-align:center;'},
    { name: "Ins",field: "insertions", width:"7%", styles: 'text-align:center;'},
    { name: "Cnv",field: "cnvs", width:"5%", styles: 'text-align:center;'},
    { name: "Ho",field: "homozygote", width:"7%", styles: 'text-align:center;'},
    { name: "He",field: "heterozygote", width:"7%", styles: 'text-align:center;'},
    { name: "Genes",field: "genes", width:"7%", styles: 'text-align:center;'},  
    //{ name: "Comp",field: "composite", width: "3em", styles: 'text-align:center;'},
    { name: "Cov",field: "coverage", width:"5%", styles: 'text-align:center;'},
    { name: "15x",field: "15x", width: "5%", styles: 'text-align:center;'},
    { name: "30x",field: "30x", width: "5%", styles: 'text-align:center;'},
    { field: "filter_heho",name: 'He',formatter:formathe, width:"3%", styles: 'text-align: center;'},
    { field: "filter_heho",name: 'Ho',formatter:formatho, width:"3%", styles: 'text-align: center;'},
    { field: 'include', name: 'Sl',formatter:formatInclude, width:"3%", styles: 'text-align: center;'}, 
];
    
var layoutPatient_group = [
    { name:' ', field: 'found',width: "5%", styles: 'text-align:center;', formatter:dejavu_genes},    
    { name: "bam", field: "bam", width:"5%", styles: 'text-align:center;display:none;'},  
    { field: "fam",name: 'Fam', width:"5%", styles: 'text-align: center;'}, 
    { field: "group",name: 'group', width:"5%", styles: 'text-align: center;'}, 
    { name: "Patients",field: "name",  width:"10%", styles: 'text-align:center;'},
    { field: "status",name: 'St', width:"5%", formatter:formatDisease, styles: 'text-align: center;'},           
    { name: "Sub",field: "substitutions", width:"5%", styles: 'text-align:center;'},
    { name: "Del",field: "deletions", width:"5%", styles: 'text-align:center;'},
    { name: "Ins",field: "insertions", width:"5%", styles: 'text-align:center;'},
    { name: "Cnv",field: "cnvs", width:"5%", styles: 'text-align:center;'},
    { name: "Ho",field: "homozygote", width:"5%", styles: 'text-align:center;'},
    { name: "He",field: "heterozygote", width:"5%", styles: 'text-align:center;'}, 
    { name: "Genes",field: "genes", width:"5%", styles: 'text-align:center;'},  
    //{ name: "Comp",field: "composite", width:"5%", styles: 'text-align:center;'},
    { name: "Cov",field: "coverage", width:"5%", styles: 'text-align:center;'},
    { name: "15x",field: "15x", width: "5%", styles: 'text-align:center;'},
    { name: "30x",field: "30x", width: "5%", styles: 'text-align:center;'},
    { field: "filter_heho",name: 'he',formatter:formathe, width:"5%", styles: 'text-align: center;'},
    { field: "filter_heho",name: 'ho',formatter:formatho, width:"5%", styles: 'text-align: center;'},
    { field: 'include', name: 'Sl.',formatter:formatInclude, width:"5%", styles: 'text-align: center;'},    
];  
    
var layoutPatient_somatic = [
    { name:' ', field: 'found',width: "5%", styles: 'text-align:center;', formatter:dejavu_genes},
    { name: "N", get: getRow, width:"5%", styles: 'text-align:center;'},        
    { name: "bam", field: "bam", width:"5%", styles: 'text-align:center;display:none;'},  
    { field: "group",name: 'group', width:"5%", styles: 'text-align: center;'}, 
    { name: "Patients",field: "name",  width:"10%", styles: 'text-align:center;'},
    { field: "tissue",name: 'tissue', width:"5%", styles: 'text-align: center;'},           
    { name: "Sub",field: "substitutions", width:"5%", styles: 'text-align:center;'},
    { name: "Del",field: "deletions", width:"5%", styles: 'text-align:center;'},
    { name: "Ins",field: "insertions", width:"5%", styles: 'text-align:center;'},
    { name: "Cnv",field: "cnvs", width:"5%", styles: 'text-align:center;'},
    { name: "He",field: "heterozygote", width:"5%", styles: 'text-align:center;'}, 
    { name: "Ho",field: "homozygote", width:"5%", styles: 'text-align:center;'},
    { name: "Genes",field: "genes", width:"5%", styles: 'text-align:center;'},  
    //{ name: "Comp",field: "composite", width:"5%", styles: 'text-align:center;'},
    { name: "Cov",field: "coverage", width:"5%", styles: 'text-align:center;'},
    { name: "15x",field: "15x", width: "5%", styles: 'text-align:center;'},
    { name: "30x",field: "30x", width: "5%", styles: 'text-align:center;'},
    { field: "filter_heho",name: 'he',formatter:formathe, width:"5%", styles: 'text-align: center;'},
    { field: "filter_heho",name: 'ho',formatter:formatho, width:"5%", styles: 'text-align: center;'},
    { field: 'include', name: 'Sl.',formatter:formatInclude, width:"5%", styles: 'text-align: center;'},   
];  

var layoutFilter = [
    { name: "id",field: "id" , width: "15%", styles: 'text-align:center;'},     
    { name: "Filter",field: "name",  width: "50%", styles: 'text-align:center;'},
    { name: "date",field: "date",  width: "35%", styles: 'text-align:center;'}              
];

var layoutEdit;
require([ "dojox/grid/DataGrid", "dojox/grid/cells", "dojox/grid/cells/dijit","dijit/form/HorizontalSlider", "dojo/domReady!" ],
    function(DataGrid, cells, cellsDijit, HorizontalSlider){
        layoutEdit = [{
            defaultCell: { width: "25%", editable: true, type: cells._Widget, styles: 'text-align: center;'  },
            cells: [
                { name: 'Patient Name', field: 'name', editable: false },
                { name: 'Family Name', field: 'fam', editable: true },
                { name: 'Sex', field: 'child', type: cells.ComboBox, options: ["M","F","C1","C2"], formatter: formatChild },
                { name: 'Status', field: 'status', type: cells.ComboBox, options: ["1","2"], formatter: formatDisease },
            ]
        }];
    }
);

var layoutGroupEdit;
require([ "dojox/grid/DataGrid", "dojox/grid/cells", "dojox/grid/cells/dijit","dijit/form/HorizontalSlider", "dojo/domReady!" ],
    function(DataGrid, cells, cellsDijit, HorizontalSlider){
        layoutGroupEdit = [{
            defaultCell: { width: "20%", editable: true, type: cells._Widget, styles: 'text-align: center;'  },
            cells: [
                { name: 'Patient Name', field: 'name', editable: false },
                { name: 'Family Name', field: 'fam', editable: true },
                { name: 'Group Name', field: 'group' },
                { name: 'Sex', field: 'child', type: cells.ComboBox, options: ["M","F","C1","C2"], formatter: formatChild },
                { name: 'Status', field: 'status', type: cells.ComboBox, options: ["1","2"], formatter: formatDisease },
            ]
        }];
    }
);


var hash_button_always_disabled = {};
function exclude_functions_for_old_project() {
	dijit.byId('filter_predicted_splice_site').set('checked', false);
	dijit.byId('filter_predicted_splice_site').set('disabled', true);
	hash_button_always_disabled['filter_predicted_splice_site'] = 'not';
	dijit.byId('filter_predicted_splice_site_init').set('checked', false);
	dijit.byId('filter_predicted_splice_site_init').set('disabled', true);
	hash_button_always_disabled['filter_predicted_splice_site_init'] = 'not';
	dijit.byId('filter_predicted_splice_site_2').set('checked', false);
	dijit.byId('filter_predicted_splice_site_2').set('disabled', true);
	hash_button_always_disabled['filter_predicted_splice_site_2'] = 'not';
    dijit.byId("slider_ratio_min").set("value", 1);
	dijit.byId('slider_ratio_min').set('disabled', true);
	dijit.byId("slider_ratio_max").set("value", 5);
	dijit.byId('slider_ratio_max').set('disabled', true);
}


var tree_diseases;  
var testStore; 
var is_somatic_project = 0;

var can_search_ho_rec;
function searchElemInGridHoRec() {
	hashIdsShown = [];
	var input = document.getElementById('text_search_region_ho_rec');
	var filters = input.value.toUpperCase();
	filters = filters.toUpperCase();
	if (can_search_ho_rec == 'patient') { gridRegionsHoRec.filter({name: new RegExp(filters)}); }
    if (can_search_ho_rec == 'family')  { gridRegionsHoRec.filter({fam: new RegExp(filters)}); }
}

function disable_mbl_switch_button(b_name) {
    require(["dojo/dom-class"], function(domClass){
        domClass.add(dijit.byId(b_name).domNode, "mblToolBarButtonDisabled");
    });
}

function addBedFile() {
	dijit.byId('waiting').show();
	const selectedFile = document.getElementById("inputBed").files[0];
	var txt_bed;
	if (selectedFile) {
	    var reader = new FileReader();
	    reader.readAsText(selectedFile, "UTF-8");
	    reader.onload = function (evt) {
	        txt_bed = evt.target.result;
	        split_and_savebed_content(selectedFile.name, txt_bed);
	        
	    }
	    reader.onerror = function (evt) {
			dijit.byId('waiting').hide();
	        alert("error reading BED  file");
	    }
	}
}



var max_bed_part;
function split_and_savebed_content (selectedFile, txt_bed) {
	var reg = new RegExp(/[\n]+/, "g");
    var tableau = txt_bed.split(reg);
    var nb = 0;
    var nb_part = 1;
    var txt_bed_part = '';
    var list_jobs = [];
    var nb_length = tableau.length;
    if (nb_length < 500) { max_bed_part = 1; }
    else { max_bed_part = nb_length / 500; }
    for (var i=0; i<nb_length; i++) {
        nb++;
        var line = tableau[i];
		line = line.replace(/\s+/g, '_');
        txt_bed_part += "," + line;
        if (nb == 500) {
    		save_bed_file(selectedFile, txt_bed_part, nb_part, 0);
        	txt_bed_part = '';
        	nb_part++;
        	nb = 0;
        }
    }
   	save_bed_file(selectedFile, txt_bed_part, nb_part, 1);
}

function save_bed_file(selectedFile, txt_bed, nb_part, is_last) {
	dijit.byId('waiting').show();
    txt_bed = txt_bed.replace(/\n/g, ',');
	txt_bed = txt_bed.replace(/\s+/g, '_')
	var url = url_path + "json_output_nodb/save_bed.pl?project_name=" + projectName;
	url += '&bed_file_name=' + selectedFile + '.part' + nb_part;
	if (is_last == 1) {
		url += '&is_last=1';
	}
	url += '&content=' + txt_bed;
	var xhrArgs = {
        handleAs: "json",
        url: url,
        load: function(data) {
			var file_name = data.file;
			if (nb_part == parseInt(max_bed_part)) {
				dijit.byId('waiting').hide();
			    var txt_file = "file:"+selectedFile+"\t.\t.";
			    addRegion('[\n]+','[ \t]+',txt_file);
			}
        },
        error: function(error) {
            alert("error");
        }
	};
	var deferred = dojo.xhrGet(xhrArgs);
}
     
     
     
     
     
     
        
function launch_web_igv() {
    var items = [];
    var this_project_name;
    items = gridPatient.selection.getSelected();
    this_project_name = projectName;
    if (items.length == 0) {
    	alert("Web IGV: please, select a patient first.");
    	return;
    }
    for (var i = 0; i < items.length; i++) {
    	var bam = window.location.origin + items[i].bam;
		displayOneBAMIGV(bam);
    } 
    return;
}

function checkSomaticButton(b_name) {
    if (is_somatic_project == 0) {
        dijit.byId(b_name).set("value", "on");
    }
    else {
        gridEditGroup.setStructure(layoutGroupEdit);
        if (b_name == 'filter_not_cosmic') {
            if (dijit.byId('filter_not_cosmic').get("value") == "off" && dijit.byId('filter_cosmic').get("value") == "off") {
                dijit.byId('filter_cosmic').set("value", "on");
            }
        }
        else if (b_name == 'filter_cosmic') {
            if (dijit.byId('filter_not_cosmic').get("value") == "off" && dijit.byId('filter_cosmic').get("value") == "off") {
                dijit.byId('filter_not_cosmic').set("value", "on");
            }
        }
    }
}

function Filter (name, value) {
    this.name = name;
    this.value = value;
}

function okfunction (items, request){
    dojo.connect(document.getElementById("passwd").textContent, "onKeyUp", check_enter);   
    if (items.length==0) {
        dijit.byId('login').show();
        return;
    };
    if (error_vcf_md5 == 1) {
        document.getElementById("image_info_details").src = "../images/menu/info_details_error.png";
        setInterval('flashImage("image_info_details")', 500);
    }
    else { document.getElementById("image_info_details").src = "../images/menu/info_details_ok.png"; }
    document.getElementById("stat_project").textContent = projectName;
    document.getElementById("stat_description").textContent = "\""+items[0].description+"\"";
    gridFamilies.set("structure",layoutFamilies);
    gridGroups.set("structure",layoutGroups);
    if (items[0].somatic == 1) {
        is_somatic_project = 1;
        //document.getElementById('b_edit_group').style.visibility = 'visible';
    }
    else {
        //document.getElementById('b_edit_group').style.visibility = 'hidden';
        disable_mbl_switch_button( "filter_not_cosmic" );
        disable_mbl_switch_button( "filter_cosmic" );
    }
    if (items[0].pedigree == 1 && items[0].somatic == 1) {
        gridPatient.set("structure",layoutPatient_fam_somatic);
        structure_name = 'layoutPatient_fam_somatic';
        dijit.byId("button_somatic_model").set("disabled", "");
    }
    else if (items[0].pedigree == 1) {
        gridPatient.set("structure",layoutPatient_fam);
        structure_name = 'layoutPatient_fam';
    }
    else if (items[0].somatic == 1) {
        gridPatient.set("structure",layoutPatient_somatic);
        structure_name = 'layoutPatient_somatic';
        dijit.byId("button_somatic_model").set("disabled", "");
    }
    project_type = items[0].type;
    max_project = items[0].nb_total;
    var widget_slider_dejavu = dijit.byId("slider_dejavu");
    if (max_project <= 100) {
        widget_slider_dejavu.set('value', max_project);
        document.getElementById("nb_projects").innerHTML = '<font color="#28A24C">100</font>';
        document.getElementById("nb_projects_init").innerHTML = '<font color="#28A24C">100</font>';
        document.getElementById("nb_projects_2").innerHTML = '<font color="#28A24C">100</font>';
    }
    else {
        widget_slider_dejavu.set('value', 100);
        document.getElementById("nb_projects").innerHTML = '<font color="#28A24C">' + max_project + '</font>';
        document.getElementById("nb_projects_init").innerHTML = '<font color="#28A24C">' + max_project + '</font>';
        document.getElementById("nb_projects_2").innerHTML = '<font color="#28A24C">' + max_project + '</font>';
    }
    document.getElementById("nb_dejavu").innerHTML = document.getElementById("nb_projects").innerHTML;
    document.getElementById("nb_dejavu_init").innerHTML = document.getElementById("nb_projects").innerHTML;
    document.getElementById("nb_dejavu_2").innerHTML = document.getElementById("nb_projects").innerHTML;
    url_get_filter += dojo.cookie("username");
    lock_button.set("label", dojo.cookie("username"));
    if (error_vcf_md5 == 0) {
		loadAnnotations();
        document.getElementById("startButton").disabled = false;
        document.getElementById("startButtonAllGenes").disabled = false;
        document.getElementById("b_view_all_genes").disabled = false;
        if (export_vcf_available == 1) { dijit.byId("b_export_xls_vcf").set("disabled", false); }
		setTimeout(function() {
			document.getElementById("drop_db_public_gnomad").click();
			var re = new RegExp("defidiag\.polyweb\.fr");
			if (re.test(window.location.href)) {
				document.getElementById("startButton").click();
			}
			else {
				dijit.byId("use_db_freq_gnomad_ac").set("value", "off");
		        setTimeout(function() {
		        	document.getElementById("startButton").click();
		        }, 250);
			}
		}, 250);
    }
    refreshGrid(gridRegion,store_region);
    display_b_viewSelectedGenesVar();
    dojo.connect(gridListGenes,'onRowClick',displayCover);
    dojo.connect(gridChromosome,'onRowClick',clickGridChromosome);
    dojo.connect(gridChromosome,'onRowDblClick',displayGeneForChromosome);
//  dojo.connect(gridListGenes,'onRowClick',display_b_viewSelectedGenesVar);
    dojo.connect(gridListGenes,'onRowDblClick',viewVarByGene);
    dojo.connect(gridPatient, "onRowDblClick", dblClickPatient);
    dojo.connect(gridPatient, "onRowClick", oneClickPatient);
    dojo.connect(listcompletion, "onKeyUp", genecompletion);    
    dojo.connect(listcompletion, "onChange", findGene); 
    dojo.connect(gridFamilies,'onRowClick',displayFamilies);
    dojo.connect(gridFamilies, "onRowDblClick", dblClickFamily);
    dojo.connect(gridGroups,'onRowClick',displayGroups);
    dojo.connect(gridRegionsHoRec,'onRowClick',show_genes_region_ho_rec);
    testStore = new dojo.store.Memory({data: []});
    document.getElementById("inputBed").value = null;
    dijit.byId("listcompletion").set("store", testStore);
    dijit.byId('checking').hide();
	
}

function show_genes_region_ho_rec() {
    var items = gridRegionsHoRec.selection.getSelected();
    var genes;
    var h_commons_ids = {};
    for (var i=0;i<items.length;i++){
        var item = items[i];
		genes = String(item.genes);
		var commons_ids = String(item.common_regions);
		var lCommons = String(commons_ids).split(',');
		for(j=0; j<lCommons.length; j++) {
			h_commons_ids[String(lCommons[j])] = 1;
		}
    }
    
    gridRegionsHoRec.store.fetch({
        onComplete: function(items, request) {
		    for (i=0; i<items.length; i++) {
		        var item = items[i];
		        if (String(item.region_id) in h_commons_ids) {
		        	gridRegionsHoRec.selection.setSelected(i, true);
		        }
		        else {
		        	gridRegionsHoRec.selection.setSelected(i, false);
		        }
	        }
        }
    });
    
    gridListGenes.filter({xref: "*"});
    var lGenes = String(genes).split(',');
    var hGenes = {};
    var n = 0;
    while (n < lGenes.length) {
    	hGenes[lGenes[n]] = 1;
    	n++;
    }
    gridListGenes.store.fetch({
        onComplete: function(items, request) {
            var max = items.length;
            var n = 0;
            while (n < max) {
            	var xref = String(items[n].xref);
            	if (String(xref) in hGenes) {
            		gridListGenes.store.setValue(items[n], 'include', 3);
        		}
        		else {
        			gridListGenes.store.setValue(items[n], 'include', 1);
        		}
            	n++;
            }
        }
    });
    gridListGenes.setSortIndex(1, false);
	gridListGenes.layout.setColumnVisibility(1, true);
}

function flashImage(id_image) {
    state = document.getElementById(id_image).style.visibility; 
    if (state == 'hidden'){ 
        newState = 'visible'; 
    }
    else if(state == 'visible'){ 
        newState = 'hidden'; 
    } 
    document.getElementById(id_image).style.visibility = newState; 
}

var export_vcf_available = 0;

function oneClickPatient(items){
    export_vcf_available = 1;
    var items = gridPatient.selection.getSelected();
    if (items.length == 1) { dijit.byId("b_export_xls_vcf").set("disabled", false); }
    else { dijit.byId("b_export_xls_vcf").set("disabled", true); }
	if (can_use_hgmd == 'yes' && items.length == 1) { dijit.byId("b_show_hgmd_dejavu_patient").set("disabled", false); }
	else { dijit.byId("b_show_hgmd_dejavu_patient").set("disabled", true); }
    gridFamilies.selection.clear();
}

function displayFamilies(items){
    var items = gridFamilies.selection.getSelected();
    gridPatient.selection.clear();
    var sfam = "*";
    for (var i=0;i<items.length;i++){
         sfam = items[i].name+"";
    }
    gridPatient.filter({fam:sfam});
}

function displayGroups(items){
    var items = gridGroups.selection.getSelected();
    //gridGroups.selection.clear();
    var sfam = "*";
    for (var i=0;i<items.length;i++){
         sgroup = items[i].name+"";
    }
    gridPatient.filter({group:sgroup});
}

function findGene(item){
    console.log(item);
}

function loadFirstLaunch() {
    ped_modified = 0;
    dijit.byId("slider_impact").set("value", 2);  
    dijit.byId("slider_frequence").set("value", 3);    
    dijit.byId("slider_predictions").set("value", 4);
    dijit.byId("slider_cadd").set("value", 7);
    dijit.byId("slider_ncboost").set("value", 4);
    dijit.byId("slider_ratio_min").set("value", 1);
    dijit.byId("slider_ratio_max").set("value", 5);
    //dijit.byId("slider_polyscore").set("value", 4);
    dijit.byId("slider_confidence").set("value", 3);
    dijit.byId("filter_nofreq").set("value", "on");
    get_slider_impact();
    var z =  document.getElementById('gridListGenes').style.width;
    data_list = {
        identifier: 'id',
        label: 'id',
        items:  []
    };
    store_region =  new dojo.data.ItemFileWriteStore({data: data_list});
    checkPassword(projectName,okfunction);
    checkMD5VcfFiles(dojo.cookie("username"), dojo.cookie("passwd"), param("project"));
}

function genecompletion(value){
    var leStore = new dojo.store.Cache(new dojo.store.JsonRest({ target :
        url_find_name+"?project="+projectName, idProperty: "id"
    }), dojo.store.Memory());
    var testStore = new dojo.store.Memory({data: []});
    if(dojo.byId("listcompletion").value.length > 2 )//&& dijit.byId("listcompletion").get("store") == testStore)
    dijit.byId("listcompletion").set("store", leStore);
    if(dojo.byId("listcompletion").value.length <= 2  && dijit.byId("listcompletion").get("store") == leStore)
    dijit.byId("listcompletion").set("store", testStore);
    console.log(value);
}   

dojo.addOnLoad(function(){
    
    
    // //Constants for the SVG
    // var width = 800,
        // height = 500;
//     
    // //Set up the colour scale
    // var color = d3.scale.category20();
//     
    // //Set up the force layout
    // var force = d3.layout.force()
        // .charge(-120)
        // .linkDistance(80)
        // .size([(width - 10), (height - 10)]);
//     
    // //Append a SVG to the body of the html page. Assign this SVG as an object to svg
    // var svg = d3.select("#svg_container").append("svg")
        // .attr("width", width)
        // .attr("height", height);
//     
    // var fisheye = d3.fisheye.circular()
          // .radius(120);
    // svg.on("mousemove", function() {
          // force.stop();
          // fisheye.focus(d3.mouse(this));
          // d3.selectAll("circle").each(function(d) { d.fisheye = fisheye(d); })
              // .attr("cx", function(d) { return d.fisheye.x; })
              // .attr("cy", function(d) { return d.fisheye.y; })
              // .attr("r", function(d) { return d.fisheye.z * 8; });
          // link.attr("x1", function(d) { return d.source.fisheye.x; })
              // .attr("y1", function(d) { return d.source.fisheye.y; })
              // .attr("x2", function(d) { return d.target.fisheye.x; })
              // .attr("y2", function(d) { return d.target.fisheye.y; });
        // });
//     
    // //Read the data from the mis element 
    // var mis = document.getElementById('mis').innerHTML;
    // graph = JSON.parse(mis);
//     
    // //Creates the graph data structure out of the json data
    // force.nodes(graph.nodes)
        // .links(graph.links)
        // .start();
//     
    // //Create all the line svgs but without locations yet
    // var link = svg.selectAll(".link")
        // .data(graph.links)
        // .enter().append("line")
        // .attr("class", "link")
        // .style("stroke-width", function (d) {
        // return Math.sqrt(d.value);
    // });
//     
    // //Toggle stores whether the highlighting is on
    // var toggle = 0;
    // //Create an array logging what is connected to what
    // var linkedByIndex = {};
    // for (i = 0; i < graph.nodes.length; i++) {
        // linkedByIndex[i + "," + i] = 1;
    // };
    // graph.links.forEach(function (d) {
        // linkedByIndex[d.source.index + "," + d.target.index] = 1;
    // });
//     
    // //Do the same with the circles for the nodes - no 
    // //Changed
    // var node = svg.selectAll(".node")
        // .data(graph.nodes)
        // .enter().append("g")
        // .attr("class", "node")
        // .attr("r", 5)
        // .style("fill", function (d) {
            // return color(d.group);
        // })
        // .call(force.drag)
        // .on('dblclick', connectedNodes); //Added code 
//     
    // node.append("circle")
        // .attr("r", 8)
        // .style("fill", function (d) {
        // return color(d.group);
    // })
//     
    // node.append("text")
          // .attr("dx", 10)
          // .attr("dy", ".35em")
          // .text(function(d) { return d.name });
    // //End changed
//     
//     
    // //Now we are giving the SVGs co-ordinates - the force layout is generating the co-ordinates which this code is using to update the attributes of the SVG elements
    // force.on("tick", function () {
        // link.attr("x1", function (d) {
            // return d.source.x;
        // })
            // .attr("y1", function (d) {
            // return d.source.y;
        // })
            // .attr("x2", function (d) {
            // return d.target.x;
        // })
            // .attr("y2", function (d) {
            // return d.target.y;
        // });
//     
        // //Changed
//         
        // d3.selectAll("circle").attr("cx", function (d) {
            // return d.x;
        // })
            // .attr("cy", function (d) {
            // return d.y;
        // });
//     
        // d3.selectAll("text").attr("x", function (d) {
            // return d.x;
        // })
            // .attr("y", function (d) {
            // return d.y;
        // });
//         
        // //End Changed
//     
    // });
//     
    // //This function looks up whether a pair are neighbours
    // function neighboring(a, b) {
        // return linkedByIndex[a.index + "," + b.index];
    // }
    // function connectedNodes() {
        // if (toggle == 0) {
            // //Reduce the opacity of all but the neighbouring nodes
            // d = d3.select(this).node().__data__;
            // node.style("opacity", function (o) {
                // return neighboring(d, o) | neighboring(o, d) ? 1 : 0.1;
            // });
            // link.style("opacity", function (o) {
                // return d.index==o.source.index | d.index==o.target.index ? 1 : 0.1;
            // });
            // //Reduce the op
            // toggle = 1;
        // } else {
            // //Put them back to opacity=1
            // node.style("opacity", 1);
            // link.style("opacity", 1);
            // toggle = 0;
        // }
    // }   
    document.getElementById("b_view_all_genes").checked = false;
    run_view_all_genes();
    loadGlobalInfos();
    //loadAnalyseInfos();
    gridChromosome.layout.setColumnVisibility(0, false);
});

  
    //fonction pour retourner  la page de la liste des projets
function goBack(){
    document.location.href ="projectList.html";
}

var old_click;
var firstview =0;

//fonction pour afficher le message indiquant le chargerment des donnes
function testx(){
    if (!drawingOK){
        if (dijit.byId('waiting')) {
            dijit.byId('waiting').show();
        }
    }
}   


/****************************************************
 * 
 * METHODS POUR LES diseases
 * 
*****************************************************/
function displayGeneForDiseases(e){
        var args = construct_url_filter_data();
     args += "&filter_diseases="+e.sid;
     
     loadAll(args,"diseases");
    
}


/****************************************************
 * 
 * METHODS POUR LES CHROMOSOMES
 * 
*****************************************************/

var chr_var_sub = 0;
var chr_var_ins = 0;
var chr_var_del = 0;
function clickGridChromosome(e) {
    gridChromosome.rowSelectCell.toggleAllSelection(true);
    var this_index = e.rowNode.gridRowIndex;
    dojo.forEach(gridChromosome._by_idx, function(item, index) {
        if (index == this_index) {
            gridChromosome.rowSelectCell.setDisabled(index, false);
            gridChromosome.selection.setSelected(index, true);
        }
        else {
            gridChromosome.rowSelectCell.setDisabled(index, true);
            gridChromosome.selection.setSelected(index, false); 
        }
    });
    gridChr_allSelected = 0;
    enabledXlsExport();
    chr_var_sub = 0;
    chr_var_ins = 0;
    chr_var_del = 0;
    var selectedItem = gridChromosome.getItem(this_index);
    dojo.forEach(gridChromosome.store.getAttributes(selectedItem), function(attribute) {
        if (gridChromosome.selection.isSelected(this_index)) {
            var value = gridChromosome.store.getValues(selectedItem, attribute);
            if (attribute == "substitutions" )   { chr_var_sub = value; }
            else if (attribute == "insertions" ) { chr_var_ins = value; }
            else if (attribute == "deletions" )  { chr_var_del = value; }
        }
    });
}

function enabledXlsExport() {
    dijit.byId("b_export_xls_genes").set("disabled", false);
    dijit.byId("b_export_xls_var").set("disabled", false);
}

function disabledXlsExport() {
    dijit.byId("b_export_xls_genes").set("disabled", true);
    dijit.byId("b_export_xls_var").set("disabled", true);
}

function displayGeneForChromosome(e){
    var i = e.rowNode.gridRowIndex;
    var item = gridChromosome.getItem(i);
    var name = gridChromosome.store.getValue(item, "id");
    document.getElementById("waiting_text").textContent = "Loading Data for CHR" + name;
    var args = construct_url_filter_data();
    args += "&filter_chromosome="+name;
    if (lOnlyThesesGenes.length > 0) {
        args += "&only_genes='"+lOnlyThesesGenes.join(",")+"'";
    }
    if (name == "Game Over"){
        return;
    }
    loadAll(args,"chromosomes");
}
        
/****************************************************
 * 
 * METHODS POUR LES REGIONS
 * 
*****************************************************/

function changeRegionsState(value,type) {
    var sel = gridRegion.selection.getSelected();
    var l = sel.length;
    var allids='';
    //pour chaque lignes sellectionnes
    for (var i = 0; i < l; i++) {
        gridRegion.store.setValue(sel[i], type, value);
    }
    update_regions_cache(gridRegion.store);
}

function edit_group() {
    isRunning = 1;
    dialog_edit_group.show();
}

function revert_group() {
    if (is_somatic_project == 0) {
        gridPatient.setStructure(layoutPatient_fam);
        gridPatient.setSortIndex(0, true);
        gridEditGroup.setStructure(layoutEdit);
    }
    gridPatient.store.fetch({
        onComplete: function(items, request){
            var max = items.length;
            var n = 0;
            while (n < max) {
                var init_group  = gridPatient.store.getValue(items[n], 'init_group');
                var init_child  = gridPatient.store.getValue(items[n], 'init_child');
                var init_status = gridPatient.store.getValue(items[n], 'init_status');
                gridPatient.store.setValue(items[n], 'group',  init_group);
                gridPatient.store.setValue(items[n], 'child',  init_child);
                gridPatient.store.setValue(items[n], 'status', init_status);
                gridPatient.store.setValue(items[n], 'group', null);
                n++;
            }
        }
    });
    ped_modified = 0;
    isRunning = 0;
}

function create_groups() {
    if (is_somatic_project == 0) {
        gridPatient.setStructure(layoutPatient_group);
        gridPatient.setSortIndex(2, true);
        gridEditGroup.setStructure(layoutGroupEdit);
    }
    gridPatient.store.fetch({
        onComplete: function(items, request){
            var max = items.length;
            var i = 1;
            var n = 0;
            while (n < max) {
                var group = gridPatient.store.getValue(items[n], 'group');
                if (group == null) {
                    var gr_name = 'GR_';
                    if (i < 10) { gr_name += '0'; }
                    gr_name += ''+i; 
                    gridPatient.store.setValue(items[n], 'group', gr_name);
                    i++;
                }
                n++;
            }
        }
    });
    ped_modified = 1;
}
 
function addRow(){
    isRunning = 1;
    dialog_region.show();
}

function addRegion(regexp1,regexp2,text) {
    isRunning = 0;
    if (!text){
         text = text_region.get("value");
    }
    var reg=new RegExp(regexp1, "g");
    var tableau=text.split(reg);
    var nb = gridRegion.rowCount;
    //store_region.save();
    for (var i=0; i<tableau.length; i++) {
        nb++;
        var reg2=new RegExp(regexp2, "g");  
        var region = tableau[i].split(reg2);
        var regChr = new RegExp(/chr/);
        region[0] = region[0].replace(regChr, '');
        var include_val = 0;
        if (region[0].match(/file/)) {
        	include_val = 'bed';
        	alert (include_val+' for '+text);
        }
        //if (region.length == 4) { include_val = region[3]; }
        store_region.newItem({
            id:  nb+"_"+region[1]+"_"+region[0]+"_"+region[2],
            name: nb+"_"+region[1]+"_"+region[0]+"_"+region[2],
            chromosome:region[0],
            start: region[1],
            end: region[2],
            include: include_val,
        });
    }
    update_regions_cache(store_region);
    dialog_region.hide();
}

function defineArrayButton() {
    var array_button = {};
    array_button["notcosmic"] = "filter_not_cosmic";
    array_button["cosmic"] = "filter_cosmic";
    array_button["cnv"] = "filter_cnv";
    array_button["deletion"] = "filter_deletion";
    array_button["insertion"] = "filter_insertion";
    array_button["substitution"] = "filter_substitution";
    array_button["silent"] = "filter_silent";
    array_button["utr"] = "filter_utr";
    array_button["splicing"] = "filter_splice_site";
    array_button["essential_splicing"] = "filter_essential_splicing";
    array_button["coding"] = "filter_nonsynonymous";
    array_button["stop"] = "filter_stop";
    array_button["phase"] = "filter_phase";
    array_button["intergenic"] = "filter_intergenic";
    array_button["upstream_downstream"] = "filter_upstream_downstream";
    array_button["intronic"] = "filter_intronic";
    array_button["ncrna"] = "filter_ncrna";
    array_button["maturemirna"] = "filter_maturemirna";
    array_button["pseudogene"] = "filter_pseudogene";
    array_button["frameshift"] = "filter_frameshift";
    array_button["non-frameshift"] = "filter_nonframeshift";
    array_button["predicted_splice_site"] = "filter_predicted_splice_site";
    return (array_button);
}

function choice_filter(object, listIds, listNames, catName) {
    var string = "";
    var nb = 0;
    for (i = 0; i < listIds.length; i++) {
        var id = listIds[i];
        var name = listNames[i];
        var widget = dijit.byId(id);
        if (widget) {
            if (widget.get("value") == "on"){
                if (string != "") { string += " "; }
                string += name;
                nb++;
            }
        }
    }
    if (string == 'Not_Cosmic Cosmic' && isSomatic == 0) {
        string = 'Not Clinical'
    }
    if (nb == 0 ) { string = "<font color='red'><b>None</b></font>"; }
    if (nb == listIds.length ) { string = "<font color='green'><b>All</b></font>"; }
    if (catName) { object.set('label', catName + " (" + string + ")"); }
}

/****************************************************
 * 
 * METHODS POUR LES Refresh des tableaux
 * 
*****************************************************/

function changeStatusPatients(array,value,type){
    var grid = dijit.byId("gridPatient");
    grid.store.fetch({
        onComplete: function(items, request) {
            var n = 0;
            var max = grid.rowCount;
            while (n < max) {
                var selectedItem = items[n];
                if (selectedItem) {
                    var name = grid.store.getValue(selectedItem,"name");
                    for (i in array) {
                        var name2 = array[i];
                        if (name == name2) {
                            grid.store.setValue(selectedItem, type, value);
                            patients_status[array[i]][type] = value;
                        }
                    }
               }
               n++;
            }
        }
    });
}

function initAnnotationsButtons() {
    dijit.byId("filter_clinical").set("value", "on");
    dijit.byId("filter_nofreq").set("value", "on");
    var ab = defineArrayButton();
    for (z in ab) {
        if (z == "loh") { continue; }
        if (z == "dbl_evt") { continue; }
        if (ab[z] == 'filter_substitution' || ab[z] == 'filter_insertion' || ab[z] == 'filter_deletion' || ab[z] == 'filter_cnv') {
            dijit.byId(ab[z]).set("value", "on");
        }
        else {
        	dijit.byId(ab[z]).set('checked', true);
        }
    }
}

function initStatusPatients() {
    var grid = dijit.byId("gridPatient");
    grid.store.fetch({
        onComplete: function(items, request) {
            var n = 0;
            var max = grid.rowCount;
            while (n < max) {
                var selectedItem = items[n];
                var name = grid.store.getValue(selectedItem,"name");
                grid.store.setValue(selectedItem, "include", 1);
                grid.store.setValue(selectedItem, "filter_heho", -1);
                patients_status[name]["include"] = 1;
                patients_status[name]["filter_heho"] = -1;
                n++;
            }
        }
    });
}

function initStatusFamilies() {
    gridFamilies.store.fetch({
        onComplete: function(items, request) {
            var n = 0;
            var max = gridFamilies.rowCount;
            while (n < max) {
                var selectedItem = items[n];
                var name = gridFamilies.store.getValue(selectedItem,"name");
                gridFamilies.store.setValue(selectedItem, "include", 1);
                if(!families_status[name]){
                    families_status[name] = new Array();
                }
                families_status[name]["include"] = 1;
                n++;
            }
        }
    });
}

function initRegion() {
    gridRegion.store.fetch({
        onComplete: function(items, request) {
            var n = 0;
            var max = gridRegion.rowCount;
            while (n < max) {
                var selectedItem = items[n];
                gridRegion.store.deleteItem(selectedItem);
                n++;
            }
        }
    });
    update_regions_cache(gridRegion.store);
}

function initDejaVu() {
    dijit.byId("dejavu_ho").set("value", "on");
    if (max_project <= 100) {
        dijit.byId("slider_dejavu").set('value', max_project);
        document.getElementById('nb_dejavu').innerHTML = '<font color="#28A24C">' + max_project + ' max</font>';
    }
    else {
        dijit.byId("slider_dejavu").set('value', 100);
        document.getElementById('nb_dejavu').innerHTML = '<font color="#28A24C">' + max_project + '</font>';
    }
}

function changeButtonPatFamStatutOnly(itemsAll, request){
    var i;
    itemsAll = itemsAll.reverse();
    for (i = 0; i < itemsAll.length; i++) {
        var item = itemsAll[i];
        var name = item.name;
        var st = itemsAll[i].value+"";
        if (name =="filter_patient"){
            changeStatusPatients(st.split(" "),0,"include");
        }
        if (name =="filter_attic"){
            changeStatusPatients(st.split(" "),2,"include");
        }
        if (name =="filter_not_patient"){
        	changeStatusPatients(st.split(" "),-1,"include");
        	//if (get_value_slider_regionho() > 1) { changeStatusPatients(st.split(" "),-2,"include"); }
        	//else { changeStatusPatients(st.split(" "),-1,"include"); }
        }
        if (name =="filter_fam_and"){
            changeStatusFamilies(st.split(" "),0,"include");
        }
        if (name =="filter_fam_not"){
            changeStatusFamilies(st.split(" "),-1,"include");
        }
        if (name =="filter_he"){
            changeStatusPatients(st.split(" "),0,"filter_heho");
        }
        if (name =="filter_ho"){
            changeStatusPatients(st.split(" "),1,"filter_heho");
        }
    }
}

function changeButtonStatut(itemsAll, request){
    var i;
    var filter            = new Array();
    var res_button        = new Array();
    var res_patient_and   = new Array();
    var res_patient_attic = new Array();
    var res_patient_not   = new Array();
    var res_patient_he    = new Array();
    var res_patient_ho    = new Array();
    var genetic_model_pass = 0;
    initAnnotationsButtons();
    initStatusPatients();
    initStatusFamilies();
    initRegion();
    initDejaVu();
    itemsAll = itemsAll.reverse();
    for (i = 0; i < itemsAll.length; i++) {
        var item = itemsAll[i];
        var name = item.name;
        var st = itemsAll[i].value+"";
        if (name =="filter_type_variation"){
            res_button = st.split(" ");
        }
        if (name =="filter_patient"){
            changeStatusPatients(st.split(" "),0,"include");
        }
        if (name =="filter_attic"){
            changeStatusPatients(st.split(" "),2,"include");
        }
        if (name =="filter_not_patient"){
            changeStatusPatients(st.split(" "),-1,"include");
        }
        if (name =="filter_fam"){
            changeStatusFamilies(st.split(" "),0,"include");
        }
        if (name =="filter_not_fam"){
            changeStatusFamilies(st.split(" "),-1,"include");
        }
        if (name =="filter_he"){
            changeStatusPatients(st.split(" "),0,"filter_heho");
        }
        if (name =="filter_ho"){
            changeStatusPatients(st.split(" "),1,"filter_heho");
        }
        if (name =="filter_gene_level"){
            filter_gene_level.set("checked",1);
            filter_variation_level.set("checked",0);
        }          
        if (name =="filter_mode"){
            filtering_mode = st;
            change_filtering_type(st);
        }
        if (name =="filter_level_ind"){
            change_filtering_level_ind(itemsAll[i].value)
            filtering_level_ind = st;
        }
        if (name =="filter_level_fam"){
            change_filtering_level_fam(itemsAll[i].value)
            filtering_level_fam = st;
        }
        if (name =="filter_model"){
            genetic_model = st;
            genetic_model_pass = 1;
        }
        if (name =="filter_genetic_model"){
            genetic_model=st;
            genetic_model_pass = 1;
            change_filtering_model(genetic_model);
        }
        if (name =="filter_region"){
            addRegion('[ ]+','[:]+',st);
        }
        if (name =="filter_dejavuho") {
            dijit.byId("dejavu_ho").set("value", "off");
        }
        if (name =="filter_dejavu") {
            var value = itemsAll[i].value;
            dijit.byId("slider_dejavu").set('value', value);
        }
        if (name =="filter_nb") {
            var value = itemsAll[i].value;
            filter_identical_number.set('value', value);
        }
        if (name == "filter_level_only_genes" || name == "filter_only_genes") {
            if (name == "filter_only_genes") { lOnlyThesesGenes = st.split(','); }
            else { lOnlyThesesGenes = st.split(' '); }
            var list_json_filter_genes = [];
            for (var j=0; j<lOnlyThesesGenes.length; j++) {
                var json = {
                    "name": lOnlyThesesGenes[j].toUpperCase(),
                    "id":   lOnlyThesesGenes[j].toUpperCase(),
                }
                list_json_filter_genes.push(json);
            }
            var data_tmp = { "items": list_json_filter_genes };
            var newStore_list_genes = new dojo.data.ItemFileReadStore({ data: data_tmp });
            dijit.byId("gridGenesUser").setStore( newStore_list_genes );
            var nb = lOnlyThesesGenes.length;
            dijit.byId("title_genes").set("title", "<font color='green'><b>"+nb+" Genes</b></font>");
        }
    }
    if (genetic_model_pass == 0) {
        genetic_model = 'None';
    }
    var ab = defineArrayButton();
    for (i = 0; i < res_button.length; i++) {
        var filter_name = ab[res_button[i]];
        if (res_button[i] == '') {
            continue;
        }
        else if (res_button[i] == "pheno_snp") {
            dijit.byId("filter_clinical").set("value", "off");
        }
        else if (res_button[i] == "freq_none") {
            dijit.byId("filter_nofreq").set("value", "off");
        }
        else if (res_button[i] == 'substitution' || res_button[i] == 'insertion' || res_button[i] == 'deletion' || res_button[i] == 'cnv') {
            dijit.byId('filter_'+res_button[i]).set("value", "off");
        }
        else if (res_button[i] == 'large_insertion' || res_button[i] == 'large_deletion' || res_button[i] == 'large_duplication') {
        	dijit.byId('filter_cnv').set("value", "off");
        }
        else if (res_button[i].match(/freq/) || res_button[i].match(/prediction/) || res_button[i].match(/ngs_score/)) {
            filter[res_button[i]]=1;
            continue;
        }
        else if (filter_name) {
        	dijit.byId(filter_name).set('checked', false);
        }
        filter[res_button[i]]=1;
    }
    
    
    var widget_slider_frequence = dijit.byId("slider_frequence");
    if (filter["freq_1"] && filter["freq_05"] && filter["freq_01"] && filter["freq_001"]) {
        widget_slider_frequence.set("value", 1);
    }
    else if (filter["freq_1"] && filter["freq_05"] && filter["freq_01"]) {
        widget_slider_frequence.set("value", 2);
    }
    else if (filter["freq_1"] && filter["freq_05"]) {
        widget_slider_frequence.set("value", 3);
    }
    else if (filter["freq_1"]) {
        widget_slider_frequence.set("value", 4);
    }
    else {
        widget_slider_frequence.set("value", 5);
    }
    
    var widget_slider_predictions = dijit.byId("slider_predictions");
    if (filter["prediction_0"] && filter["prediction_1"] && filter["prediction_2"]) {
        widget_slider_predictions.set("value", 1);
    }
    else if (filter["prediction_0"] && filter["prediction_1"]) {
        widget_slider_predictions.set("value", 2);
    }
    else if (filter["prediction_0"]) {
        widget_slider_predictions.set("value", 3);
    }
    else {
        widget_slider_predictions.set("value", 4);
    }
    
    var widget_slider_cadd = dijit.byId("slider_cadd");
    if (filter["cadd_25"] && filter["cadd_20"] && filter["cadd_15"] && filter["cadd_10"] && filter["cadd_5"] && filter["cadd_not"]) {
        widget_slider_cadd.set("value", 1);
    }
    else if (filter["cadd_20"] && filter["cadd_15"] && filter["cadd_10"] && filter["cadd_5"] && filter["cadd_not"]) {
        widget_slider_cadd.set("value", 2);
    }
    else if (filter["cadd_15"] && filter["cadd_10"] && filter["cadd_5"] && filter["cadd_not"]) {
        widget_slider_cadd.set("value", 3);
    }
    else if (filter["cadd_10"] && filter["cadd_5"] && filter["cadd_not"]) {
        widget_slider_cadd.set("value", 4);
    }
    else if (filter["cadd_5"] && filter["cadd_not"]) {
        widget_slider_cadd.set("value", 5);
    }
    else if (filter["cadd_not"]) {
        widget_slider_cadd.set("value", 6);
    }
    else {
        widget_slider_cadd.set("value", 7);
    }
    
    var widget_slider_confidence = dijit.byId("slider_confidence");
    if (filter["ngs_score1"] && filter["ngs_score0"]) {
        widget_slider_confidence.set("value", 1);
    }
    else if (filter["ngs_score0"]) {
        widget_slider_confidence.set("value", 2);
    }
    else {
        widget_slider_confidence.set("value", 3);
    }
    
    update_choice_filter();
}

function changeStatusFamilies(array,value,type){
    for (var i=0;i<array.length;i++){
        if(!families_status[array[i]]){
            families_status[array[i]] = new Array();
        }
        families_status[array[i]][type] = value;
        gridFamilies.store.fetch({
            onItem :function (item, result){
                var name= gridFamilies.store.getValue(item,"name");
                if (name == array[i]) { gridFamilies.store.setValue(item,"include", value); }
            }
        });
    }
    
}

function refreshStatutButton(args) {
    var storeP = new dojo.data.ItemFileWriteStore({
        url: button_url+args
    });
    storeP.fetch({
        onComplete:changeButtonStatut
    }); 
}

function update_regions_cache(store_region) {
    store_region.fetch({
     onComplete: function(items){
        REGION_FILTER = new Array();
         dojo.forEach(items, function(item){
            REGION_FILTER.push(item);
            
         });
    }
    });
}

function refreshRegionsGrid(args){
    store_region = new dojo.data.ItemFileWriteStore({
            url: region_url+args
        });
    update_regions_cache(store_region);
    refreshGrid(gridRegion,store_region);
}

function refreshGridFilter(){
    forceRefreshTable(url_get_filter,gridFilter);
}

function view_all_in_attic() {
    gridPatient.filter({name:"*"})
    gridFamilies.filter({name:"*"});
}

function dblClickPatient(){
    gridPatient.store.fetch({
        onItem :function (item, result){
            gridPatient.store.setValue(item,"include", 1);
            var name= gridPatient.store.getValue(item,"name");
            if (!patients_status[name]) patients_status[name] = new Array(); 
            patients_status[name]["include"]=1;
        
            },
        onComplete: function (items, result){
            var items = gridPatient.selection.getSelected();
            if (items.length) {
                dojo.forEach(items, function(selectedItem) {
                if (selectedItem !== null) {
                   gridPatient.store.setValue(selectedItem,"include", 0);
                   var name= gridPatient.store.getValue(selectedItem,"name");
                    patients_status[name]["include"]=0;
               }
              });
            }
            document.getElementById("startButton").click();
    }
    }); 
}

function dblClickFamily(){
    gridFamilies.store.fetch({
        onItem :function (item, result){
            gridFamilies.store.setValue(item,"include", 1);
            var name= gridFamilies.store.getValue(item,"name");
            if (!families_status[name]) families_status[name] = new Array(); 
            families_status[name]["include"]=1;
        
            },
        onComplete: function (items, result){
            var items = gridFamilies.selection.getSelected();
            if (items.length) {
                dojo.forEach(items, function(selectedItem) {
                if (selectedItem !== null) {
                   gridFamilies.store.setValue(selectedItem,"include", 0);
                   var name= gridFamilies.store.getValue(selectedItem,"name");
                    families_status[name]["include"]=0;
               }
              });
            }
            document.getElementById("startButton").click();
    }
    }); 
}

function changePatientsState(value,type) {
    var test =false;
    if (value==2 && type=="include") test = true;
    gridPatient.store.fetch({
        
        onComplete: function (items2, result){
            var fams = new Array();

            dojo.forEach(items2, function(selectedItem) {
                var f1 = gridPatient.store.getValue(selectedItem,"fam");
                if (fams[f1] == null) fams[f1] =0;
                fams[f1] = fams[f1] +1;
            });
            var items = gridPatient.selection.getSelected();
            var fam_dels = new Array();
             if (items.length) {
                dojo.forEach(items, function(selectedItem) {
                 if (selectedItem != null) {
                    var name= gridPatient.store.getValue(selectedItem,"name");
                    var f1 = gridPatient.store.getValue(selectedItem,"fam");
                    if (!patients_status[name]) patients_status[name] = new Array(); 
                        patients_status[name][type]=value;
                        
                        if (fam_dels[f1] == null) fam_dels[f1] =0;
                        fam_dels[f1]++;
                    
                }
             }); 
              if (type == "include" && (value ==1 || value == 2)) {//and (value == 1 orvalue ==0 )){}
              for (f1 in fam_dels){
                    if (fam_dels[f1] == fams[f1]){
                        if (!families_status[f1]) families_status[f1] = new Array(); 
                            families_status[f1][type] = value; 
                        }
                        else {
                                if (!families_status[f1]) families_status[f1] = new Array(); 
                            families_status[f1][type] = 1;
                        }   
              }
                
             }
            }
            changeFamiliesState(value,type,items2);
    }
    }); 
}
    
var old_hurl = '';
function export_regions_ho_xls() {
	var url = old_hurl + '&filter_chromosome=all&xls_by_regions_ho=1';
	dijit.byId('waiting').show();
	downloadFile(url);
}

function changeFamiliesState(value,type,itemsPatient) {
    gridFamilies.store.fetch({
        onComplete: function (items2, result){
            var items = gridFamilies.selection.getSelected();
             if (items.length) {
                dojo.forEach(items, function(selectedItem) {
                 if (selectedItem != null) {
                    var name= gridFamilies.store.getValue(selectedItem,"name");
                    if (!families_status[name]) families_status[name] = new Array(); 
                        families_status[name][type]=value;
                         if (type == "include" && (value ==1 || value == 2)) {
                        for (var i in itemsPatient){
                            var item = itemsPatient[i];
                            var namef= gridPatient.store.getValue(item,"fam");
                            if (namef == name){
                                    var namep= gridPatient.store.getValue(item,"name");
                                    patients_status[namep]["include"] = value;
                            }
                        }
                    }
                }
                
              });
             }
         updateGridState(itemsPatient,items2);
        check_slider_regionho();
    }
    }); 
}

function updateGridState(itemsPatient,itemsFam){
    for (var i in itemsFam){
        var item = itemsFam[i];
        var name= gridFamilies.store.getValue(item,"name");
        if (!families_status[name]) continue; 
        gridFamilies.store.setValue(item,"include", families_status[name]["include"]);
    }
    for (var i in itemsPatient){
        var item = itemsPatient[i];
        var name= gridPatient.store.getValue(item,"name");
        gridPatient.store.setValue(item,"include", (patients_status[name]["include"]));
        gridPatient.store.setValue(item,"filter_heho", (patients_status[name]["filter_heho"]));
    }
}

displayCover = function(e){
    if (show_graph == 0) return;
    var i = e.rowNode.gridRowIndex; 
    var projectName = param("project");//parent.haut.document.getElementById('project_name').value;
    var name=gridListGenes.getCell(1).getNode(i).textContent;
    var store = gridListGenes.store;//readStore(gene_url);
    store.fetch({
        query: {
            name: name
        },
        onComplete: findCover
    
    });
};

var select_gene_for_cover;

function findCover(items){
     var chr = items[0].chromosome+""; 
     chr_number.set('value',chr);
     start_number.set('value',items[0].start);
     end_number.set('value',items[0].end);
     initFilterGenes(chr,items[0].start,items[0].end,1,items[0].id);    
}

$(document).ready(function() {
    $("#map").scroll(function () { 
            $("#drawing_transcripts").scrollLeft($("#map").scrollLeft());
            $("#drawing_patients").scrollLeft($("#map").scrollLeft());
        });
    $("#drawing_transcripts").scroll(function () { 
            $("#map").scrollLeft($("#drawing_transcripts").scrollLeft());
            $("#drawing_patients").scrollLeft($("#drawing_transcripts").scrollLeft());
        });
    $("#drawing_patients").scroll(function () { 
            $("#map").scrollLeft($("#drawing_patients").scrollLeft());
            $("#drawing_transcripts").scrollLeft($("#drawing_patients").scrollLeft());
        });
});

function displayGeneCover(){
    initCoverViewer(filterGenes.get("value"));
}

/**** Open window for coverage *****/

function return_geneId(st){
    var z = st.split("-");
    return z[1];
}

var list_chr_vector_hex = [];
var url_launch_no_chr;
function go_to_polydiag(panel_name) {
	var url_diag = "../defidiag.html";
	var arguments = "project=" +projectName;
	if (panel_name) {
		arguments += "&panel=" + panel_name;
	}
	else {
		window.localStorage.clear();
		localStorage.setItem("tempvectors_" + projectName, "'" + list_chr_vector_hex.join('::') + "'");
		localStorage.setItem("filters_vectors_" + projectName, url_launch_no_chr);
//		var genes_name = Object.keys( listGenesName );
//		localStorage.setItem("filters_genes_" + projectName, genes_name.join(','));
    		arguments += "&polyquery_tmp_file=tempvectors_" + projectName;
		var res = localStorage.getItem("tempvectors_" + projectName);
	}
	window.open(url_diag + '?' + arguments);
}

function showPopupDiag(value) {
	var child_name;
	if (value) {
		child_name = value;
	}
	else {
		var grid = dijit.byId("gridPatient");
	    dojo.forEach(grid.selection.getSelected(), function (item,i) {
	        var name = grid.store.getValue(item,"name");
	        var status = grid.store.getValue(item,"status");
	        var nb_all_var = grid.store.getValue(item,"all_variations");
	        if (nb_all_var > 1000) {
	    		alert('PolyDiag View only available if total nb var < 1000. Please use more filters to use this fonction.');
	    		return;
	        }
	        else if (status == '2') {
	        	child_name = name;
	    	}
	    	else {
	    		alert('PolyDiag View only available for child with status Ill, sorry.');
	    		return;
	    	}
	    })
    }
	if (child_name) {
        dijit.byId('waiting').show();
		var url_diag = "http://www.polyweb.fr/cgi-bin/mbras/polymorphism-cgi//validation_variation/patient_cache.pl";
		var arguments = "project="+projectName+"&edit_mode=1&never=1&this=6&impact=3&frequence=4&allele_quality=5&report_mode=1&project_summary=1&all_coverage=1&table_variations=1&sanger_variations=1&validated_variations=1&all_variations=1&denovo=1&recessive=1&xor=1&both=1&utr=1&intronic=1&all=1&span=20&limit=30&user_name=masson&patients="+child_name;
		arguments += "&vectors_hex="+list_chr_vector_hex.join('::');
		var xhr = new XMLHttpRequest();
		xhr.responseType = 'html';
		xhr.open('POST', url_diag, true);
		xhr.setRequestHeader('Content-type', 'application/x-www-form-urlencoded');
		xhr.onreadystatechange = function() { // Call a function when the state changes.
		    if (this.readyState === XMLHttpRequest.DONE && this.status === 200) {
		    	var div = document.getElementById('div_res_patient_polydiag');
				div.innerHTML = xhr.responseText;
				dijit.byId('waiting').hide();
				dijit.byId("dialog_patient_polydiag").show();
		    }
		}
		xhr.send(arguments);
	}
}

function hidePopupDiag() {
	dijit.byId("div_res_patient_polydiag").setHref("");
}

function collapse_all(names,labels){
    var ps = names.split(";"); 
    var ls = labels.split(";"); 
    console.dir(ps);
    for (i=0;i<ps.length;i++){
        
        collapse(ps[i],ls[i]);
    }
    //var d = document.getElementById(name);
    
}

var force_annotation_version = 'not';
function changeAnnotationVersion(annot_version) {
	force_annotation_version = annot_version;
	document.getElementById("startButton").click();
}

function collapse(name,label){
    var d = document.getElementById(name);
    var l;
     l = document.getElementById(label);
    if (d.classList.contains("in")) {
        d.classList.remove("in");
     if (l){
           l.classList.remove("glyphicon-triangle-bottom");
           l.classList.add("glyphicon-triangle-right");
        }
    }
    else {
        d.classList.add("in");
            l.classList.remove("glyphicon-triangle-right");
             l.classList.add("glyphicon-triangle-bottom");
        
    }
}

function show_coverage_detail() {
    var gene = return_geneId(listcompletion.get("value"));
    var url_igv2 ="../polyweb_coverage.html?project="+projectName+"&gene="+gene;
    window.open(url_igv2);
}

function show_coverage_detail_multi_genes() {
    var genes = lOnlyThesesGenes_coverage.join(",");
    var url_igv2 ="../polyweb_coverage.html?project="+projectName+"&gene="+genes;
    window.open(url_igv2);
}

function viewGraphic() {
    dijit.byId('waiting').show();
    var chr = chr_number.attr('value');
    var start = start_number.attr('value');
    var end =  end_number.attr('value');
    var ensg =  return_geneId(listcompletion.get("value"));
    if (ensg){
       initCoverViewer(ensg);
    }
    else {
        initFilterGenes(chr,start,end);
        //initCoverViewer(null,null,start,end,chr);
    }
    when_external_loaded_graph (function () {
        testx();
    });
}

function when_external_loaded_graph (callback) {
    var isEmpty1 = $('#drawing_transcripts').is(':empty');
    var isEmpty2 = $('#drawing_patients').is(':empty');
    if(isEmpty1 || isEmpty2) {
        setTimeout (function () {
            when_external_loaded_graph (callback);
        }, 100);
    } else { callback (); }
}

//fonction pour afficher un message indiquant le chargement des donnes
function testx(){
    if (!drawingOK){
        if (dijit.byId('waiting')) {
            dijit.byId('waiting').show();
        }
    }
    else {
        if (dijit.byId('waiting')) {
            dijit.byId('waiting').hide();
        }
    }
}   

function show_deja_vu() {
    var gene = return_geneId(listcompletion.get("value"));
    var url_igv2 ="../polydejavu/dejavu.html?input="+gene;
    window.open(url_igv2);
}

function initFilterGenes(chr,start,end,draw,id) {
     var url_genes2 =url_region_genes+"?project="+projectName+"&chr="+chr+"&start="+start+"&end="+end;
     var st = new dojo.data.ItemFileWriteStore({
            url: url_genes2
        });;
     st.fetch({
        query: {
                label:"*"
                },
        onComplete:function(items) { filterGenes.set("store",st);
            for (i=0;i<items.length;i++){
                if (items[i].name == id){
                    filterGenes.set("value",items[i].name);
                    return;
                }
            }
        filterGenes.set("value",items[0].name);
        
        },
    
        onError: function(items){alert("error filtering")}
    });
}

function stats (view_all_genes) {
    dijit.byId('waiting').show();
    var cgi_args = construct_url_filter_data(view_all_genes);
    loadAll(cgi_args);
    if (REGION_FILTER.length >0) { 
        refreshRegionsGrid(cgi_args);
    }
    refreshGridFilter();
    return cgi_args;
}

var tablayout = new Array("Coding","variations","Splicing","Silent","UTR");
var first_time_refresh = 1;

function refreshStats(args){
     var storeC = readStore(chr_url+args);
     storeC.fetch({
        query: {
                name:"*"
                },
        onComplete:printStats,
        onError: function(items){alert("error")}
    });
}

function printStats (items){
        var nb = 0;//items.length;  
        var nbchr = 0;
        var nbc = 0;
        var nbv = 0;
        var nbhomo = 0;
        var nbhetero = 0;
        var nbsample = 0;
        for (var i=0;i<items.length;i++){
            if (items[i].genes == '0') continue; 
            nbchr += 1;
            nb += items[i].genes*1.0;
            nbv += items[i]["substitutions"]*1.0+items[i]["deletions"]*1.0+items[i]["insertions"]*1.0;
            nbc += items[i]["coding"]*1.0;
            nbhomo += items[i]["homozygote"]*1.0;
            nbhetero += items[i]["heterozygote"]*1.0;
        }
        
            gridPatient.store.fetch({
     onComplete: function(items){
        var total =0;
         dojo.forEach(items, function(item){
            nbsample ++;
            var name = item.name;
            total = total + item.substitutions*1.0+item.insertions*1.0+item.deletions*1.0;
         });
        document.getElementById("stat_sample").textContent = nbsample;
        document.getElementById("stat_var").textContent = total;
        document.getElementById("stat_dif").textContent = nbv;
        document.getElementById("stat_chr").textContent = nbchr;
        document.getElementById("stat_gene").textContent = nb;
    }
    });
    var url2 = gene_url + "&filter_chromosome=" + items[0].name + filter_args;
     if (items[0].name == "Game Over") {
        return;
    }
}

var filter_args="";

function move(el,div) {
    document.getElementById(div).appendChild(document.getElementById(el));
}

function loadFilter (){
    gridViewFilter.store.fetch({
        onComplete:changeButtonStatut
    }); 
    dialog_view_filter.hide();
    dijit.byId("panel_custom_filters").set('open',true);
    document.getElementById("startButton").click();
    return;
}

var gridChr_allSelected = 0;

function viewAllChromosome (){
    if (gridChr_allSelected == 0) {
        gridChromosome.rowSelectCell.toggleAllSelection(true);
        enabledXlsExport();
        gridChr_allSelected = 1;
    }
    else {
        gridChromosome.rowSelectCell.toggleAllSelection(false);
        disabledXlsExport();
        gridChr_allSelected = 0;
    }
}

function get_args_vector(chr_ok){
    var ok = 0;
    var lOk = [];
    var hChrOk = {};
    var lTmp = chr_ok.split(',');
    dojo.forEach(lTmp, function(thisChr) {
        hChrOk[thisChr] = 1;
    });
    var lChr = [];
    dojo.forEach(gridChromosome._by_idx, function(item, index){
        var chr_name;
        var selectedItem = gridChromosome.getItem(index);
        dojo.forEach(gridChromosome.store.getAttributes(selectedItem), function(attribute) {
            if (gridChromosome.selection.isSelected(index)) {
                var value = gridChromosome.store.getValues(selectedItem, attribute);
                if (attribute == "id" ) {
                    chr_name = value;
                    lChr.push(chr_name);
                    if (chr_name in hChrOk) {
                        ok = 1;
                        lOk.push(chr_name);
                    }
                }
            }
        });
    });
    var filter_args = construct_url_filter_data();
    var url = gene_url + filter_args;
    if (chr_ok == 'other') { url += "&filter_chromosome=all"; }
    else if (ok == 0)         { return 'not'; }
    // else                      { lChrXlsSubPart.push(chr_ok); }
    else { url += "&filter_chromosome=" + lOk.join(','); }
    return url;
}

var is_export_xls = 0;
var is_export_xls_var = 0;
var is_export_xls_genes = 0;
function export_filter_by_genes(){
    document.getElementById("wait2").src="../images/polyicons/wait18trans.gif";
    dijit.byId('waiting_xls_progress').set('title', 'Export XLS by Genes'); 
    var hurl = get_args_vector('other');
    hurl += "&view_all_genes=1";
    hurl += "&xls_by_genes=1";
    hurl += "&xls_outfile=none";
    if (lOnlyThesesGenes.length > 0) {
        hurl += "&only_genes='"+lOnlyThesesGenes.join(",")+"'";
    }
    hurl = hurl.replace('?', ' ');
    hurl = hurl.replace(/&/g, ' ');
    dijit.byId("url_xls").set("value", hurl);
    is_export_xls = 1;
    is_export_xls_var = 0;
    is_export_xls_genes = 1;
    document.getElementById("startButton").click();
    return;
}

function export_filter_by_variations(){
    document.getElementById("wait2").src="../images/polyicons/wait18trans.gif";
    dijit.byId('waiting_xls_progress').set('title', 'Export XLS by Variations'); 
    var can_launch = can_launch_export_xls_var();
    var hurl = get_args_vector('other');
    hurl += "&view_all_genes=1";
    hurl += "&xls_by_variants=1";
    hurl += "&xls_outfile=none";
    if (lOnlyThesesGenes.length > 0) {
        hurl += "&only_genes='"+lOnlyThesesGenes.join(",")+"'";
    }
    hurl = hurl.replace('?', ' ');
    hurl = hurl.replace(/&/g, ' ');
    dijit.byId("url_xls").set("value", hurl);
    if (can_launch == 1) {
        is_export_xls = 1;
        is_export_xls_var = 1;
        is_export_xls_genes = 0;
        document.getElementById("startButton").click();
        return;
    }
    document.getElementById("waiting_xls_progress_text").innerHTML = "<b><u>Sorry, export XLS by var is impossible: ERROR process or too much variants (LIMIT: 10000 uniq variants)...</b></u>";
    myProgressBarXls.set( { value: 125 } );
    dijit.byId('waiting_xls_progress').show();
    return;
}

function can_launch_export_xls_var() {
    var nb_var = 0;
    dojo.forEach(gridChromosome._by_idx, function(item, index){
        var chr_name;
        var selectedItem = gridChromosome.getItem(index);
        dojo.forEach(gridChromosome.store.getAttributes(selectedItem), function(attribute) {
            if (gridChromosome.selection.isSelected(index)) {
                var value = gridChromosome.store.getValues(selectedItem, attribute);
                if (attribute == "variations" ) {
                    nb_var += parseInt(value);
                }
            }
        });
    });
    if (parseInt(nb_var) <= 10000) { return 1; }
    else { return 0; }
}

function downloadFile_inprogress() {
    document.getElementById("wait2").src="/icons/Polyicons/12-em-check.png";
    document.getElementById("waiting_xls_progress_text").innerHTML = "<b> Downloading XLS file</b><br>Sometimes, your browser can download your XLS files in your <i><b><u>Download</i></b></u> or <i><b><u>Telechargements</i></b></u> directory automatically.";
}

dojo.require("dojo.io.iframe");
function downloadFile(url) {
    var downloadPdfIframeName = "downloadPdfIframe"; 
    var iframe = dojo.io.iframe.create(downloadPdfIframeName, downloadFile_inprogress());
    dojo.io.iframe.setSrc(iframe, url, true);
} 

var REGION_FILTER = new Array();

function url_filter_regions(chr_id) {
	var list_bed = [];
    var list_regions = '';
    for (i=0;i<REGION_FILTER.length;i++){   
        var item = REGION_FILTER[i];
        if (item){
        	var first = String(item.chromosome);
        	if (first.match("file")) {
        		var ltmp = first.split(':');
        		list_bed.push(ltmp[1]);
        	}
        	else {
	        	var id = item.chromosome+":"+item.start+":"+item.end+":"+item.include;
	        	if (chr_id) {
	        		if (chr_id == item.chromosome) {
		            	if (id != ':::0' && id != ':::1' && id != ':::-1') { list_regions += id + "+"; }
	        		}
	        	}
	        	else {
	            		if (id != ':::0' && id != ':::1' && id != ':::-1') { list_regions += id + "+"; }
	        	}
        	}
        }
        else{
            //console.log(i);
        }
    }
    var args = '';
    if (REGION_FILTER.length == 0){
        return args;
    }
    if (list_regions != '') {
	    args ="&filter_region=";
	    args += list_regions;
    }
    if (list_bed.length > 0) {
    	args = "&filter_bed=";
    	args += list_bed.join(',');
    }
    return args;
}

function functional_url_filter_data (){
    var filters = "";
    var ab = defineArrayButton();
    for (z in ab){
        if (ab[z] == 'filter_substitution' || ab[z] == 'filter_insertion' || ab[z] == 'filter_deletion' || ab[z] == 'filter_cnv' || ab[z] == 'filter_not_cosmic' || ab[z] == 'filter_cosmic') {
            var widget = dijit.byId(ab[z]);
            if (widget.get("value") == 'off') {
            	if (z == 'cnv') {
            		filters += "large_deletion+large_insertion+large_duplication+";
            	}
            	else {
					filters += z + "+";
				}
            }
        }
        if (dijit.byId(ab[z]).checked == false){
            filters += z + "+";
        }
	}
    if      (dijit.byId("filter_nofreq").get("value") == "off")   { filters += "freq_none+"; }
    if      (dijit.byId("filter_clinical").get("value") == "off") { filters += "pheno_snp+";  }
    
	if (use_db_freq_or_gnomad_ac == 'db_freq') {
	    if      (dijit.byId("slider_frequence").get("value") == 1)    { filters += "freq_001+freq_01+freq_05+freq_1+"; }
	    else if (dijit.byId("slider_frequence").get("value") == 2)    { filters += "freq_01+freq_05+freq_1+"; }
	    else if (dijit.byId("slider_frequence").get("value") == 3)    { filters += "freq_05+freq_1+"; }
	    else if (dijit.byId("slider_frequence").get("value") == 4)    { filters += "freq_1+"; }
    }
    
    if (dijit.byId("slider_predictions").get("value") == 1)       { filters += "prediction_0+prediction_1+prediction_2+intergenic+"; }
    else if (dijit.byId("slider_predictions").get("value") == 2)  { filters += "prediction_0+prediction_1+intergenic+"; }
    else if (dijit.byId("slider_predictions").get("value") == 3)  { filters += "prediction_0+intergenic+"; }
    
    if (dijit.byId("slider_cadd").get("value") == 1)       { filters += "cadd_25+cadd_20+cadd_15+cadd_10+cadd_5+cadd_0+cadd_not+"; }
    else if (dijit.byId("slider_cadd").get("value") == 2)  { filters += "cadd_20+cadd_15+cadd_10+cadd_5+cadd_0+cadd_not+"; }
    else if (dijit.byId("slider_cadd").get("value") == 3)  { filters += "cadd_15+cadd_10+cadd_5+cadd_0+cadd_not+"; }
    else if (dijit.byId("slider_cadd").get("value") == 4)  { filters += "cadd_10+cadd_5+cadd_0+cadd_not+"; }
    else if (dijit.byId("slider_cadd").get("value") == 5)  { filters += "cadd_5+cadd_0+cadd_not+"; }
    else if (dijit.byId("slider_cadd").get("value") == 6)  { filters += "cadd_0+cadd_not+"; }
    
    if (dijit.byId("slider_confidence").get("value") == 1)        { filters += "ngs_score1+ngs_score0+"; }
    else if (dijit.byId("slider_confidence").get("value") == 2)   { filters += "ngs_score0+"; }
    
    return filters;
}

//var nb_atleast = 0;

function construct_url_filter_data (chr_id) {
    var filter_args= "";
    var args = new Array();
    filter_args  = "&filter_type_variation=" + functional_url_filter_data();
	if (genetic_model == 'compound_multi' || genetic_model == 'recessif_compound_multi' || genetic_model == 'uniparental_recessif_compound_multi') {
		apply_compound_multi_annot();
		filter_args += "&filter_type_variation_2=intergenic+" + list_compound_multi_annot_2.join('+') + "+";
	    var ab = defineArrayButton();
	    for (z in ab){
	        if (ab[z] == 'filter_substitution' || ab[z] == 'filter_insertion' || ab[z] == 'filter_deletion' || ab[z] == 'filter_cnv' || ab[z] == 'filter_not_cosmic' || ab[z] == 'filter_cosmic') {
	            var widget = dijit.byId(ab[z]);
	            if (widget.get("value") == 'off') {
	            	if (z == 'cnv') {
	            		filter_args += "large_deletion+large_insertion+large_duplication+";
	            	}
	            	else {
						filter_args += z + "+";
					}
	            }
	        }
		}
	    if      (dijit.byId("slider_frequence_2").get("value") == 1)    { filter_args += "freq_001+freq_01+freq_05+freq_1+"; }
	    else if (dijit.byId("slider_frequence_2").get("value") == 2)    { filter_args += "freq_01+freq_05+freq_1+"; }
	    else if (dijit.byId("slider_frequence_2").get("value") == 3)    { filter_args += "freq_05+freq_1+"; }
	    else if (dijit.byId("slider_frequence_2").get("value") == 4)    { filter_args += "freq_1+"; }
	    
	    
	    if (dijit.byId("slider_cadd").get("value") == 1)       { filter_args += "cadd_25+cadd_20+cadd_15+cadd_10+cadd_5+cadd_0+cadd_not+"; }
	    else if (dijit.byId("slider_cadd").get("value") == 2)  { filter_args += "cadd_20+cadd_15+cadd_10+cadd_5+cadd_0+cadd_not+"; }
	    else if (dijit.byId("slider_cadd").get("value") == 3)  { filter_args += "cadd_15+cadd_10+cadd_5+cadd_0+cadd_not+"; }
	    else if (dijit.byId("slider_cadd").get("value") == 4)  { filter_args += "cadd_10+cadd_5+cadd_0+cadd_not+"; }
	    else if (dijit.byId("slider_cadd").get("value") == 5)  { filter_args += "cadd_5+cadd_0+cadd_not+"; }
	    else if (dijit.byId("slider_cadd").get("value") == 6)  { filter_args += "cadd_0+cadd_not+"; }
	    
		genetic_model_compound_multi = genetic_model_compound_multi.toLowerCase();
		if (genetic_model_compound_multi != 'none') { filter_args += "&model_2=" + genetic_model_compound_multi; }
		//alert ('FILTER ARGS: '+filter_args);
	//}
	//if (genetic_model == 'compound' && document.getElementById("fam_compound_multi_filters").checked == true) { 
	    var dejavu_value_2 = get_value_slider_dejavu('second_slider');
	    if (dejavu_value_2 < max_project) {
	        if      (dejavu_value_2 == 0)  { filter_args += "&dejavu_2=uniq"; }
	        else if (dejavu_value_2 < 100) { filter_args += "&dejavu_2=" + dejavu_value_2; }
	    }
	    
    }
	if (use_db_freq_or_gnomad_ac == 'gnomad_ac') {
	    if      (dijit.byId("slider_gnomad_ac").get("value") == 1)    { filter_args += "&gnomad=gnomad_ac_5"; }
	    else if (dijit.byId("slider_gnomad_ac").get("value") == 2)    { filter_args += "&gnomad=gnomad_ac_10"; }
	    else if (dijit.byId("slider_gnomad_ac").get("value") == 3)    { filter_args += "&gnomad=gnomad_ac_20"; }
	    else if (dijit.byId("slider_gnomad_ac").get("value") == 4)    { filter_args += "&gnomad=gnomad_ac_50"; }
	    else if (dijit.byId("slider_gnomad_ac").get("value") == 5)    { filter_args += "&gnomad=gnomad_ac_100"; }
    }
    filter_args +=url_filter_regions(chr_id);
    //model genetique
    if (genetic_model != "None") {
		if (genetic_model == 'compound_multi') { filter_args +="&model=compound"; }
		else if (genetic_model == 'recessif_compound_multi') { filter_args +="&model=recessif_compound"; }
		else if (genetic_model == 'uniparental_recessif_compound_multi') { filter_args +="&model=uniparental_recessif_compound"; }
        else { filter_args +="&model="+genetic_model; }
    }
    //model for somatique
    //if (filter_loh.checked) { filter_args +="&filter_loh=1"; }
    //if (filter_dblevt.checked) { filter_args +="&filter_dblevt=1"; }
    //text search
    if (dijit.byId("filter_text").get("value")) {
        var text_value = dijit.byId("filter_text").get("value");
        if (text_value != "Search gene or onthology..." ) { filter_args +="&filter_text="+text_value; }
    }
    //filtre famillial lock
    if (filtering_mode == 'fam') { filter_args +="&mode=fam"; }
    else if (filtering_mode == 'somatic') { filter_args +="&mode=somatic"; }
    else { filter_args +="&mode=ind"; }
    //filter at least number 
    if (filter_identical_number.value > 1) { filter_args +="&nb="+filter_identical_number.value; }
    // type gene or variation
    filter_args +="&level_ind="+filtering_level_ind;    
    filter_args +="&level_fam="+filtering_level_fam;
    //dejavu
    var dejavu_value = get_value_slider_dejavu();
    if (dejavu_value < max_project) {
        if      (dejavu_value == 0)  { filter_args += "&dejavu=uniq"; }
        else if (dejavu_value < 100) { filter_args += "&dejavu=" + dejavu_value; }
        if (dijit.byId("dejavu_ho").get("value") == "off") { filter_args +="&dejavu_ho=1"; }
    }
    
    if (dijit.byId("filter_cadd_keep_indels").checked == true) { filter_args +="&keep_indels_cadd=1"; }
    
    // patient filter
    var string_patient_and ="";
    var string_patient_not="";
    var string_patient_he="";
    var string_patient_ho="";
    var string_patient_attic="";
        
    for (var name in patients_status){
        var v = patients_status[name]["include"];
        var vv =  patients_status[name]["filter_heho"];
        if (v == 0) {
            string_patient_and += name+"+";
        }
        if (v == -1) {
        	string_patient_not += name+"+";
        }
        if (v == -2) {
        	string_patient_not += name+"+";
        }
        if (v == 2) {
            string_patient_attic += name+"+";
        }
        if (vv == 0) {
            string_patient_he +=name+"+";
        } 
        if (vv == 1) {
            string_patient_ho +=name+"+";
        } 
    }
    if (string_patient_and && string_patient_and != '+') filter_args += "&filter_patient="+string_patient_and;
    if (string_patient_not && string_patient_not != '+') filter_args += "&filter_not_patient="+string_patient_not;
    if (string_patient_attic && string_patient_attic != '+') filter_args +="&filter_attic="+string_patient_attic;
    if (string_patient_he && string_patient_he != '+') filter_args += "&filter_he="+string_patient_he;
    if (string_patient_ho && string_patient_ho != '+') filter_args += "&filter_ho="+string_patient_ho;
    // famillial test
    var string_fam_and ="";
    var string_fam_not="";
    for (var name in families_status){
        var v = families_status[name]["include"];
        var vv =  families_status[name]["filter_heho"];
        if (v == 0) {
            string_fam_and += name+"+";
        }
    	if (v == -1) {
        	string_fam_not += name+"+";
        }
        if (v == -2) {
        	string_fam_not += name+"+";
        }
    }
    if (string_fam_and && string_fam_and != '+') filter_args += "&fam_and="+string_fam_and;
    if (string_fam_not && string_fam_not != '+') filter_args += "&fam_not="+string_fam_not;
    if (view_all_genes == 1) { filter_args += "&view_all_genes=1"; }
    if (dijit.byId("slider_ncboost").get("value") == 1)       { filter_args += "&ncboost=high"; }
    else if (dijit.byId("slider_ncboost").get("value") == 2)  { filter_args += "&ncboost=medium"; }
    else if (dijit.byId("slider_ncboost").get("value") == 3)  { filter_args += "&ncboost=moderate"; }
    
    if (dijit.byId("slider_ratio_min").get("value") == 2)       { filter_args += "&min_ratio=10"; }
    else if (dijit.byId("slider_ratio_min").get("value") == 3)  { filter_args += "&min_ratio=20"; }
    else if (dijit.byId("slider_ratio_min").get("value") == 4)  { filter_args += "&min_ratio=40"; }
    else if (dijit.byId("slider_ratio_min").get("value") == 5)  { filter_args += "&min_ratio=80"; }
    
    if (dijit.byId("slider_ratio_max").get("value") == 1)       { filter_args += "&max_ratio=10"; }
    else if (dijit.byId("slider_ratio_max").get("value") == 2)  { filter_args += "&max_ratio=20"; }
    else if (dijit.byId("slider_ratio_max").get("value") == 3)  { filter_args += "&max_ratio=40"; }
    else if (dijit.byId("slider_ratio_max").get("value") == 4)  { filter_args += "&max_ratio=80"; }
    
    
//    if (view_all_genes == 1) { filter_args += "&view_all_genes=1"; }
//    if (dijit.byId("slider_polyscore").get("value") == 1)       { filter_args += "&polyscore=high"; }
//    else if (dijit.byId("slider_polyscore").get("value") == 2)  { filter_args += "&polyscore=medium"; }
//    else if (dijit.byId("slider_polyscore").get("value") == 3)  { filter_args += "&polyscore=moderate"; }
    
    if (get_value_slider_regionho() > 1){
    	var nb_var = get_value_slider_regionho();
    	filter_args += "&filter_nbvar_regionho="+nb_var;
    	if (dijit.byId("filter_region_ho_rec_only_sub").get("value") == "off") { filter_args +="&filter_region_ho_rec_only_sub=1"; }
    	if (document.getElementById("stat_filtering_type").textContent == "Individual") {
    		if (can_use_hgmd == 'yes') {
    			dijit.byId("gridListGenes").set("structure", "layoutListGenesWithRegionHoHgmd");
    		}
    		else {
        		dijit.byId("gridListGenes").set("structure", "layoutListGenesWithRegionHo");
    		}
    	}
    	else if (document.getElementById("stat_filtering_type").textContent == "Familial") {
    		if (can_use_hgmd == 'yes') {
    			dijit.byId("gridListGenes").set("structure", "layoutListGenesWithRegionRecHgmd");
    		}
    		else {
        		dijit.byId("gridListGenes").set("structure", "layoutListGenesWithRegionRec");
    		}
    	}
    }
    else if (get_value_slider_regionho() == 0){
    	if (can_use_hgmd == 'yes') {
    		dijit.byId("gridListGenes").set("structure", "layoutListGenesHgmd");
    	}
    	else {
        	dijit.byId("gridListGenes").set("structure", "layoutListGenes");
    	}
    }
    return filter_args;
}

function showFilter(){
    dialog_filter.show();
    var string_patient_and   = "";
    var string_patient_not   = "";
    var string_patient_he    = "";
    var string_patient_ho    = "";
    var string_patient_attic = "";
    var string_region        = "";
    var string_fam_and       = "";
    var string_fam_not       = "";
    var string_dejavu        = "";
    var string_dejavuho      = "";
    for (var name in patients_status){
        var v = patients_status[name]["include"];
        var vv =  patients_status[name]["filter_heho"];
        if (v == 0) {
            string_patient_and += name+"+";
        }
        if (v == -1) {
        string_patient_not += name+"+";
        }
        if (v == 2) {
            string_patient_attic += name+"+";
        }
        if (vv == 0  ) {
            string_patient_he +=name+"+";
        } 
        if (vv == 1) {
            string_patient_ho +=name+"+";
        } 
    }
    for (i=0;i<gridRegion.rowCount;i++){
        var item = gridRegion.getItem(i);
        if (item) {     
            string_region += item.chromosome+":"+item.start+":"+item.end+":"+item.include+" ";
        }
    }
    for (var name in families_status){
        var v = families_status[name]["include"];
        if (v == 0) {
            string_fam_and += name+"+";
        }
        if (v == -1) {
        string_fam_not += name+"+";
        }
    }
    var value_dejavu = get_value_slider_dejavu();
    if (value_dejavu < 100) {
        if (dijit.byId("dejavu_ho").get("value") == "on") {
            string_dejavu = value_dejavu;
        }
        else { string_dejavuho = value_dejavu; }
    }
    myForm.set('value', {filter_fam: string_fam_and}) ;
    myForm.set('value', {filter_not_fam: string_fam_not});
    myForm.set('value', {filter_patient: string_patient_and}) ;
    myForm.set('value', {filter_not_patient: string_patient_not});
    myForm.set('value', {filter_he: string_patient_he});
    myForm.set('value', {filter_ho: string_patient_ho});
    myForm.set('value', {filter_dejavu: string_dejavu});
    myForm.set('value', {filter_dejavuho: string_dejavuho});
    myForm.set('value', {filter_attic: string_patient_attic});
    myForm.set('value', {filter_region: string_region});
    myForm.set('value', {user: user_name});
    myForm.set('value', {project: projectName});
    myForm.set('value', {filter_type_variation:functional_url_filter_data()});
    myForm.set('value', {filter_level_fam:filtering_level_fam});
    myForm.set('value', {filter_level_ind:filtering_level_ind});
    myForm.set('value', {filter_mode:filtering_mode});
    if (genetic_model != "None"){
        myForm.set('value',{filter_genetic_model:genetic_model});
    }
    if (lOnlyThesesGenes.length > 0) {
        var genes = lOnlyThesesGenes.join(' ');
        myForm.set('value', {filter_level_only_genes:genes});
    }
    return;
}

function deleteFilter(){
    var items = gridFilter.selection.getSelected();
    var filter_id = items[0].id;
    user_name = dojo.cookie("username");
    var this_url = url_delete_filter + "?project=" + projectName + "&user=" + user_name + "&filter_id=" + filter_id;
    $.ajax({
        url: this_url,
        dataType: "text",
        success: function(data){
            refreshGridFilter();
        }
    });
}

function saveFilter(){
    if (myForm.get('value').name == "") {
        alert("Error: please give name to your filter");
        return;
    }  
    var tuser_name = dojo.cookie("username");
    filter_username.set("value",tuser_name);
   var xhrArgs = {
            form: dojo.byId("myForm"),
            handleAs: "text",
            url:url_save_filter,
            load: function(data) {
            
                    
                    refreshGridFilter();
                    dialog_filter.hide();
              //  dojo.byId("response").innerHTML = "Form posted.";
            },
            error: function(error) {
                //We'll 404 in the demo, but that's okay.  We don't have a 'postIt' service on the
                //docs server.
                alert("error");
               
            }
       };
    var deferred = dojo.xhrPost(xhrArgs);
}

function delete_filter(){
    gridRegion.removeSelectedRows();
    update_regions_cache(gridRegion.store);
}

function viewFilter (){
    var items= gridFilter.selection.getSelected();
    user_name = dojo.cookie("username");
    if (items.length) {
        var arg = "&filter_id=" + items[0].id + "&user=" + user_name;
        var storeC = readStore( url_view_filter_vector+arg);
        dialog_view_filter.show();
        refreshGrid(gridViewFilter,storeC);
    }
    return;
}

function change_status_buttons (buttons){
    for(i=0;i<buttons.length;i++){
        buttons[i].set('checked', false);
    }
}

function change_button(b){
    if (b.checked) {
         b.set('checked', false);
    }
    else {
         b.set('checked', true);
    }
}

function viewIGV () {
    var chr = chr_number.get('value');
    var start = start_number.get('value');
    var end =  end_number.get('value');
    displayInIGV(chr,start,end);
}

function jumpToAllVar(items) {
    var ids="";
    var tids = new Array();
    var chr_name="";
    for (var i=0 ;i<items.length;i++){
        ids += items[i].ids+",";
        if (!tids[items[i].chromosome]){
            tids[items[i].chromosome] ="";
            chr_name+=items[i].chromosome+"+";
        }
        tids[items[i].chromosome]+= items[i].ids+",";
    }
    var murl = "detailProject_v2.html?project="+projectName+"&chromosome="+chr_name+"&type="+project_type+"&ids="+ids+"&nograph=1";
    window.open(murl);
}

function viewAllSelectedVariations () {
    var store = gridListGenes.store;
    store.fetch ({
        onComplete: jumpToAllVar
    });
}

function showCapturesFromTranscriptsIds(values) {
	var this_url = url_path + "json_output_nodb/captures_diag_from_transcripts.pl?tr_ids=" + values;
    dijit.byId('waiting').show();
	var xhrArgs = {
        handleAs: "json",
        url: this_url,
        load: function(data) {
        	dijit.byId('waiting').hide();
			var lCapt = data.items;
			var text = "Found in capture(s)\n";
    		for (i=0; i<lCapt.length; i++) {
    			text += "\n - " + lCapt[i];
    		}
    		alert(text);
        },
        error: function(error) {
            alert("error");
        }
	};
	var deferred = dojo.xhrGet(xhrArgs);
}

function showHgmdDejaVu_genes() {
	zoomHgmdDejaVu(projectName, '', lOnlyThesesGenes.join(','));
}

function showHgmdDejaVu_patients() {
    var listPatNames = getSelectedPatName();
	zoomHgmdDejaVu(projectName, listPatNames.join(','));
}

function zoomHgmdDejaVu(project, patient, genes){
    var cgi_args = "?project=" + project;
    if (patient) { cgi_args += "&patient=" + patient + "&interface_view=by_variants"; }
    if (genes) { cgi_args += "&genes=" + genes; }
    var hurl = "../hgmd/polyhgmd_by_user.html" + cgi_args;
    window.open(hurl);
}	

function exportVcf() {
    var filter_args = construct_url_filter_data();
    var listPatNames = getSelectedPatName();
    var cgi_args = construct_url_filter_data();
    cgi_args += "&export_vcf_for="+listPatNames.join('+');
    var hurl = cache_all_url + cgi_args;
    alert ("Click OK and wait your file patiently please. Thanks.");
    //alert (hurl);
    downloadFile(hurl);
    //console.log(hurl);
    //window.location = hurl;
}

function getSelectedPatName() {
    var grid = dijit.byId("gridPatient");
    var list = [];
    dojo.forEach(grid.selection.getSelected(), function (item,i) {
        var name = grid.store.getValue(item,"name");
        list.push(name);
    })
    return list;
}

function enable_button(me,other,buttons,bool){
    for (i=0;i<buttons.length;i++){
        buttons[i].setAttribute("disabled",bool);
    }
    me.setAttribute("disabled",true);
    other.setAttribute("disabled",false);
    if (bool){
        dd_genet.setAttribute("iconClass","individualIcon24");
        PanePatient.setAttribute('style','background-color:#00FFA6'); //FFFB00
    }
    else {
    dd_genet.setAttribute("iconClass","familyIcon24");
    PanePatient.setAttribute('style','background-color:#FF0000');
    }
}
   
function loadAll (args,exclude) {
    dijit.byId('waiting').show();
     var g = genetic_model;
      change_filtering_type(filtering_mode);
      change_filtering_model(g);
    var hurl = cache_all_url+args;
    //alert (hurl);
    var xhrArgs = {
        url: hurl,
        timeout:0,
        handleAs: "json",
        load: function(data) {
            // Grid patient update 
            var store_patients = new dojo.data.ItemFileWriteStore({data:  {
                identifier: 'id',
                label: 'id',
                items: data.items.patients
            }});
            
            refreshGrid(gridPatient,store_patients);
            gridPatient.store.fetch({
                onItem :function (item, result){
                    var name= gridPatient.store.getValue(item,"name");
                    var value= gridPatient.store.getValue(item,"include");
                    var value2= gridPatient.store.getValue(item,"filter_heho");
                    if (!patients_status[name]) patients_status[name] = new Array(); 
                    patients_status[name]["include"]=value;
                    patients_status[name]["filter_heho"]=value2;
                },
                onComplete: function (items, result){
                    hide_attic();
                }   
            }); 
    
            // grid Genes update      
            var store_genes = new dojo.data.ItemFileWriteStore({data:  {
                identifier: 'id',
                label: 'id',
                items: data.items.genes
            }});    
            
            refreshGrid(gridListGenes,store_genes);
            
            // Tree diseases update     
            // if (exclude != "diseases"){
                // var store_diseases = new dojo.data.ItemFileWriteStore({data:  {
                    // identifier: 'id',
                    // label: 'name',
                    // items: data.items.diseases
                // }}); 
                // refreshDiseasesTree(store_diseases);
//      
            // }
            
            // Grid Families update     
            var store_families = new dojo.data.ItemFileWriteStore({data:  {
                identifier: 'id',
                label: 'id',
                items: data.items.families
            }});
            
            refreshGrid(gridFamilies,store_families);
            gridFamilies.store.fetch({
                    onItem :function (item, result){
                    var name= gridFamilies.store.getValue(item,"name");
                    if (name) { dijit.byId("button_fam_model").set("disabled", ""); }
                    var value= gridFamilies.store.getValue(item,"include");
                    if (!families_status[name]) families_status[name] = new Array(); 
                    families_status[name]["include"]=value;
                },
                onComplete: function (items, result){
                    hide_attic();
                }
            }); 
            
            // Grid chromosome update   
            var store_chr = new dojo.data.ItemFileWriteStore({data:  {
                identifier: 'id',
                label: 'id',
                items: data.items.chromosomes
            }});    
            
             store_chr.fetch({
                query: { name:"*" },
                onComplete:printStats,
                //query: { genes: new RegExp("[1-9]+") },
                // onComplete: function(items){
                    // gridChromosome.filter({genes: new RegExp("[1-9]+")});
                    // printStats;
                // },
                onError: function(items){alert("error loading chromosome data");}
            });
            if (exclude != "chromosomes"){ refreshGrid(gridChromosome,store_chr); }
            
                dijit.byId('waiting').hide();
            },
            error: function(error) {
               alert("ERROR.... " + error);
               console.log(hurl);
            }
        
        

       };
      var deferred = dojo.xhrGet(xhrArgs);
}

function check_enter(e){
   if(e.keyCode==13){
    setPassword();
   }
}

function hide_attic(){
    if (button_hide_attic.checked){
    gridPatient.filter({include:new RegExp("1|0|-1")},true);
    gridFamilies.filter({include:new RegExp("1|0|-1")},true);
    }
    else {
        gridPatient.filter({name:"*"});
    }
}


var use_db_public_gnomad_ac = 'db_public';
function change_db_public_gnomad_ac(mode) {
	if (mode == 'db_public') {
		use_db_public_gnomad_ac = 'db_public';  
        dijit.byId("drop_db_public_gnomad").set("label", "Use DB Public");  
		document.getElementById("td_slider_gnomad_ac").style.display = "none";
		document.getElementById("td_slider_frequence").style.display = "block";
	}
	else if (mode == 'gnomad_ac') {
		use_db_public_gnomad_ac = 'gnomad_ac';
		dijit.byId("drop_db_public_gnomad").set("label", "Use gnomAD AC");
		document.getElementById("td_slider_frequence").style.display = "none";
		document.getElementById("td_slider_gnomad_ac").style.display = "block";
	}
}

var filtering_mode ='ind';
function change_filtering_type(mode,u) {
   filtering_mode = mode;
   // dijit.byId('at_least_genes').set('value', '1');
   // do_at_least_genes();
   if (mode == 'somatic') {
        dojo.style("PaneFamilies", {"opacity": 1});
        document.getElementById("stat_filtering_type").textContent = "Somatic";
        famind = 'Som';
        dojo.style("div_select_model_somatic", {"display": "inline-block"});   
        dojo.style("div_select_model_families", {"display": "none"}); 
        dojo.style("div_select_model_individual", {"display": "none"});
        
        // dojo.style("toolbar_1", { "box-shadow": "#EACD98"});
        // dojo.style("toolbar_patients", { "background-color": "#EACD98" });
        // dojo.style("toolbar_families", { "background-color": "#EACD98" });
        // dojo.style("content_pane_pat_fam", { "border-color": "#EACD98", "padding": "0px" });
         
        dijit.byId("drop_type_filter").set("iconClass", "familyIcon24");   
        dijit.byId("drop_type_filter").set("label",  "Somatic");  
        document.getElementById("repet_ind_fam_som").src = "../images/polyicons/man-icon24.png";
        document.getElementById("txt_repet_ind_fam_som").textContent = "Somatic";
        document.getElementById("at_least_var_text").textContent = "Gr.";
        // document.getElementById("at_least_genes_text").textContent = "Group";
   }
   else if (mode == "fam"){
        dojo.style("PaneFamilies", { "opacity": 1 });
        //dojo.style("stat_filtering_type", { "color": "#FF0000"});
       
        // dojo.style("toolbar_1", { "box-shadow": "#8CC244"});
        // dojo.style("toolbar_patients", { "background-color": "#8CC244" });
        // dojo.style("toolbar_families", { "background-color": "#8CC244" });
        // dojo.style("content_pane_pat_fam", { "border-color": "#8CC244", "padding": "0px" });
        
        document.getElementById("stat_filtering_type").textContent = "Familial";
        famind = 'Fam';
        dojo.style("div_select_model_families", {"display": "inline-block"});   
        dojo.style("div_select_model_individual", {"display": "none"}); 
        dojo.style("div_select_model_somatic", {"display": "none"}); 
        dijit.byId("drop_type_filter").set("iconClass", "familyIcon24");   
        dijit.byId("drop_type_filter").set("label",  "Familial");   
        document.getElementById("repet_ind_fam_som").src = "../images/polyicons/family-on.png";
        document.getElementById("txt_repet_ind_fam_som").textContent = "Familial";
        document.getElementById("at_least_var_text").textContent = "Fam";
        // document.getElementById("at_least_genes_text").textContent = "Family";
    } 
    else {
        dojo.style("PaneFamilies", {"opacity": 0.3,"border-color":"#FFFFFF"});
        dojo.style("div_select_model_families", {"display": "none"});
        dojo.style("div_select_model_individual", { "display": "inline-block"}); 
        dojo.style("div_select_model_somatic", {"display": "none"});    
        document.getElementById("stat_filtering_type").textContent = "Individual";
        famind = 'Ind';
        //dojo.style("stat_filtering_type", {"color": "#00FF7F"});
        dijit.byId("drop_type_filter").set("iconClass",  "individualIcon24");
        dijit.byId("drop_type_filter").set("label",  "Individual"); 
        document.getElementById("repet_ind_fam_som").src = "../images/polyicons/man-icon24.png";
        document.getElementById("txt_repet_ind_fam_som").textContent = "Individual";
        document.getElementById("at_least_var_text").textContent = "Pat";
        // document.getElementById("at_least_genes_text").textContent = "Patient";
    }
    change_filtering_model("None");
    if (isIntersectGenes == 1) {
        viewPatientsImplicated("intersect");
    }
    check_slider_regionho();
}

var genetic_model= 'None';

var dialog_compound_multi_annot_shown = 0;
function change_filtering_model(model, launch_run) {
    genetic_model = model;
    document.getElementById("stat_filter_model").textContent = model;
	document.getElementById("span_run_msg").innerHTML = "<b>&nbsp;&nbsp;RUN&nbsp;</b>";
    if (filtering_mode=="somatic") {
        dijit.byId("drop_type_model_somatic").set("label",  "Genetic Model ("+model+")");
        if (model == "None"){ dijit.byId("drop_type_model_somatic").set("iconClass",  "treeIcon32nb"); }
        else { dijit.byId("drop_type_model_somatic").set("iconClass",  "treeIcon32"); }
    }
    else if (filtering_mode=="fam") {
        dijit.byId("drop_type_model_families").set("label",  "Genetic Model ("+model+")");
        if (model == "None"){ dijit.byId("drop_type_model_families").set("iconClass",  "treeIcon32nb"); }
        else { dijit.byId("drop_type_model_families").set("iconClass",  "treeIcon32"); }
		if (model == 'compound_multi' || model == 'recessif_compound_multi' || model == 'uniparental_recessif_compound_multi') {
			var model_name = model.replace('_multi', '');
			dijit.byId("drop_type_model_families").set("label",  "Genetic Model ("+model_name+")");
        	document.getElementById("span_run_msg").innerHTML = "<b>&nbsp;&nbsp;2nd VAR&nbsp;</b>";
			if (launch_run) {}
			else {
				check_slider_dejavu_init();
				check_slider_freq_init();
			}
        }
    }
    else {
        dijit.byId("drop_type_model_individual").set("label",  "Genetic Model ("+model+")");
        if (model == "None"){ dijit.byId("drop_type_model_individual").set("iconClass",  "oneIconnb"); }
        else { dijit.byId("drop_type_model_individual").set("iconClass",  "oneIcon"); }
    }
}

var genetic_model_compound_multi = 'None';
function change_filtering_model_compound_multi(model) {
    genetic_model_compound_multi = model;
	dijit.byId("drop_type_model_families_compound_multi").set("label",  "Genetic Model ("+model+")");
    if (model == "None"){ dijit.byId("drop_type_model_families_compound_multi").set("iconClass",  "treeIcon32nb"); }
    else { dijit.byId("drop_type_model_families_compound_multi").set("iconClass",  "treeIcon32"); }
}

function click_annot(annot_name) {
	dijit.byId(annot_name + '_2').setAttribute('disabled', true);
	dijit.byId(annot_name + '_init').setAttribute('disabled', true);
	var span_name = annot_name + '_init';
	span_name = span_name.replace('filter', 'span');
	if (document.getElementById(annot_name).checked == true) {
		document.getElementById(span_name).setAttribute("style", "color:red;");
		dijit.byId(annot_name + '_init').set('checked', true);
		dijit.byId(annot_name + '_2').setAttribute('checked', true);
		dijit.byId(annot_name + '_2').setAttribute('disabled', true);
	}
	else {
		document.getElementById(span_name).setAttribute("style", "color:black;");
		dijit.byId(annot_name + '_init').setAttribute('checked', false);
		dijit.byId(annot_name + '_2').setAttribute('checked', false);
		dijit.byId(annot_name + '_2').setAttribute('disabled', false);
	}
}

var filtering_level_ind ='variation';

function change_filtering_level_ind(fv) {
    filtering_level_ind = fv;
    dijit.byId("select_individual_type_ind").set("label",  fv);
    document.getElementById("stat_filter_level").textContent = fv;
    dijit.byId("select_individual_type_ind").set("iconClass", fv+"Icon");  
    if (fv == 'variation' && filtering_level_fam == 'variation') {
        dijit.byId("filter_intergenic").setAttribute('disabled', false);
    }
    else if (fv == 'gene') {
        dijit.byId("filter_intergenic").setAttribute('disabled', true);
        dijit.byId('filter_intergenic').set('checked', false);
    }
};

var list_compound_multi_annot_1 = [];
var list_compound_multi_annot_2 = [];
function apply_compound_multi_annot() {
	list_compound_multi_annot_1 = [];
	list_compound_multi_annot_2 = [];
	var lAnnot = ['filter_intergenic', 'filter_intronic', 'filter_upstream_downstream', 'filter_pseudogene', 'filter_ncrna', 'filter_maturemirna', 'filter_utr', 'filter_splice_site', 'filter_essential_splicing', 'filter_nonsynonymous', 'filter_frameshift', 'filter_stop', 'filter_phase', 'filter_silent', 'filter_nonframeshift', 'filter_predicted_splice_site'];
    dojo.forEach(lAnnot, function(annot_name) {
    	var annot_short_name = annot_name.replace('filter_', '');
    	if (annot_short_name == 'splice_site')   { annot_short_name = 'splicing'; }
    	if (annot_short_name == 'nonsynonymous') { annot_short_name = 'coding'; }
    	if (annot_short_name == 'nonframeshift') { annot_short_name = 'non-frameshift'; }
    	
    	if (dijit.byId(annot_name + '_2').checked) {}
    	else { list_compound_multi_annot_2.push(annot_short_name); }
    });
}
 
var filtering_level_ind ='variation';

function change_filtering_level_ind(fv) {
    filtering_level_ind = fv;
    dijit.byId("select_individual_type_ind").set("label",  fv);
    document.getElementById("stat_filter_level").textContent = fv;
    dijit.byId("select_individual_type_ind").set("iconClass", fv+"Icon");  
    if (fv == 'variation' && filtering_level_fam == 'variation') {
        dijit.byId("filter_intergenic").setAttribute('disabled', false);
    }
    else if (fv == 'gene') {
        dijit.byId("filter_intergenic").setAttribute('disabled', true);
        dijit.byId('filter_intergenic').set('checked', false);
    }
};
 
var filtering_level_fam ='variation';

function change_filtering_level_fam(fv) {
    filtering_level_fam = fv;
    dijit.byId("select_individual_type_fam").set("label",  fv);
    document.getElementById("stat_filter_level").textContent = fv;
    dijit.byId("select_individual_type_fam").set("iconClass", fv+"Icon");
    //document.getElementById("pat_fam_icon").InnerHTML = "<img src='images/icons/tick.png' class='mark'>";
    if (fv == 'variation' && filtering_level_ind == 'variation') {
        dijit.byId("filter_intergenic").setAttribute('disabled', false);
    }
    else if (fv == 'gene') {
        dijit.byId("filter_intergenic").setAttribute('disabled', true);
        dijit.byId('filter_intergenic').set('checked', false);
    }
};
 
function checkMessageError() {
    if (error_vcf_md5 == 1) {
        alert ("ERROR: please contact bioinformatics platform !! ERROR with VCF MD5 check for "+projectName+" project !");
    }    
};

require([
    "dojo/_base/connect",
    "dojo/dom",
    "dojo/ready",
    "dijit/registry",
    "dojox/mobile/parser",
    "dojox/mobile",
    "dojox/mobile/compat"],
    function(connect, dom, ready, registry) {
        resizeMblSwitch = function (inputId, switchId, unit){
            var sw = document.getElementById(switchId);
            var ip = document.getElementById(inputId);
            sw.style.width = ip.value + unit;
            registry.byId(switchId).resize();
        };
        
        resizeMblSwitch_2 = function (catName, switchId){
            var len = catName.length + 30;
            var sw = document.getElementById(switchId);
            sw.style.width = len + 'px';
            registry.byId(switchId).resize();
        };
    }
);

var ho_regions_short = '25';
var ho_regions_medium = '50';
var ho_regions_large = '75';
var ho_regions_extra_large = '100';
var is_big_data;
var datastore_global;
var datastore_analyse;
var datastore_check;
var datastore_annot;
var url_resume = url_path + "json_output_nodb/details_project.pl";
            
function loadGlobalInfos() {
    var urlCgi = url_resume + "?project=" + projectName + "&type=global_infos";
    var store_infos = new dojo.data.ItemFileWriteStore({ url: urlCgi });
    loadAnalyseInfos();
    store_infos.fetch({
        onComplete: function(items){
            dojo.forEach(items, function(item) {
                var this_attr;
                var this_val;
                dojo.forEach(store_infos.getAttributes(item), function(attribute) {
                    var value = store_infos.getValues(item, attribute);
                    if (attribute == "key") { this_attr = value; }
                    if (attribute == "value") { this_val = value; }
                });
                if (this_attr == "NAME") { document.getElementById("info_name").textContent = this_val; }
                else if (this_attr == "DESCRIPTION") { document.getElementById("info_description").textContent = this_val; }
                else if (this_attr == "PROJECT_TYPE") { document.getElementById("info_project_type").textContent = this_val; }
            });
        },
        onError: function(items){
        	alert("ERROR: " + projectName + " doesn't exist or in error status.");
        }
    });
}

var build = 'REF';
var isSomatic = 1;
var isGenomeAnalyse;
var list_impact_high = [];
var list_impact_medium = [];
var list_impact_low = [];
function loadAnalyseInfos() {
    dijit.byId('checking').show();
    var default_filters;
    var urlCgi = url_resume + "?project=" + projectName + "&type=analyse";
    var store_infos = new dojo.data.ItemFileWriteStore({ url: urlCgi });
    store_infos.fetch({
        onComplete: function(items){
            dojo.forEach(items, function(item) {
                var this_attr;
                var this_val;
                dojo.forEach(store_infos.getAttributes(item), function(attribute) {
                    var value = store_infos.getValues(item, attribute);
                    if (attribute == "key") { this_attr = value; }
                    if (attribute == "value") { this_val = value; }
                });
                //alert('this_attr: '+this_attr+' - this_val: '+this_val);
                if (this_attr == "BUILD") {
                	build = this_val;
                	document.getElementById("info_build").textContent = build;
            	}
                else if (this_attr == "GENOME") {
                    document.getElementById("info_genome").textContent = this_val;
                    isGenomeAnalyse = this_val;
                    isSomatic = 0;
                }
                else if (this_attr == "EXOME") {
                    document.getElementById("info_exome").textContent = this_val;
                    isSomatic = 0;
                }
                else if (this_attr == "DIAGNOSTIC") {
                    document.getElementById("info_diag").textContent = this_val;
                    isSomatic = 0;
                }
                else if (this_attr == "CAPTURE") { document.getElementById("info_capture").textContent = this_val; }
                else if (this_attr == "CAPTURE_1") { document.getElementById("info_capture").textContent = this_val; }
                else if (this_attr == "CAPTURE_2") { document.getElementById("info_capture").textContent += ', '+this_val; }
                else if (this_attr == "CAPTURE_3") { document.getElementById("info_capture").textContent += ', '+this_val; }
                else if (this_attr == "CAPTURE_4") { document.getElementById("info_capture").textContent += ', '+this_val; }
                else if (this_attr == "CAPTURE_5") { document.getElementById("info_capture").textContent += ', '+this_val; }
                else if (this_attr == "CAPTURE_6") { document.getElementById("info_capture").textContent += ', '+this_val; }
                else if (this_attr == "CAPTURE_7") { document.getElementById("info_capture").textContent += ', '+this_val; }
                else if (this_attr == "CAPTURE_8") { document.getElementById("info_capture").textContent += ', '+this_val; }
                else if (this_attr == "CAPTURE_9") { document.getElementById("info_capture").textContent += ', '+this_val; }
                else if (this_attr == "CAPTURE_10") { document.getElementById("info_capture").textContent += ', '+this_val; }
                else if (this_attr == "ALIGNMENT") { document.getElementById("info_align").textContent = this_val; }
                else if (this_attr == "ALIGNMENT_1") { document.getElementById("info_align").textContent = this_val; }
                else if (this_attr == "ALIGNMENT_2") { document.getElementById("info_align").textContent += ', '+this_val; }
                else if (this_attr == "ALIGNMENT_3") { document.getElementById("info_align").textContent += ', '+this_val; }
                else if (this_attr == "ALIGNMENT_4") { document.getElementById("info_align").textContent += ', '+this_val; }
                else if (this_attr == "ALIGNMENT_5") { document.getElementById("info_align").textContent += ', '+this_val; }
                else if (this_attr == "ALIGNMENT_6") { document.getElementById("info_align").textContent += ', '+this_val; }
                else if (this_attr == "ALIGNMENT_7") { document.getElementById("info_align").textContent += ', '+this_val; }
                else if (this_attr == "ALIGNMENT_8") { document.getElementById("info_align").textContent += ', '+this_val; }
                else if (this_attr == "ALIGNMENT_9") { document.getElementById("info_align").textContent += ', '+this_val; }
                else if (this_attr == "ALIGNMENT_10") { document.getElementById("info_align").textContent += ', '+this_val; }
                else if (this_attr == "CALLING") { document.getElementById("info_calling").textContent = this_val; }
                else if (this_attr == "CALLING_1") { document.getElementById("info_calling").textContent = this_val; }
                else if (this_attr == "CALLING_2") { document.getElementById("info_calling").textContent += ', '+this_val; }
                else if (this_attr == "CALLING_3") { document.getElementById("info_calling").textContent += ', '+this_val; }
                else if (this_attr == "CALLING_4") { document.getElementById("info_calling").textContent += ', '+this_val; }
                else if (this_attr == "CALLING_5") { document.getElementById("info_calling").textContent += ', '+this_val; }
                else if (this_attr == "CALLING_6") { document.getElementById("info_calling").textContent += ', '+this_val; }
                else if (this_attr == "CALLING_7") { document.getElementById("info_calling").textContent += ', '+this_val; }
                else if (this_attr == "CALLING_8") { document.getElementById("info_calling").textContent += ', '+this_val; }
                else if (this_attr == "CALLING_9") { document.getElementById("info_calling").textContent += ', '+this_val; }
                else if (this_attr == "CALLING_10") { document.getElementById("info_calling").textContent += ', '+this_val; }
                else if (this_attr == "VERSION DBSNP") { document.getElementById("info_dbsnp").textContent = this_val; }
                else if (this_attr == "VERSION EVS") { document.getElementById("info_evs").textContent = this_val; }
                else if (this_attr == "VERSION 1000GENOMES") { document.getElementById("info_1k").textContent = this_val; }
                else if (this_attr == "VERSION EXAC") { document.getElementById("info_exac").textContent = this_val; }
                else if (this_attr == "VERSION COSMIC") { document.getElementById("info_cosmic").textContent = this_val; }
                else if (this_attr == "VERSION PREDICTION_MATRIX") { document.getElementById("info_matrix").textContent = this_val; }
                else if (this_attr == "CACHE DEJAVU") {
                    document.getElementById("info_dejavu").textContent = this_val;
                    document.getElementById("info_dejavu_2").textContent = this_val;
                }
                else if (this_attr == "CACHE STRICT_DENOVO") { document.getElementById("info_strict_denovo").textContent = this_val; }
                else if (this_attr == "CACHE") {  }
                else if (this_attr == "IS_BIG_DATA") {
                    is_big_data = this_val;
                    if (is_big_data == 1 || is_big_data == 2 || is_big_data == 3 || is_big_data == 4) {
                        document.getElementById("info_big_data").textContent = "YES";
                        document.getElementById("waiting_text").textContent = "Loading Data may take several minutes...";
                    }
                    else { document.getElementById("info_big_data").textContent = "NO"; }
                }
                else if (this_attr == "ho_regions_short") { ho_regions_short = this_val; }
                else if (this_attr == "ho_regions_medium") { ho_regions_medium = this_val; }
                else if (this_attr == "ho_regions_large") { ho_regions_large = this_val; }
                else if (this_attr == "ho_regions_extra_large") { ho_regions_extra_large = this_val; }
                else    { document.getElementById('help_'+this_attr).textContent = this_val; }
            });
//            if (is_big_data == 1)  {
//                //document.getElementById("div_classic_data").style.visibility = "hidden";
//                document.getElementById("div_msg_big_data").style.visibility = "visible";
//                setInterval('flashImage("div_msg_big_data")', 500);
//            }
//            else {
                //document.getElementById("div_classic_data").style.visibility = "visible";
//                document.getElementById("div_msg_big_data").style.visibility = "hidden";
//            }
            loadAnnotations();
            loadFirstLaunch();
        }
    });
}

function update_choice_filter() {
    choice_filter(dd_type,["filter_substitution","filter_deletion","filter_insertion","filter_cnv"],["Sub","Del","Ins","Cnv"],"Variants Type");
    choice_filter(dd_score,["filter_score2","filter_score1","filter_score0"],["High","Med","Low"],"Confidence");
    choice_filter(dd_db_public,["filter_clinical","filter_nofreq","filter_not_cosmic","filter_cosmic"],["Clinical","","Not_Cosmic","Cosmic"],"Options");
}

var use_db_freq_or_gnomad_ac = 'db_freq';
function update_slider_db_freq_or_gnomac_ac() {
    if (is_cache_updated == 'no') {
		document.getElementById("use_db_freq_gnomad_ac").style.display = "none";
    	document.getElementById('span_db_public_gnomad_ac').innerHTML = "<span>DB Public</span>";
		document.getElementById("td_slider_gnomad_ac").style.display = "none";
    	document.getElementById("td_slider_frequence").style.display = "block";
    	use_db_freq_or_gnomad_ac = 'db_freq';
    }
	else if (dijit.byId("use_db_freq_gnomad_ac").get("value") == "off") {
    	document.getElementById('span_db_public_gnomad_ac').innerHTML = "DB Public / <span style='color:red;'>gnomAD AC</span>";
		document.getElementById("td_slider_gnomad_ac").style.display = "block";
		document.getElementById("td_slider_frequence").style.display = "none";
		use_db_freq_or_gnomad_ac = 'gnomad_ac';
    }
    else {
    	document.getElementById('span_db_public_gnomad_ac').innerHTML = "<span style='color:red;'>DB Public</span> / gnomAD AC";
		document.getElementById("td_slider_gnomad_ac").style.display = "none";
    	document.getElementById("td_slider_frequence").style.display = "block";
    	use_db_freq_or_gnomad_ac = 'db_freq';
    }
}

var can_use_hgmd = 'no';
var is_cache_updated = 'no';
var lAnnotHitory = [];
var last_annot_available;
var last_annot_version_project;
var loadAnnotationVersionOptions_loaded = 1;

function loadAnnotationVersionOptions(annot_version) {
	if (String(loadAnnotationVersionOptions_loaded) == String(annot_version)) { return; }
	if (String(annot_version) == String(last_annot_available)) {
		document.getElementById("span_annot_version_option").innerHTML = annot_version;
		document.getElementById("span_tooltip_annot_version").textContent = "This is the LAST annotation version.";
	}
	else {
		document.getElementById("span_annot_version_option").innerHTML = annot_version + " <img src='../images/polyicons/error.png' alt='Warn' style='width:11px;height:11px;'>";
		document.getElementById("span_tooltip_annot_version").textContent = "The LAST annotation version available is " + last_annot_available;
	}
	loadAnnotationVersionOptions_loaded = annot_version;
	document.getElementById('startButton').click();
}

function loadAnnotations() {
    var urlCgi = url_resume + "?project=" + projectName + "&user=" + dojo.cookie("username") + "&type=annot_infos";
    var store_annot = new dojo.data.ItemFileWriteStore({ url: urlCgi });
    store_annot.fetch({
        onComplete: function(items){
            var annotation_version_details = {};
            dojo.forEach(items, function(item) {
                var this_id;
                var this_filter_name;
                var this_length;
                var this_ensembl;
                var this_synonym;
                var this_value;
                dojo.forEach(store_annot.getAttributes(item), function(attribute) {
                    var value = store_annot.getValues(item, attribute);
                    if (attribute == "id")          { this_id = value; }
                    if (attribute == "filter_name") { this_filter_name = value; }
                    if (attribute == "length")      { this_length = value; }
                    if (attribute == "ensembl")     { this_ensembl = value; }
                    if (attribute == "synonym")     { this_synonym = value; }
                    if (attribute == "value")       { this_value = value; }
                });
                if (this_id == 'can_use_hgmd') {
                	if (this_value == 'YES') {
                		can_use_hgmd = 'yes';
            		}
            	}
                else if (this_id == 'is_cache_updated') {
                	if (this_value == 'YES') {
                		is_cache_updated = 'yes';
            		}
            		else {
            			exclude_functions_for_old_project();
			    	}
            	}
            	else if (String(this_id).match(/annotation_version_/)) {
            		annotation_version_details[this_id] = String(this_value);
            	}
                else {
	                var widget_id = 'filter_' + this_id;
	                var widget_localisation = 'td_' + this_id;
	                if (this_id == 'intergenic') {
	                	document.getElementById("span_intergenic").textContent = ' '+this_synonym;
	                	document.getElementById("span_intergenic_2").textContent = ' '+this_synonym;
	                	document.getElementById("span_intergenic_init").textContent = ' '+this_synonym;
	            	}
	                if (this_id == 'intronic') {
	                	document.getElementById("span_intronic").textContent = ' '+this_synonym;
	                	document.getElementById("span_intronic_2").textContent = ' '+this_synonym;
	                	document.getElementById("span_intronic_init").textContent = ' '+this_synonym;
	                }
	                if (this_id == 'upstream_downstream') {
	                	document.getElementById("span_upstream_downstream").textContent = ' '+this_synonym;
	                	document.getElementById("span_upstream_downstream_2").textContent = ' '+this_synonym;
	                	document.getElementById("span_upstream_downstream_init").textContent = ' '+this_synonym;
	                }
	                if (this_id == 'pseudogene') {
	                	document.getElementById("span_pseudogene").textContent = ' '+this_synonym;
	                	document.getElementById("span_pseudogene_2").textContent = ' '+this_synonym;
	                	document.getElementById("span_pseudogene_init").textContent = ' '+this_synonym;
	                }
	                if (this_id == 'ncrna') {
	                	document.getElementById("span_ncrna").textContent = ' '+this_synonym;
	                	document.getElementById("span_ncrna_2").textContent = ' '+this_synonym;
	                	document.getElementById("span_ncrna_init").textContent = ' '+this_synonym;
	                }
	                if (this_id == 'maturemirna') {
	                	document.getElementById("span_maturemirna").textContent = ' '+this_synonym;
	                	document.getElementById("span_maturemirna_2").textContent = ' '+this_synonym;
	                	document.getElementById("span_maturemirna_init").textContent = ' '+this_synonym;
	                }
	                if (this_id == 'utr') {
	                	document.getElementById("span_utr").textContent = ' '+this_synonym;
	                	document.getElementById("span_utr_2").textContent = ' '+this_synonym;
	                	document.getElementById("span_utr_init").textContent = ' '+this_synonym;
	            	}
	                if (this_id == 'splice_site') {
	                	document.getElementById("span_splice_site").textContent = ' '+this_synonym;
	                	document.getElementById("span_splice_site_2").textContent = ' '+this_synonym;
	                	document.getElementById("span_splice_site_init").textContent = ' '+this_synonym;
	                }
	                if (this_id == 'frameshift') {
	                	document.getElementById("span_frameshift").textContent = ' '+this_synonym;
	                	document.getElementById("span_frameshift_2").textContent = ' '+this_synonym;
	                	document.getElementById("span_frameshift_init").textContent = ' '+this_synonym;
	                }
	                if (this_id == 'stop') {
	                	document.getElementById("span_stop").textContent = ' '+this_synonym;
	                	document.getElementById("span_stop_2").textContent = ' '+this_synonym;
	                	document.getElementById("span_stop_init").textContent = ' '+this_synonym;
	                }
	                if (this_id == 'phase') {
	                	document.getElementById("span_phase").textContent = ' '+this_synonym;
	                	document.getElementById("span_phase_2").textContent = ' '+this_synonym;
	                	document.getElementById("span_phase_init").textContent = ' '+this_synonym;
	                }
	                if (this_id == 'silent') {
	                	document.getElementById("span_silent").textContent = ' '+this_synonym;
	                	document.getElementById("span_silent_2").textContent = ' '+this_synonym;
	                	document.getElementById("span_silent_init").textContent = ' '+this_synonym;
	                }
	                if (this_id == 'essential_splicing') {
	                	document.getElementById("span_essential_splicing").textContent = ' '+this_synonym;
	                	document.getElementById("span_essential_splicing_2").textContent = ' '+this_synonym;
	                	document.getElementById("span_essential_splicing_init").textContent = ' '+this_synonym;
	                }
	                if (this_id == 'nonsynonymous') {
	                	document.getElementById("span_nonsynonymous").textContent = ' '+this_synonym;
	                	document.getElementById("span_nonsynonymous_2").textContent = ' '+this_synonym;
	                	document.getElementById("span_nonsynonymous_init").textContent = ' '+this_synonym;
	                }
	                if (this_id == 'nonframeshift') {
	                	document.getElementById("span_nonframeshift").textContent = ' '+this_synonym;
	                	document.getElementById("span_nonframeshift_2").textContent = ' '+this_synonym;
	                	document.getElementById("span_nonframeshift_init").textContent = ' '+this_synonym;
	                }
	                if (this_id == 'predicted_splice_site') {
	                	document.getElementById("span_predicted_splice_site").textContent = ' '+this_synonym;
	                	document.getElementById("span_predicted_splice_site_2").textContent = ' '+this_synonym;
	                	document.getElementById("span_predicted_splice_site_init").textContent = ' '+this_synonym;
	                }
	                //require( ["dojo/dom", "dojo/ready", "dojox/mobile/Switch"], function(dom, ready, Switch) {
	                //    ready(function() {
	                //        var sw = new Switch({id:widget_id, value:'off', leftLabel:this_ensembl, rightLabel:this_ensembl});
	                //        sw.placeAt(document.getElementById(widget_localisation));
	                //        sw.startup();
	                //    });
	                //});
	                //dojo.style(widget_id, "width", this_length);
	                //dijit.byId(widget_id).resize();
                }
            });
            dojo.forEach(items, function(item) {
                var this_id;
                var this_value;
                dojo.forEach(store_annot.getAttributes(item), function(attribute) {
                    var value = store_annot.getValues(item, attribute);
                    if (attribute == "id")          { this_id = value; }
                    if (attribute == "value")       { this_value = value; }
                });
            	if (this_id == 'annotation_version') {
            		document.getElementById("info_annotation_version").innerHTML = this_value;
            		var list = String(this_value).split(' ');
            		lAnnotHitory = String(list[0]).split(',');
					var menu = new dijit.Menu( { id: "menu_annot_versions" } );
                    for ( i = 0; i < lAnnotHitory.length; i++ ) {
						var onclick_method = "loadAnnotationVersionOptions('" + lAnnotHitory[i] + "')";
						var id_hash = 'annotation_version_details_' + String(lAnnotHitory[i]);
						var text = "<b><u><span style='color:red'>Version " + lAnnotHitory[i] + '</span></b></u>   <i>[' + annotation_version_details[id_hash] + ']</i>';
						menu.addChild(new dijit.MenuItem ( { label: text, onClick: onclick_method }));
        			}
					menu.placeAt("div_dropdownmenu_annotations");
					menu.startup();
            		last_annot_version_project = String(lAnnotHitory[lAnnotHitory.length -1]);
            		loadAnnotationVersionOptions_loaded = last_annot_version_project;
            		if (can_use_hgmd == 'no') {
						dijit.byId('b_dialog_hgmd_dejavu').set('disabled', true);
						document.getElementById('b_dialog_hgmd_dejavu').style.visibility = 'hidden';
            		}
            		if (parseInt(last_annot_version_project) < 31 && last_annot_version_project != "19.1") {
						//document.getElementById('b_polydiag_view').style.visibility = 'hidden';
            			//dijit.byId('b_polydiag_view').set('disabled', true);
            		}
            		if (list.length == 2) {
        				last_annot_available = list[1];
            			document.getElementById("info_annotation_version").innerHTML = String(list[0]) + "<span style='color:red'><b> -> new release " + last_annot_available + " available ! </b></span>";
            			document.getElementById("span_annot_version_option").innerHTML = last_annot_version_project + " <img src='../images/polyicons/error.png' alt='Warn' style='width:11px;height:11px;'>";
            			document.getElementById("span_tooltip_annot_version").textContent = "The LAST annotation version available is " + last_annot_available;
            		}
            		else {
        				last_annot_available = last_annot_version_project;
            			document.getElementById("info_annotation_version").innerHTML = String(list[0]);
            			document.getElementById("span_annot_version_option").innerHTML = last_annot_version_project;
            			document.getElementById("span_tooltip_annot_version").textContent = "This is the LAST annotation version.";
            		}
            	}
            });
            update_choice_filter();
        }
    });
}

function checkTextValue() {
    if (dijit.byId("filter_text").get("value") == "Search gene or onthology...") {
        dijit.byId("filter_text").set("value", "");
    }
    else if (dijit.byId("filter_text").get("value") == "") {
        dijit.byId("filter_text").set("value", "Search gene or onthology...");
    }
}

function get_slider_impact() {
	//if (document.getElementById("fam_compound_multi_filters").checked == true) { return; }
    var widget = dijit.byId("slider_impact");
    var filters;
    var list_all_buttons = ["filter_intergenic", "filter_intronic", "filter_upstream_downstream", "filter_pseudogene", "filter_ncrna", "filter_maturemirna", "filter_utr", "filter_splice_site", "filter_essential_splicing", "filter_nonsynonymous", "filter_frameshift", "filter_stop", "filter_phase", "filter_silent", "filter_nonframeshift", "filter_predicted_splice_site"];
    var list_all_span = ["span_intronic_init", "span_upstream_downstream_init", "span_pseudogene_init", "span_ncrna_init", "span_maturemirna_init", "span_utr_init", "span_splice_site_init", "span_essential_splicing_init", "span_nonsynonymous_init", "span_frameshift_init", "span_stop_init", "span_phase_init", "span_silent_init", "span_nonframeshift_init", "span_predicted_splice_site_init"];
    if (widget.get("value") == 4) {
        list_all_buttons.forEach(function(entry) {
            if (entry in hash_button_always_disabled) {}
            else { dijit.byId(entry).set('checked', true); }
    	});
        list_all_buttons.forEach(function(entry) {
            if (entry in hash_button_always_disabled) {}
            else { dijit.byId(entry + '_2').set('checked', true); }
        });
        list_all_buttons.forEach(function(entry) {
            if (entry in hash_button_always_disabled) {}
            else { dijit.byId(entry + '_2').set('disabled', true); }
        });
        list_all_buttons.forEach(function(entry) {
            if (entry in hash_button_always_disabled) {}
            else { dijit.byId(entry + '_init').set('checked', true); }
        });
        list_all_buttons.forEach(function(entry) {
            if (entry in hash_button_always_disabled) {}
            else {
	        	if (entry == 'filter_intergenic') {}
	        	else { dijit.byId(entry + '_init').set('disabled', true); }
        	}
    	});
        list_all_span.forEach(function(span_name) { document.getElementById(span_name).setAttribute("style", "color:red;"); });
    }
    else {
        //list_all_buttons.forEach(function(entry) { dijit.byId(entry).set("value", "off") });
        list_all_buttons.forEach(function(entry) { dijit.byId(entry).set('checked', false); });
        list_all_buttons.forEach(function(entry) { dijit.byId(entry + '_2').set('checked', false); });
        list_all_buttons.forEach(function(entry) { dijit.byId(entry + '_2').setAttribute('disabled', false); });
        list_all_buttons.forEach(function(entry) {
        	if (entry == 'filter_intergenic') {}
	        else {
	        	dijit.byId(entry + '_init').set('checked', false);
	        	dijit.byId(entry + '_init').setAttribute('disabled', true);
	        }
        });
        list_all_span.forEach(function(span_name) {document.getElementById(span_name).setAttribute("style", "color:black;"); });
        if (widget.get("value") == 1) { filters = document.getElementById('help_impact_high').textContent; }
        else if (widget.get("value") == 2) { filters = document.getElementById('help_impact_medium').textContent; }
        else if (widget.get("value") == 3) { filters = document.getElementById('help_impact_low').textContent; }
        var list = filters.split(', ');
        list.forEach(function(entry) {
            var buttonId = 'filter_' + entry;
            if (buttonId in hash_button_always_disabled) {}
            else {
	            var b = dijit.byId(buttonId);
	        	var b2 = dijit.byId(buttonId + '_2');
	            if (b != null) {
	            	b.set('checked', true);
		        	if (b2 != null) {
		            	b2.set('checked', true);
		            	b2.set('disabled', true);
		        	}
	            }
	        	var b3 = dijit.byId(buttonId + '_init');
	        	if (b3 != null) {
	            	b3.set('checked', true);
	            	b3.set('disabled', true);
		        	var span_name = 'span_' + entry + '_init';
					document.getElementById(span_name).setAttribute("style", "color:red;");
				}
			}
        });
    }
    update_choice_filter();
}

function viewGeneHgmdInfos(gene_name) {
    dijit.byId("popup_hgmd").show();
    dijit.byId("div_popup_hgmd").setHref(url_hgmd_view+"?polyquery_view=1&gene="+gene_name+"&project="+projectName);
}

function launch_compound_multi_annot() {
	dijit.byId('dialog_compound_multi_annot').hide();
	dialog_compound_multi_annot_shown = 1;
	document.getElementById('startButton').click();
}

function check_slider_freq_init() {
	var value_slider = dijit.byId("slider_frequence").get("value");
	dijit.byId("slider_frequence_init").set("value", parseInt(value_slider));
	dijit.byId("slider_frequence_2").set("value", parseInt(value_slider));
}

function check_slider_dejavu_init() {
	var value_slider = dijit.byId("slider_dejavu").get("value");
	dijit.byId("slider_dejavu_init").set("value", parseInt(value_slider));
	dijit.byId("slider_dejavu_2").set("value", parseInt(value_slider));
	if (parseInt(value_slider) < 100) { document.getElementById('nb_dejavu_init').innerHTML = parseInt(value_slider); }
	else { document.getElementById('nb_dejavu_init').innerHTML = parseInt(max_project); }
}

function check_slider_dejavu(second_slider) {
	var nb_dejavu;
	if (second_slider) { nb_dejavu = document.getElementById('nb_dejavu_2'); }
	else { nb_dejavu = document.getElementById('nb_dejavu'); }
		
	var widget;
	if (second_slider) { widget = document.getElementById('slider_dejavu_2'); }
	else { widget = document.getElementById('slider_dejavu'); }

	var text_dejavu;
	if (second_slider) { text_dejavu = document.getElementById('text_dejavu_2'); }
	else { text_dejavu = document.getElementById('text_dejavu'); }

    var value_slider = get_value_slider_dejavu(second_slider);
    
    if (second_slider) {
    	var first_value_slider = get_value_slider_dejavu();
    	if (value_slider < first_value_slider) {
    		value_slider = first_value_slider;
    		if (value_slider <= 100) { dijit.byId("slider_dejavu_2").set("value", parseInt(value_slider)); }
    		else { dijit.byId("slider_dejavu_2").set("value", 100); }
    	}
    }
    
    if (value_slider > max_project) {
        if (value_slider <= 100) {
            widget.set('value', max_project);
            nb_dejavu.innerHTML = '<font color="#28A24C">' + max_project + ' max</font>';
        }
        else { nb_dejavu.innerHTML = '<font color="#28A24C">' + max_project + '</font>'; }
    }
    text_dejavu.innerHTML = '<i><b>Others</b> Projects: </i>';
    if (value_slider == max_project) {
        if (value_slider < 100) { nb_dejavu.innerHTML = '<font color="#28A24C">' + max_project + ' max</font>'; }
        else {
            nb_dejavu.innerHTML = '<font color="#28A24C">' + max_project + '</font>';
        }
    }
    else if (value_slider == 0)  {
        text_dejavu.innerHTML = '<i><b><font color="#EA3434">In this Project ONLY !</font></i></b>';
        nb_dejavu.innerHTML = '';
    }
    else if (value_slider <= 10) { nb_dejavu.innerHTML = '<font color="#EA3434">' + value_slider + '</font>'; }
    else if (value_slider <= 30) { nb_dejavu.innerHTML = '<font color="#EAA134">' + value_slider + '</font>'; }
    else if (value_slider <= 50) { nb_dejavu.innerHTML = '<font color="#EACC34">' + value_slider + '</font>'; }
    else                         { nb_dejavu.innerHTML = '<font color="#28A24C">' + value_slider + '</font>'; }
    
    if (second_slider) {}
    else {
    	check_slider_dejavu('second_silder');
    }
}

function get_value_slider_dejavu(second_slider) {
	var widget;
	var nb_proj_span;
	if (second_slider) {
		widget = dijit.byId("slider_dejavu_2");
		nb_proj_span = document.getElementById('nb_projects_2');
	}
    else {
    	widget = dijit.byId("slider_dejavu");
		nb_proj_span = document.getElementById('nb_projects');
	}
    var value = widget.get("value");
    var new_value = value | 0;
    if (new_value == 100) { new_value = nb_proj_span.textContent; }
    return new_value;
}


function check_slider_regionho() {
	var widget = dijit.byId("slider_regionho");
	var value_slider = get_value_slider_regionho();
    if (value_slider == 0)  {
        document.getElementById("text_regionho").innerHTML = '<i><b><font color="#999">Not Used</font></i></b>';
        document.getElementById('nb_regionho').innerHTML = '';
    }
    else if (value_slider == ho_regions_short) { 
    	document.getElementById("text_regionho").innerHTML = '<i><b><font color="#000">Nb var : </font></i></b>';
    	document.getElementById('nb_regionho').innerHTML = '<font color="#28A24C">' + value_slider + '</font>'; 
   	}
    else if (value_slider == ho_regions_medium) { 
    	document.getElementById("text_regionho").innerHTML = '<i><b><font color="#000">Nb var : </font></i></b>';
    	document.getElementById('nb_regionho').innerHTML = '<font color="#EAA134">' + value_slider + '</font>'; 
   	}
    else if (value_slider >= ho_regions_large) { 
    	document.getElementById("text_regionho").innerHTML = '<i><b><font color="#000">Nb var : </font></i></b>';
    	document.getElementById('nb_regionho').innerHTML = '<font color="#EA3434">' + value_slider + '</font>'; 
   	}
}

function get_value_slider_regionho() {
    var widget = dijit.byId("slider_regionho");
    var value = widget.get("value");
    if (value == 5) { return 0; }
    if (value == 4) { return parseInt(ho_regions_short); }
    if (value == 3) { return parseInt(ho_regions_medium); }
    if (value == 2) { return parseInt(ho_regions_large); }
    if (value == 1) { return parseInt(ho_regions_extra_large); }
    return 0;
}

var type_ratio_allelic = 'min';
function change_type_ratio_allelic(value) {
	if (value == 'min') {
		document.getElementById('span_drop_type_ratio_allelic').innerHTML = '<b>MIN</b> Ratio';
		type_ratio_allelic = 'min';
	}
	else if (value == 'max') {
		document.getElementById('span_drop_type_ratio_allelic').innerHTML = '<b>MAX</b> Ratio';
		type_ratio_allelic = 'max';		
	}
}


var newStore_pat_init;
var isRunning = 0;
var listPatientsName = [];
var listFamiliesName = [];
var listGroupsName = [];
var list_chr_with_genes = [];
var listGenesName = {};
var listGenesNameChr = [];
var list_json_chr = [];
var list_json_genes = [];
var is_list_genes_full = 0;
var list_json_genes_by_chr = {};
var list_json_patients = [];
var list_json_groups = [];
var list_json_families = [];
var list_json_regions = [];
var list_json_diseases = [];
var list_json_regions_ho_rec = [];
var json_genes_done = 0;
var json_genes = 0;
var global_chr = 0;
var global_genes = 0;
var global_var = 0;
var global_uniq = 0;
var global_he = 0;
var global_ho = 0;
var h_stats_patients_name = {};
var h_stats_patients = {};
var h_stats_groups = {};
var h_stats_families_name = {};
var h_stats_families = {};
var progress_id = 0;
var nbRunning = 0;
var nbRunningCheck = 0;
var nbRunningCheck_OK = 0;
var nbLaunchedCheck = [];
var firstConstructTree = 1;
var tree;
var tree_done = 0;
var lChrXlsDone = 0;
var lChrXlsSubPart = [];
var xls_in_error = 0;
var args_pat_inattic_genes_filters;
var args_genes_inter;
var maxRunning;
var maxRunningCheck = 5;
var lObjFilters = [];

require(["dojo/promise/all", "dojo/Deferred", "dojo/dom", "dojo/on", "dojo/json", "dojo/domReady!"],
function(all, Deferred, dom, on, JSON) {
    on(dom.byId("startButtonAllGenes"), "click", function() {
        view_all_genes = 1;
        limit_genes_json = 99999999999999;
        document.getElementById("startButton").click();
    });
});

require(["dojo/promise/all", "dojo/Deferred", "dojo/dom", "dojo/on", "dojo/json", "dojo/domReady!"],
function(all, Deferred, dom, on, JSON) {
    on(dom.byId("startButton"), "click", function() {
    	if (dialog_compound_multi_annot_shown == 0 && filtering_mode == "fam" && (genetic_model == 'compound_multi' || genetic_model == 'recessif_compound_multi' || genetic_model == 'uniparental_recessif_compound_multi')) {
			check_slider_dejavu_init();
			check_slider_freq_init();
    		dijit.byId('dialog_compound_multi_annot').show();
    		return;
    	}
    	dialog_compound_multi_annot_shown = 0;
        progress_id = 0;
        args_pat_inattic_genes_filters = null;
        args_pat_inattic_genes_filters = check_pat_fam_to_intersect_from_genes_filters();
        args_genes_inter = null;
        args_genes_inter = get_list_genes_intersected();
        if (isIntersectGenes == 1 && args_pat_inattic_genes_filters == 'all') {
            alert('No common patient / family found after genes intersection...');
            return;
        }
        if (is_export_xls == 1) {
            lChrXlsDone = 0;
            lChrXlsSubPart = [];
            xls_in_error = 0;
            myProgressBarXls.set( { value: 0 } );
            dijit.byId('waiting_xls_progress').show();
        }
        else if (run_check_project == 0) {
            gridListGenes.layout.setColumnVisibility(1, false);
            gridPatient.layout.setColumnVisibility(0, false);
            gridFamilies.layout.setColumnVisibility(0, false);
            document.getElementById("waiting_progress_text").textContent = "Loading Data...";
            list_chr_with_genes = [];
            list_json_chr = [];
            list_json_genes = [];
            is_list_genes_full = 0;
            list_json_genes_by_chr = {};
            dojo.forEach([1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25], function(chr_id) {
                list_json_genes_by_chr[chr_id] = [];
            });
            list_json_patients = [];
            list_json_groups = [];
            list_json_families = [];
            list_json_regions = [];
            list_json_diseases = [];
            list_json_regions_ho_rec = [];
            listGenesName = {};
            list_chr_vector_hex = [];
            listGenesNameChr = [];
            json_genes = 0;
            json_genes_done = 0;
            global_chr = 0;
            global_genes = 0;
            global_var = 0;
            global_uniq = 0;
            global_he = 0;
            global_ho = 0;
            h_stats_patients = {};
            h_stats_families = {};
            h_stats_groups = {};
            gridChromosome.rowSelectCell.toggleAllSelection(false);
            gridChr_allSelected = 0;
    
            // list_json_chr = [];
            // list_json_genes = [];
            // json_genes = 0;
            // progress_id = 0;
            var data_tmp = { items: [] };
            var newStore = new dojo.data.ItemFileReadStore({ data: data_tmp });
            store_region = new dojo.data.ItemFileWriteStore({ data: data_tmp });
            gridChromosome.setStore(newStore);
            gridPatient.setStore(newStore);
            gridGroups.setStore(newStore);
            gridListGenes.setStore(newStore);
            gridFamilies.setStore(newStore);
            gridRegion.setStore(store_region);
            document.getElementById("stat_chr").textContent  = 0;
            document.getElementById("stat_gene").textContent = 0;
            document.getElementById("stat_var").textContent  = 0;
            document.getElementById("stat_dif").textContent  = 0;
            //document.getElementById("stat_he").textContent   = 0;
            //document.getElementById("stat_ho").textContent   = 0;
            global_chr = 0;
            global_genes = 0;
            global_var = 0;
            global_uniq = 0;
            global_he = 0;
            global_ho = 0;
            myProgressBar.set( { value: 0 } );
            dijit.byId('waiting_progress').show();
        }
        if (is_big_data == 1) {
            if (document.getElementById('filter_intergenic').checked == false) {
                is_big_data = 3;
            }
        }
        if (is_big_data == 3) {
            if (document.getElementById('filter_intergenic').checked == true) {
                is_big_data = 1;
            }
        }
        if (is_export_xls == 1) { maxRunning = 1; }
        else if (is_big_data == 4) { maxRunning = 3; }
        else { maxRunning = 5; }
        var hasConfidenceFilter;
        if (is_export_xls == 1) {
            all({
                xls: checkAndSubmit( '1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,X,Y,MT' ),
            }).then(function(results) {} );
        }
        else if (run_check_project == 1) {
            all({
                chr1:  checkAndSubmit( '1' ),
                chr2:  checkAndSubmit( '2' ),
                chr3:  checkAndSubmit( '3' ),
                chr4:  checkAndSubmit( '4' ),
                chr5:  checkAndSubmit( '5' ),
                chr6:  checkAndSubmit( '6' ),
                chr7:  checkAndSubmit( '7' ),
                chr8:  checkAndSubmit( '8' ),
                chr9:  checkAndSubmit( '9' ),
                chr10: checkAndSubmit( '10' ),
                chr11: checkAndSubmit( '11' ),
                chr12: checkAndSubmit( '12' ),
                chr13: checkAndSubmit( '13' ),
                chr14: checkAndSubmit( '14' ),
                chr15: checkAndSubmit( '15' ),
                chr16: checkAndSubmit( '16' ),
                chr17: checkAndSubmit( '17' ),
                chr18: checkAndSubmit( '18' ),
                chr19: checkAndSubmit( '19' ),
                chr20: checkAndSubmit( '20' ),
                chr21: checkAndSubmit( '21' ),
                chr22: checkAndSubmit( '22' ),
                chrX:  checkAndSubmit( 'X' ),
                chrY:  checkAndSubmit( 'Y' ),
                chrMT: checkAndSubmit( 'MT' ),
            }).then(function(results) {} );
        }
        // CAS GENOME avec intergenic ou MAJ du project
        else if (is_big_data == 1) {
            all({
                tree:  checkAndSubmit( 'tree' ),
                chr1:  checkAndSubmit( '1' ),
                chr2:  checkAndSubmit( '2' ),
                chr3:  checkAndSubmit( '3' ),
                chr4:  checkAndSubmit( '4' ),
                chr5:  checkAndSubmit( '5' ),
                chr6:  checkAndSubmit( '6' ),
                chr7:  checkAndSubmit( '7' ),
                chr8:  checkAndSubmit( '8' ),
                chr9:  checkAndSubmit( '9' ),
                chr10: checkAndSubmit( '10' ),
                chr11: checkAndSubmit( '11' ),
                chr12: checkAndSubmit( '12' ),
                chr13: checkAndSubmit( '13' ),
                chr14: checkAndSubmit( '14' ),
                chr15: checkAndSubmit( '15' ),
                chr16: checkAndSubmit( '16' ),
                chr17: checkAndSubmit( '17' ),
                chr18: checkAndSubmit( '18' ),
                chr19: checkAndSubmit( '19' ),
                chr20: checkAndSubmit( '20' ),
                chr21: checkAndSubmit( '21' ),
                chr22: checkAndSubmit( '22' ),
                chrX:  checkAndSubmit( 'X' ),
                chrY:  checkAndSubmit( 'Y' ),
                chrMT: checkAndSubmit( 'MT' ),
            }).then(function(results) {} );
        }
        // CAS EXOME beaucoup de patients
        else if (is_big_data == 2) {
            all({
                tree:     checkAndSubmit( 'tree' ),
                chr1:  checkAndSubmit( '1' ),
                chrMT: checkAndSubmit( 'MT' ),
                chr2:  checkAndSubmit( '2' ),
                chrY:  checkAndSubmit( 'Y' ),
                chr3:  checkAndSubmit( '3' ),
                chrX:  checkAndSubmit( 'X' ),
                chr4:  checkAndSubmit( '4' ),
                chr22: checkAndSubmit( '22' ),
                chr5:  checkAndSubmit( '5' ),
                chr21: checkAndSubmit( '21' ),
                chr6:  checkAndSubmit( '6' ),
                chr20: checkAndSubmit( '20' ),
                chr7:  checkAndSubmit( '7' ),
                chr19: checkAndSubmit( '19' ),
                chr8:  checkAndSubmit( '8' ),
                chr18: checkAndSubmit( '18' ),
                chr9:  checkAndSubmit( '9' ),
                chr17: checkAndSubmit( '17' ),
                chr10: checkAndSubmit( '10' ),
                chr16: checkAndSubmit( '16' ),
                chr11: checkAndSubmit( '11' ),
                chr15: checkAndSubmit( '15' ),
                chr12: checkAndSubmit( '12' ),
                chr14: checkAndSubmit( '14' ),
                chr13: checkAndSubmit( '13' ),
            }).then(function(results) {} );
        }
        // CAS GENOME sans intergenic
        else if (is_big_data == 3) {
        	if (get_value_slider_regionho() > 1) {
	            all({
	                tree:  checkAndSubmit( 'tree' ),
	                chr1:  checkAndSubmit( '1' ),
	                chrMT: checkAndSubmit( 'MT' ),
	                chr2:  checkAndSubmit( '2' ),
	                chrY:  checkAndSubmit( 'Y' ),
	                chr3:  checkAndSubmit( '3' ),
	                chrX:  checkAndSubmit( 'X' ),
	                chr4:  checkAndSubmit( '4' ),
	                chr22: checkAndSubmit( '22' ),
	                chr5:  checkAndSubmit( '5' ),
	                chr21: checkAndSubmit( '21' ),
	                chr6:  checkAndSubmit( '6' ),
	                chr20: checkAndSubmit( '20' ),
	                chr7:  checkAndSubmit( '7' ),
	                chr19: checkAndSubmit( '19' ),
	                chr8:  checkAndSubmit( '8' ),
	                chr18: checkAndSubmit( '18' ),
	                chr9:  checkAndSubmit( '9' ),
	                chr17: checkAndSubmit( '17' ),
	                chr10: checkAndSubmit( '10' ),
	                chr16: checkAndSubmit( '16' ),
	                chr11: checkAndSubmit( '11' ),
	                chr15: checkAndSubmit( '15' ),
	                chr12: checkAndSubmit( '12' ),
	                chr14: checkAndSubmit( '14' ),
	                chr13: checkAndSubmit( '13' ),
	            }).then(function(results) {} );
        	}
        	else {
	            all({
	                tree:  checkAndSubmit( 'tree' ),
	                chr1:  checkAndSubmit( '1' ),
	                chrMT: checkAndSubmit( 'MT' ),
	                chr2:  checkAndSubmit( '2' ),
	                chrY:  checkAndSubmit( 'Y' ),
	                chr3:  checkAndSubmit( '3' ),
	                chrX:  checkAndSubmit( 'X' ),
	                chr4:  checkAndSubmit( '4' ),
	                chr22: checkAndSubmit( '22' ),
	                chr5:  checkAndSubmit( '5' ),
	                chr21: checkAndSubmit( '21' ),
	                chr6:  checkAndSubmit( '6' ),
	                chr20: checkAndSubmit( '20' ),
	                chr7:  checkAndSubmit( '7' ),
	                chr19: checkAndSubmit( '19' ),
	                chr8:  checkAndSubmit( '8' ),
	                chr18: checkAndSubmit( '18' ),
	                chr9:  checkAndSubmit( '9' ),
	                chr17: checkAndSubmit( '17' ),
	                chr10: checkAndSubmit( '10' ),
	                chr16: checkAndSubmit( '16' ),
	                chr11: checkAndSubmit( '11' ),
	                chr15: checkAndSubmit( '15' ),
	                chr12: checkAndSubmit( '12' ),
	                chr14: checkAndSubmit( '14' ),
	                chr13: checkAndSubmit( '13' ),
	            }).then(function(results) {} );
            }
        }
        else {
            all({
                tree:     checkAndSubmit( 'tree' ),
                chrMT: checkAndSubmit( 'MT' ),
                chr2:  checkAndSubmit( '2' ),
                chrY:  checkAndSubmit( 'Y' ),
                chr3:  checkAndSubmit( '3' ),
                chrX:  checkAndSubmit( 'X' ),
                chr4:  checkAndSubmit( '4' ),
                chr22: checkAndSubmit( '22' ),
                chr5:  checkAndSubmit( '5' ),
                chr21: checkAndSubmit( '21' ),
                chr6:  checkAndSubmit( '6' ),
                chr20: checkAndSubmit( '20' ),
                chr7:  checkAndSubmit( '7' ),
                chr19: checkAndSubmit( '19' ),
                chr8:  checkAndSubmit( '8' ),
                chr18: checkAndSubmit( '18' ),
                chr9:  checkAndSubmit( '9' ),
                chr1:  checkAndSubmit( '1' ),
                chr17: checkAndSubmit( '17' ),
                chr10: checkAndSubmit( '10' ),
                chr16: checkAndSubmit( '16' ),
                chr11: checkAndSubmit( '11' ),
                chr15: checkAndSubmit( '15' ),
                chr12: checkAndSubmit( '12' ),
                chr14: checkAndSubmit( '14' ),
                chr13: checkAndSubmit( '13' ),
            }).then(function(results) {} );
        }
    });
    
    function construct_tree() {
        if (!tree) {
            nbRunning++;
            require([
                "dojo/ready",
                "dojo/data/ItemFileWriteStore",
                "cbtree/Tree",                    // Checkbox tree
                "cbtree/models/ForestStoreModel"  // ForestStoreModel
            ], function( ready, ItemFileWriteStore, Tree, ForestStoreModel) {
                var url_bundles = url_cache_gene_vector + "?get_bundles=1&project=" + projectName;
                ready( function() {
                    var store_bundles = new ItemFileWriteStore( { url: url_bundles });
                    var model_bundles = new ForestStoreModel( {   store: store_bundles,
                                                                  query: {type: "capture"},
                                                                  rootLabel: "Captures",
                                                                  labelType: "html",
                                                                  //checkedAll: false,
                                                              });
                    tree = new Tree( { model: model_bundles, id: "bundleTree", openOnClick:true, showRoot:false }, "div_tree_captures" );
                    //tree.on( "open", updateOpenGenes_bundles);
                    tree.startup();
                    tree_done = 1;
                    nbRunning--;
                });
            });
        }
    }
    
    function unCheckedAfterConstruct() {
        var root1 = tree.getChildren();
        for (var d in tree.model.root.children) {
            var ds = tree.model.root.children[d];
            for (var b in ds.children){
                var bs = ds.children[b];
                tree.model.setChecked(bs, false);
                //for (var l in bs.children) {
                //    var leaf = bs.children[l];
                //    tree.model.setChecked(leaf,false);
                //}
            }
        }
    }
    
    function updateFoundGeneInGrid() {
        if (lOnlyThesesGenes.length > 0) {
            dijit.byId("gridGenesUser").store.fetch( {
                onComplete: function(items, request) {
                    var lJson = [];
                    var max = items.length;
                    var n = 0;
                    while (n < max) {
                        var name = dijit.byId("gridGenesUser").store.getValue(items[n], 'name');
                        if (listGenesName[name] == 'NEVER') {
                            var json = {
                                "name":  name,
                                "found": 'NEVER',
                            };
                            lJson.push(json);
                        }
                        else if (listGenesName[name]) {
                            var json = {
                                "name":  name,
                                "found": 'yes',
                            };
                            lJson.push(json);
                        }
                        else {
                            var json = {
                                "name":  name,
                                "found": '',
                            };
                            lJson.push(json);
                        }
                        n++;
                    }
                    var data_tmp = { "items": lJson };
                    var newStore_list_genes = new dojo.data.ItemFileReadStore({ data: data_tmp });
                    dijit.byId("gridGenesUser").setStore( newStore_list_genes );
                    dijit.byId("gridGenesUser").setSortIndex(2, true);
                }
            });
        }
    }
    
    function updateGenes_captures() {
        var root1 = tree.getChildren();
        for (var d in tree.model.root.children) {
            var ds = tree.model.root.children[d];
            var lTmp_c = String(ds.name).split(' ');
            var name_c = lTmp_c[0];
            var lDone = [];
            var nb_c_ok = 0;
            var nb_c = 0;
            for (var b in ds.children){
                var bs = ds.children[b];
                for (var l in bs.children) {
                    var leaf = bs.children[l];
                    var lTmp_l = String(leaf.name).split(' ');
                    var name = lTmp_l[2];
                    if (listGenesName[name]) {
                        if (!lDone[name]) {
                            lDone[name] = 1;
                            nb_c_ok++;
                            nb_c++;
                        }
                    }
                    if (!lDone[name]) {
                        lDone[name] = 1;
                        nb_c++;
                    }
                }
            }
            var color = 'green';
            if (nb_c_ok == 0) {
                color = 'red';
            }
            //document.getElementById('span_capture_'+name_c).innerHTML = " <font color='" + color + "'>[" + nb_c_ok + "/" + nb_c + " genes]</font>";
        }
        setTimeout(function () {
            unCheckedAfterConstruct();
        }, 5000);
    }
    
    function updateOpenGenes_bundles(item, nodeWidget, event ) {
        if (item.type == 'capture') {
            for (var b in item.children) {
                var bs = item.children[b];
                var lTmp_b = String(bs.name).split(' ');
                var name_b = lTmp_b[0];
                if (document.getElementById('span_bundle_'+name_b)){
                   document.getElementById('span_bundle_'+name_b).innerHTML = " <font color='green'>[" + bs.children.length + " genes]</font>";
                }
            }
        }
    }
    
    function checkAndSubmit(id) {
        if (id == 'tree') {
            if (!tree) { construct_tree(); }
        }
        else {
            if (nbRunning >= maxRunning) {
                setTimeout(function(){ checkAndSubmit(id); }, 500);
            }
            else {
                if (is_export_xls == 1) {
                    if (xls_in_error == 0) { launch_chr_xls(id); }
                }
                else {
			        var lChrLaunched = id.split(',');
			        progress_id += lChrLaunched.length;
                	myProgressBar.set( { value: progress_id } );
                	launch_chr(id);
                }
            }
        }
    }
    
    function checkAndSubmitCheck(id) {
        var globalRunnnig = nbRunning + nbRunningCheck;
        if (globalRunnnig >= maxRunningCheck) {
            setTimeout(function(){ checkAndSubmitCheck(id); }, 500);
        }
        else { launch_check_chr(id); }
    }
    
    function onlyUnique(value, index, self) { 
        return self.indexOf(value) === index;
    }
    
    function checkTreeDone() {
        if (tree_done == 1) { return 1; }
        else {
            setTimeout(function(){ checkTreeDone(id); }, 500);
        }
    }
    
    function launch_end_chr_xls(sessionId) {
        var filter_args = construct_url_filter_data();
        var hurl2 = gene_url + filter_args + '&xls_load_session=' + sessionId;
        if (is_export_xls_var == 1)   { hurl2 += "&xls_by_variants=1"; }
        if (is_export_xls_genes == 1) { hurl2 += "&xls_by_genes=1"; }
        hurl2 += "&user_name="+dojo.cookie("username");
        isRunning = 0;
        document.getElementById("img_run_1").src="../images/polyicons/run_2.png";
        document.getElementById("img_run_2").src="../images/polyicons/run_2.png";
        document.getElementById("span_run_msg").innerHTML = "<b>&nbsp;&nbsp;RUN&nbsp;</b>";
        document.getElementById("span_run_msg_all_genes").innerHTML = "<b>&nbsp;&nbsp;LIST ALL Genes&nbsp;</b>";
        document.getElementById("startButton").disabled = false;
        document.getElementById("startButtonAllGenes").disabled = false;
        document.getElementById("b_view_all_genes").disabled = false;
        dijit.byId("b_export_xls_genes").set("disabled", false);
        dijit.byId("b_export_xls_var").set("disabled", false);
        // if ((global_uniq <= 250) && (global_genes == list_json_genes.length)) {
            // document.getElementById("b_viewAllVar").disabled = false;
        // }
        if (export_vcf_available == 1) { dijit.byId("b_export_xls_vcf").set("disabled", false); }
        is_export_xls = 0;
        console.log(hurl2);
        downloadFile(hurl2);
	    myProgressBarXls.set( { value: 125 } );
    }
    
    function launch_chr_xls(chr_id) {
        document.getElementById("waiting_xls_progress_text").innerHTML = "<b>Checking each chromosome</b> <i>(can take a long time...)</i>";
	    myProgressBarXls.set( { value: 0 } );
        var hurl = get_args_vector(chr_id);
        hurl += "&filter_chromosome=" +chr_id;
        hurl += "&view_all_genes=1";
        if (is_export_xls_var == 1)   { hurl += "&xls_by_variants=1"; }
        if (is_export_xls_genes == 1) { hurl += "&xls_by_genes=1"; }
        hurl += "&xls_save_session=1";
        if (lOnlyThesesGenes.length > 0) {
            hurl += "&only_genes='"+lOnlyThesesGenes.join(",")+"'";
        }
        hurl += "&user_name="+dojo.cookie("username");
        if (force_annotation_version != 'not') {
        	hurl += "&annot_version="+force_annotation_version;
        }
        isRunning = 1;
        document.getElementById("startButton").disabled = true;
        document.getElementById("startButtonAllGenes").disabled = true;
        document.getElementById("wait1").src="../images/polyicons/wait18trans.gif";
        document.getElementById("img_run_1").src="../images/polyicons/wait18trans.gif";
        document.getElementById("img_run_2").src="../images/polyicons/wait18trans.gif";
        document.getElementById("span_run_msg").innerHTML = "<b>&nbsp;&nbsp;Export XLS...&nbsp;</b>";
        document.getElementById("span_run_msg_all_genes").innerHTML = "<b>&nbsp;&nbsp;Export XLS...&nbsp;</b>";
        document.getElementById("b_view_all_genes").disabled = true;
        // document.getElementById("b_viewAllVar").disabled = true;
        dijit.byId("b_export_xls_genes").set("disabled", true);
        dijit.byId("b_export_xls_var").set("disabled", true);
        dijit.byId("b_export_xls_vcf").set("disabled", true);
        var nb_evt = 0;
        
        $.getJSON( hurl, function( data ) {
	    	$.each( data, function( key, val ) {
	    		if (key == "progress") {  }
	    		if (key == 'session_id') {
	                var sessionId = val;
	                myProgressBarXls.set( { value: 75 } );
	                launch_end_chr_xls(sessionId);
	    		}
			});
	    });
    }
    
    function launch_check_chr(chr_id) {
        var nb_chr = chr_id;
        if (chr_id == 'X') { nb_chr = 23; }
        if (chr_id == 'Y') { nb_chr = 24; }
        if (chr_id == 'MT') { nb_chr = 25; }
        if (nbLaunchedCheck[nb_chr] == 1) { return; }
        nbRunningCheck++;
        nbLaunchedCheck[nb_chr] = 1;
        var span_status_name = "status_check_" + chr_id;
        var wait_check_tmp   = "wait_check_chr" + chr_id;
        document.getElementById(span_status_name).innerHTML = "<img id=\"" + wait_check_tmp + "\" src=\"../images/polyicons/wait18trans.gif\" align=\"absmiddle\">";
        var hurl = url_path + 'cache_nodb/scripts/cgi_check_project.pl?project=' + projectName + '&chr=' + chr_id;
        if (run_check_project_quick == 0) {
            hurl += '&no_verbose=1&complete_check=1';
        }
        var xhrArgs = {
            url: hurl,
            timeout:0,
            handleAs: "json",
            load: function(data) {
                var store_tmp = new dojo.data.ItemFileWriteStore({data:  {
                    identifier: 'status',
                    label: 'status',
                    items: data.items
                }});
                store_tmp.fetch({
                    onItem: function (item, result) {
                        var status = store_tmp.getValue(item, 'status');
                        if (status != "<font color='green'><b>Check OK !</b></font>") {
                            dijit.byId('resume_check').show();
                            document.getElementById("span_run_msg").innerHTML = "<b>&nbsp;&nbsp;Error...&nbsp;</b>";
                            document.getElementById("startButton").disabled = true;
                            document.getElementById("stat_check").innerHTML = 'ERROR';
                            document.getElementById("tooltip_span_stat_check").innerHTML = "ERROR CHECK PROJECT !!!";
                        }
                        else {
                            nbRunningCheck_OK++;
                            if (document.getElementById("stat_check").innerHTML == 'ERROR') {}
                            if (nbRunningCheck_OK == '25') { document.getElementById("stat_check").innerHTML = "<img src='/icons/Polyicons/12-em-check.png'>"; }
                            document.getElementById("tooltip_span_stat_check").innerHTML = "Checking ALL chromosomes. Finished: " + nbRunningCheck_OK + "/25 chromosomes.";
                        }
                        document.getElementById(span_status_name).innerHTML = status;
                        nbRunningCheck--;
                    }
                });
                return deferred.promise;
            },
            onComplete: function (item, result) {
                deferred.resolve(chr_id + "_OK");
            },
            error: function(error) {
                document.getElementById(span_status_name).innerHTML = "<font color='red'><b>CGI script in error !</b></font>";
                console.log(hurl);
            }
        };
        var deferred = dojo.xhrGet(xhrArgs);
    }
    
    function wait(ms){
       var start = new Date().getTime();
       var end = start;
       while(end < start + ms) {
         end = new Date().getTime();
      }
    }
    
    var mem_isIntersectGenes;
    
    function launch_chr(chr_id) {
        var h_regions_id = {};
        nbRunning++;
        var cgi_args;        
        if (use_args) {
            use_args = use_args.replace(/;/g, '&');
            cgi_args = '&' + use_args;
        }
        else { cgi_args = construct_url_filter_data(chr_id); }
        if (lOnlyThesesGenes.length > 0) {
            cgi_args += "&only_genes="+lOnlyThesesGenes.join(",");
        }
        if (args_pat_inattic_genes_filters) {
            if (args_pat_inattic_genes_filters == 'all') {}
            else {
                cgi_args += "&filter_attic_genes="+args_pat_inattic_genes_filters;
                cgi_args += "&only_genes="+args_genes_inter+"&filter_genes_intersect="+args_genes_inter;
                isIntersectGenes = 1;
                mem_isIntersectGenes = 1;
            }
        }
        if (is_list_genes_full == 1) { cgi_args += "&not_construct_genes=1"; }
        var g = genetic_model;
        change_filtering_type(filtering_mode);
        change_filtering_model(g, 1);
        url_launch_no_chr = cache_all_url + cgi_args;
        old_hurl = cache_all_url + cgi_args;
        cgi_args += "&filter_chromosome=" +chr_id;
        var lChrLaunched = chr_id.split(',');
        var hurl = cache_all_url + cgi_args;
        hurl += "&user_name="+dojo.cookie("username");
        
        if (String(loadAnnotationVersionOptions_loaded) == String(last_annot_version_project)) {}
        else { hurl += "&annot_version="+loadAnnotationVersionOptions_loaded; }
        
		isRunning = 1;
        document.getElementById("startButton").disabled = true;
        document.getElementById("startButtonAllGenes").disabled = true;
        document.getElementById("img_run_1").src="../images/polyicons/wait18trans.gif";
        document.getElementById("img_run_2").src="../images/polyicons/wait18trans.gif";
        document.getElementById("span_run_msg").innerHTML = "<b>&nbsp;&nbsp;Running...&nbsp;</b>";
        document.getElementById("span_run_msg_all_genes").innerHTML = "<b>&nbsp;&nbsp;Running...&nbsp;</b>";
        document.getElementById("b_view_all_genes").disabled = true;
        // document.getElementById("b_viewAllVar").disabled = true;
        dijit.byId("b_export_xls_genes").set("disabled", true);
        dijit.byId("b_export_xls_var").set("disabled", true);
        dijit.byId("b_export_xls_vcf").set("disabled", true);
        dijit.byId("b_show_hgmd_dejavu_patient").set("disabled", true);
        var xhrArgs = {
            url: hurl,
            timeout:0,
            handleAs: "json",
            load: function(data) {
                nbRunning--;
        		progress_id += lChrLaunched.length;
                myProgressBar.set( { value: progress_id } );
                var empty_chr = 0;
                var lChrIds = chr_id.split(',');
                dojo.forEach(lChrIds, function(this_id) {
                    var span_status_name = "status_check_" + this_id;
                    //if (document.getElementById(span_status_name).innerHTML == 'Not Tested') {
                        //checkAndSubmitCheck(this_id);
                    //}
                });
                var store_genes_tmp = new dojo.data.ItemFileWriteStore({data:  {
                    identifier: 'id',
                    label: 'id',
                    items: data.items.genes
                }});
                store_genes_tmp.fetch({
                    onItem: function (item, result) {
                        //if (json_genes_done < limit_genes_json || chr_id == '1') {
                            var chr_id = store_genes_tmp.getValue(item, 'chromosome');
                            if (chr_id == 'X')  { chr_id = '23'; }
                            if (chr_id == 'Y')  { chr_id = '24'; }
                            if (chr_id == 'MT') { chr_id = '25'; }
                            list_json_genes_by_chr[chr_id].push(item);
                            list_chr_with_genes.push(chr_id);
                            json_genes_done++;
                        //}
                        //else {
                            //is_list_genes_full = 1;
                            //maxRunning = 6;
                        //}
                    }
                });
                list_chr_with_genes.filter( onlyUnique );
                var store_patients_tmp = new dojo.data.ItemFileWriteStore({data:  {
                    identifier: 'id',
                    label: 'id',
                    items: data.items.patients
                }});
                listPatientsName = [];
                store_patients_tmp.fetch({
                    onItem: function (item, result) {
                        var name  = store_patients_tmp.getValue(item, 'name');
                        listPatientsName.push(name);
                        var sub   = store_patients_tmp.getValue(item, 'substitutions');
                        var del   = store_patients_tmp.getValue(item, 'deletions');
                        var ins   = store_patients_tmp.getValue(item, 'insertions');
                        var cnv   = store_patients_tmp.getValue(item, 'cnvs');
                        var include = store_patients_tmp.getValue(item,"include");
                        var filter_heho = store_patients_tmp.getValue(item,"filter_heho");
                        if (!patients_status[name]) { patients_status[name] = new Array(); } 
                        patients_status[name]["include"] = include;
                        patients_status[name]["filter_heho"] = filter_heho;
                        global_var += sub + del + ins + cnv;
                        if (name + '_sub' in h_stats_patients) { h_stats_patients[name + '_sub'] += sub; }
                        else { h_stats_patients[name + '_sub'] = sub; }
                        if (name + '_del' in h_stats_patients) { h_stats_patients[name + '_del'] += del; }
                        else { h_stats_patients[name + '_del'] = del; }
                        if (name + '_ins' in h_stats_patients) { h_stats_patients[name + '_ins'] += ins; }
                        else { h_stats_patients[name + '_ins'] = ins; }
                        if (name + '_cnv' in h_stats_patients) { h_stats_patients[name + '_cnv'] += cnv; }
                        else { h_stats_patients[name + '_cnv'] = cnv; }
                        if (name + '_var' in h_stats_patients) { h_stats_patients[name + '_var'] += store_patients_tmp.getValue(item, 'variations'); }
                        else { h_stats_patients[name + '_var'] = store_patients_tmp.getValue(item, 'variations'); }
                        if (name + '_composite' in h_stats_patients) { h_stats_patients[name + '_composite'] += store_patients_tmp.getValue(item, 'composite'); }
                        else { h_stats_patients[name + '_composite'] = store_patients_tmp.getValue(item, 'composite'); }
                        if (name + '_he' in h_stats_patients) { h_stats_patients[name + '_he'] += store_patients_tmp.getValue(item, 'heterozygote'); }
                        else { h_stats_patients[name + '_he'] = store_patients_tmp.getValue(item, 'heterozygote'); }
                        if (name + '_ho' in h_stats_patients) { h_stats_patients[name + '_ho'] += store_patients_tmp.getValue(item, 'homozygote'); }
                        else { h_stats_patients[name + '_ho'] = store_patients_tmp.getValue(item, 'homozygote'); }
                        if (name + '_genes' in h_stats_patients) { h_stats_patients[name + '_genes'] += store_patients_tmp.getValue(item, 'genes'); }
                        else { h_stats_patients[name + '_genes'] = store_patients_tmp.getValue(item, 'genes'); }
                        if (store_patients_tmp.getValue(item, 'status') == "2") {
                            //dijit.byId("b_fam_recessif_compound").set("disabled", "");
							dijit.byId("b_fam_recessif_compound_multi").set("disabled", "");
                            dijit.byId("b_fam_recessif").set("disabled", "");
                            //dijit.byId("b_fam_compound").set("disabled", "");
                            dijit.byId("b_fam_compound_multi").set("disabled", "");
                            dijit.byId("b_fam_denovo").set("disabled", "");
                            //dijit.byId("b_fam_strict_denovo").set("disabled", "");
                            dijit.byId("b_fam_dominant").set("disabled", "");
                            dijit.byId("b_fam_mosaic").set("disabled", "");
                            //dijit.byId("b_fam_incomplete_penetrance").set("disabled", "");
                            dijit.byId("b_fam_uniparental_disomy").set("disabled", "");
                        }
                        h_stats_patients_name[name] = 1;
                        h_stats_patients[name + '_id'] = store_patients_tmp.getValue(item, 'id');
                        h_stats_patients[name + '_sex'] = store_patients_tmp.getValue(item, 'sex');
                        h_stats_patients[name + '_status'] = store_patients_tmp.getValue(item, 'status');
                        h_stats_patients[name + '_include'] = store_patients_tmp.getValue(item, 'include');
                        h_stats_patients[name + '_filter_heho'] = store_patients_tmp.getValue(item, 'filter_heho');
                        h_stats_patients[name + '_child'] = store_patients_tmp.getValue(item, 'child');
                        h_stats_patients[name + '_tissue'] = store_patients_tmp.getValue(item, 'tissue');
                        h_stats_patients[name + '_fam'] = store_patients_tmp.getValue(item, 'fam');
                        h_stats_patients[name + '_group'] = store_patients_tmp.getValue(item, 'group');
                        h_stats_patients[name + '_filter_heho'] = store_patients_tmp.getValue(item, 'filter_heho');
                        h_stats_patients[name + '_coverage'] = store_patients_tmp.getValue(item, 'coverage');
                        h_stats_patients[name + '_1x'] = store_patients_tmp.getValue(item, '1x');
                        h_stats_patients[name + '_5x'] = store_patients_tmp.getValue(item, '5x');
                        h_stats_patients[name + '_15x'] = store_patients_tmp.getValue(item, '15x');
                        h_stats_patients[name + '_30x'] = store_patients_tmp.getValue(item, '30x');
                        h_stats_patients[name + '_bam'] = store_patients_tmp.getValue(item, 'bam');
                    }
                });
                list_json_patients = [];
                var listPatNames = Object.keys( h_stats_patients_name );
                dojo.forEach(listPatNames, function(name) {
                    var json = {
                        "id":               h_stats_patients[name + '_id'],
                        "name":             name,
                        "sex":              h_stats_patients[name + '_sex'],
                        "init_status":      h_stats_patients[name + '_status'],
                        "status":           h_stats_patients[name + '_status'],
                        "include":          h_stats_patients[name + '_include'],
                        "filter_heho":      h_stats_patients[name + '_filter_heho'],
                        "init_child":       h_stats_patients[name + '_child'],
                        "child":            h_stats_patients[name + '_child'],
                        "tissue":           h_stats_patients[name + '_tissue'],
                        "fam":              h_stats_patients[name + '_fam'],
                        "init_group":       h_stats_patients[name + '_group'],
                        "group":            h_stats_patients[name + '_group'],
                        "filter_heho":      h_stats_patients[name + '_filter_heho'],
                        "coverage":         h_stats_patients[name + '_coverage'],
                        "1x":               h_stats_patients[name + '_1x'],
                        "5x":               h_stats_patients[name + '_5x'],
                        "15x":              h_stats_patients[name + '_15x'],
                        "30x":              h_stats_patients[name + '_30x'],
                        "genes":            h_stats_patients[name + '_genes'],
                        "composite":        h_stats_patients[name + '_composite'],
                        "variations":       h_stats_patients[name + '_var'],
                        "substitutions":    h_stats_patients[name + '_sub'],
                        "insertions":       h_stats_patients[name + '_ins'],
                        "deletions":        h_stats_patients[name + '_del'],
                        "cnvs":		        h_stats_patients[name + '_cnv'],
                        "heterozygote":     h_stats_patients[name + '_he'],
                        "homozygote":       h_stats_patients[name + '_ho'],
                        "bam":       		h_stats_patients[name + '_bam'],
                    }
                    list_json_patients.push(json);
                });
                document.getElementById("stat_sample").textContent = listPatNames.length;
                var data_pat = { "items": list_json_patients };
                var newStore_pat = new dojo.data.ItemFileWriteStore({ data: data_pat });
                gridPatient.setStore( newStore_pat );
                gridPatient.setSortIndex(1, true);
                gridEditGroup.setStore( newStore_pat );
                gridEditGroup.setSortIndex(0, true);
                newStore_pat_init = new dojo.data.ItemFileWriteStore({ data: data_pat });
                
                var store_diseases_tmp = new dojo.data.ItemFileWriteStore({data:  {
                    identifier: 'id',
                    label: 'id',
                    items: data.items.diseases
                }});
                
                store_diseases_tmp.fetch({
                    onItem: function (item, result) {
                        var test = store_diseases_tmp.getValue(item, 'item');
                        var list = store_diseases_tmp.getValue(item, 'children');
                        list.children.forEach(function(element) {
                            //alert ('ELEM: '+element);
                            list_json_diseases.push( element );
                        });
                        //list_json_diseases.push( store_diseases_tmp.getValue(item, 'children') );
                    }
                });
                
                var store_regions_tmp = new dojo.data.ItemFileWriteStore({data:  {
                    identifier: 'id',
                    label: 'id',
                    items: data.items.regions
                }});
                
                //TODO: rajouter HASH pour controler si deja rempli ou non
                store_regions_tmp.fetch({
                    onItem: function (item, result) {
                        var json = {
                            "id":           store_regions_tmp.getValue(item, 'id'),
                            "chromosome":   store_regions_tmp.getValue(item, 'chromosome'),
                            "start":        store_regions_tmp.getValue(item, 'start'),
                            "end":          store_regions_tmp.getValue(item, 'end'),
                            "genes":        store_regions_tmp.getValue(item, 'genes'),
                            "substitution": store_regions_tmp.getValue(item, 'substitution'),
                            "insertion":    store_regions_tmp.getValue(item, 'insertion'),
                            "deletion":     store_regions_tmp.getValue(item, 'deletion'),
                            "include":      store_regions_tmp.getValue(item, 'include'),
                        }
                        list_json_regions.push(json);
                    },
                });
                
                if (is_somatic_project == 1) {
                    listGroupsName = [];
                    list_json_groups = [];
                    var store_groups_tmp = new dojo.data.ItemFileWriteStore({data:  {
                        identifier: 'id',
                        label: 'id',
                        items: data.items.groups
                    }});
                    
                    store_groups_tmp.fetch({
                        onItem: function (item, result) {
                            var name  = store_groups_tmp.getValue(item, 'name');
                            listGroupsName.push(name);
                            if (name) { dijit.byId("div_stats_groups").set("disabled", ""); }
                            
                            if (name + '_genes' in h_stats_groups) { h_stats_groups[name + '_genes'] += store_groups_tmp.getValue(item, 'genes'); }
                            else { h_stats_groups[name + '_genes'] = store_groups_tmp.getValue(item, 'genes'); }
                            
                            if (name + '_sub' in h_stats_groups) { h_stats_groups[name + '_sub'] += store_groups_tmp.getValue(item, 'substitution'); }
                            else { h_stats_groups[name + '_sub'] = store_groups_tmp.getValue(item, 'substitution'); }
                            
                            if (name + '_ins' in h_stats_groups) { h_stats_groups[name + '_ins'] += store_groups_tmp.getValue(item, 'insertion'); }
                            else { h_stats_groups[name + '_ins'] = store_groups_tmp.getValue(item, 'insertion'); }
                            
                            if (name + '_del' in h_stats_groups) { h_stats_groups[name + '_del'] += store_groups_tmp.getValue(item, 'deletion'); }
                            else { h_stats_groups[name + '_del'] = store_groups_tmp.getValue(item, 'deletion'); }
                            
                            if (name + '_he' in h_stats_groups) { h_stats_groups[name + '_he'] += store_groups_tmp.getValue(item, 'heterozygote'); }
                            else { h_stats_groups[name + '_he'] = store_groups_tmp.getValue(item, 'heterozygote'); }
                            
                            if (name + '_ho' in h_stats_groups) { h_stats_groups[name + '_ho'] += store_groups_tmp.getValue(item, 'homozygote'); }
                            else { h_stats_groups[name + '_ho'] = store_groups_tmp.getValue(item, 'homozygote'); }
                            
                            var json = {
                                "id":               store_groups_tmp.getValue(item, 'id'),
                                "name":             store_groups_tmp.getValue(item, 'name'),
                                "nb":               store_groups_tmp.getValue(item, 'nb'),
                                "include":          store_groups_tmp.getValue(item, 'include'),
                                "model":            store_groups_tmp.getValue(item, 'model'),
                                "genes":            h_stats_groups[name + '_genes'],
                                "substitution":     h_stats_groups[name + '_sub'],
                                "insertion":        h_stats_groups[name + '_ins'],
                                "deletion":         h_stats_groups[name + '_del'],
                                "heterozygote":     h_stats_groups[name + '_he'],
                                "homozygote":       h_stats_groups[name + '_ho'],
                            }
                            list_json_groups.push(json);
                        }
                    });
                    var data_fam = { "items": list_json_groups };
                    var newStore_gr = new dojo.data.ItemFileWriteStore({ data: data_fam });
                    gridGroups.setStore( newStore_gr );
                    dijit.byId("gridGroups").setSortIndex(0, true);
                }
                
                listFamiliesName = [];
                list_json_families = [];
                var store_families_tmp = new dojo.data.ItemFileWriteStore({data:  {
                    identifier: 'id',
                    label: 'id',
                    items: data.items.families
                }});
                
                var nb_fam = 0;
                store_families_tmp.fetch({
                    onItem: function (item, result) {
                        var name  = store_families_tmp.getValue(item, 'name');
                        h_stats_families_name[name] = 1;
                        listFamiliesName.push(name);
                        if (name) { dijit.byId("button_fam_model").set("disabled", ""); }
                        
                        if (name + '_genes' in h_stats_families) { h_stats_families[name + '_genes'] += store_families_tmp.getValue(item, 'genes'); }
                        else { h_stats_families[name + '_genes'] = store_families_tmp.getValue(item, 'genes'); }
                        
                        if (name + '_sub' in h_stats_families) { h_stats_families[name + '_sub'] += store_families_tmp.getValue(item, 'substitution'); }
                        else { h_stats_families[name + '_sub'] = store_families_tmp.getValue(item, 'substitution'); }
                        
                        if (name + '_ins' in h_stats_families) { h_stats_families[name + '_ins'] += store_families_tmp.getValue(item, 'insertion'); }
                        else { h_stats_families[name + '_ins'] = store_families_tmp.getValue(item, 'insertion'); }
                        
                        if (name + '_del' in h_stats_families) { h_stats_families[name + '_del'] += store_families_tmp.getValue(item, 'deletion'); }
                        else { h_stats_families[name + '_del'] = store_families_tmp.getValue(item, 'deletion'); }
                        
                        if (name + '_cnv' in h_stats_families) { h_stats_families[name + '_cnv'] += store_families_tmp.getValue(item, 'cnv'); }
                        else { h_stats_families[name + '_cnv'] = store_families_tmp.getValue(item, 'cnv'); }
                        
                        if (name + '_he' in h_stats_families) { h_stats_families[name + '_he'] += store_families_tmp.getValue(item, 'heterozygote'); }
                        else { h_stats_families[name + '_he'] = store_families_tmp.getValue(item, 'heterozygote'); }
                        
                        if (name + '_ho' in h_stats_families) { h_stats_families[name + '_ho'] += store_families_tmp.getValue(item, 'homozygote'); }
                        else { h_stats_families[name + '_ho'] = store_families_tmp.getValue(item, 'homozygote'); }
                        
                        h_stats_families[name + '_id'] = store_families_tmp.getValue(item, 'id');
                        h_stats_families[name + '_nb'] = store_families_tmp.getValue(item, 'nb');
                        h_stats_families[name + '_include'] = store_families_tmp.getValue(item, 'include');
                        h_stats_families[name + '_model'] = store_families_tmp.getValue(item, 'model');
                        nb_fam++;
                    }
                });
                list_json_families = [];
                var listFamNames = Object.keys( h_stats_families_name );
                dojo.forEach(listFamNames, function(name) {
                    var json = {
                        "id":               h_stats_families[name + '_id'],
                        "name":             name,
                        "nb":               h_stats_families[name + '_nb'],
                        "include":          h_stats_families[name + '_include'],
                        "model":            h_stats_families[name + '_model'],
                        "genes":            h_stats_families[name + '_genes'],
                        "substitution":     h_stats_families[name + '_sub'],
                        "insertion":        h_stats_families[name + '_ins'],
                        "deletion":         h_stats_families[name + '_del'],
                        "cnv":         		h_stats_families[name + '_cnv'],
                        "heterozygote":     h_stats_families[name + '_he'],
                        "homozygote":       h_stats_families[name + '_ho'],
                    }
                    list_json_families.push(json);
                });
                if (listFamNames.length > 0) { dijit.byId("button_fam_model").set("disabled", ""); }
                var data_fam = { "items": list_json_families };
                var newStore_fam = new dojo.data.ItemFileWriteStore({ data: data_fam });
                gridFamilies.setStore( newStore_fam );
                dijit.byId("gridFamilies").setSortIndex(0, true);
                
                var store_genes_name_tmp = new dojo.data.ItemFileWriteStore({data:  {
                    identifier: 'name',
                    label: 'name',
                    items: data.items.genes_name
                }});
                store_genes_name_tmp.fetch({
                    onComplete: function (items) {
                        dojo.forEach(items, function(item) {
                            var name = store_genes_name_tmp.getValue(item, 'name');
                            var lTmp = name.split(',');
                            dojo.forEach(lTmp, function(gene_name) {
                                var lTmp2 = gene_name.split(';');
                                var text = lTmp2[1] + ';' + lTmp2[2];
                                if (text == '-1;-1') { text = 'NEVER'; }
                                listGenesName[lTmp2[0]] = text;
                            });
                            
                        });
                    }
                });
                
                if (get_value_slider_regionho() > 1) {
	                var store_regions_ho_rec_tmp = new dojo.data.ItemFileWriteStore({data:  {
	                    identifier: 'id',
	                    label: 'id',
	                    items: data.items.regions_ho_rec
	                }});
	                store_regions_ho_rec_tmp.fetch({
	                    onComplete: function (items) {
	                        dojo.forEach(items, function(item) {
	                        	var chr_name = String(store_regions_ho_rec_tmp.getValue(item, 'chr')).replace('chr', '');
	                        	var json = {
	                        		"region_id":        store_regions_ho_rec_tmp.getValue(item, 'id'),
	                                "id":               store_regions_ho_rec_tmp.getValue(item, 'id'),
	                                "fam":             	store_regions_ho_rec_tmp.getValue(item, 'fam'),
	                                "name":             String(store_regions_ho_rec_tmp.getValue(item, 'name')).toUpperCase(),
	                                "status":           store_regions_ho_rec_tmp.getValue(item, 'status'),
	                                "chr":              store_regions_ho_rec_tmp.getValue(item, 'chr'),
	                                "start":            store_regions_ho_rec_tmp.getValue(item, 'start'),
	                                "end":              store_regions_ho_rec_tmp.getValue(item, 'end'),
	                                "length":           store_regions_ho_rec_tmp.getValue(item, 'length'),
	                                "nb_var_ho_before": store_regions_ho_rec_tmp.getValue(item, 'nb_var_ho_before'),
	                                "nb_var_ho_after":  store_regions_ho_rec_tmp.getValue(item, 'nb_var_ho_after'),
	                                "genes":            store_regions_ho_rec_tmp.getValue(item, 'genes'),
	                                "common_regions":   store_regions_ho_rec_tmp.getValue(item, 'common_regions'),
	                                "has_gene_diag":	store_regions_ho_rec_tmp.getValue(item, 'has_gene_diag'),
	                                "is_omim":			store_regions_ho_rec_tmp.getValue(item, 'is_omim'),
	                                "has_hgmd_dm":		store_regions_ho_rec_tmp.getValue(item, 'has_hgmd_dm'),
	                                "link_ucsc":		"https://genome.ucsc.edu/cgi-bin/hgTracks?db=hg19&position=" + store_regions_ho_rec_tmp.getValue(item, 'chr') + "%3A" + store_regions_ho_rec_tmp.getValue(item, 'start') + "%2D" + store_regions_ho_rec_tmp.getValue(item, 'end'),
	                                "link_ensembl":		"https://grch37.ensembl.org/Homo_sapiens/Location/View?r=" + chr_name + "%3A" + store_regions_ho_rec_tmp.getValue(item, 'start') + "-" + store_regions_ho_rec_tmp.getValue(item, 'end'),
	                            }
	                            list_json_regions_ho_rec.push(json);
	                        });
	                    }
	                });
                }
                 
                var store_tmp = new dojo.data.ItemFileWriteStore({data:  {
                    identifier: 'id',
                    label: 'id',
                    items: data.items.chromosomes
                }}); 
                store_tmp.fetch({
                    onItem: function (item, result) {
                        if (store_tmp.getValue(item, 'name') == "No Result") {
                            empty_chr = 1;
                            var store_regions_tmp = new dojo.data.ItemFileWriteStore({data:  {
                                identifier: 'id',
                                label: 'id',
                                items: data.items.regions
                            }});
                        }
                        else {
                        	var this_id = store_tmp.getValue(item, 'id');
                       	
                        	var hex = this_id + ':' + store_tmp.getValue(item, 'vector_HEX');
                            list_chr_vector_hex.push(hex);
                            
                            if (this_id == 'X') {}
                            else if (this_id == 'Y') {}
                            else if (this_id == 'MT') {}
                            else { this_id = parseInt(this_id); }
                            var json_chr = {
                                "id":               this_id,
                                "name":             store_tmp.getValue(item, 'name'),
                                "stop":             store_tmp.getValue(item, 'stop'),
                                "genes":            store_tmp.getValue(item, 'genes'),
                                "heterozygote":     store_tmp.getValue(item, 'heterozygote'),
                                "homozygote":       store_tmp.getValue(item, 'homozygote'),
                                "variations":       store_tmp.getValue(item, 'variations'),
                                "substitutions":    store_tmp.getValue(item, 'substitutions'),
                                "deletions":        store_tmp.getValue(item, 'deletions'),
                                "insertions":       store_tmp.getValue(item, 'insertions'),
                                "cnvs":     	    store_tmp.getValue(item, 'cnvs'),
                                "coding":           store_tmp.getValue(item, 'coding'),
                                "vector_cache":     store_tmp.getValue(item, 'vector_cache'),
                                "vector_size":      store_tmp.getValue(item, 'vector_size'),
                                "vector_enum":      store_tmp.getValue(item, 'vector_enum'),
                            }
							list_json_chr.push(json_chr);
                            global_chr++;
                            var data_tmp = { "items": list_json_chr };
                            var newStore_chr = new dojo.data.ItemFileReadStore({ data: data_tmp });
                            gridChromosome.setStore( newStore_chr );
                            dijit.byId("gridChromosome").setSortIndex(1, true);
                            global_genes += store_tmp.getValue(item, 'genes');
                            //global_var += store_tmp.getValue(item, 'variations');
                            global_uniq += store_tmp.getValue(item, 'variations');
                            global_he += store_tmp.getValue(item, 'heterozygote');
                            global_ho += store_tmp.getValue(item, 'homozygote');
                            document.getElementById("stat_chr").textContent = global_chr;
                            document.getElementById("stat_gene").textContent = global_genes;
                            document.getElementById("stat_var").textContent = global_var;
                            document.getElementById("stat_dif").textContent = global_uniq;
                            //document.getElementById("stat_he").textContent = global_he;
                            //document.getElementById("stat_ho").textContent = global_ho;
                        }
                    }
                }); 
                progress_id += lChrIds.length;
                myProgressBar.set( { value: progress_id } );
                if (progress_id == 75) {
                    while (tree_done == 0) { checkTreeDone(); }
                    updateGenes_captures();
                    updateFoundGeneInGrid();
                    firstConstructTree = 0;
                    list_json_genes = [];
                    var list_chr_with_genes_2 = list_chr_with_genes.filter( onlyUnique );
                    list_chr_with_genes_2.sort(function(a, b){return a-b});
                    var nb = 0;
                    for (var key in list_chr_with_genes_2) {
                        nb++;
                        var chr_name = list_chr_with_genes_2[key];
                        var lGenes = list_json_genes_by_chr[chr_name];
                        var lChrGenes = [];
                        for (var key_2 in lGenes) { lChrGenes.push(key_2); }
                        lChrGenes.sort();
                        for (var key_2 in lChrGenes) {
                            var item = lGenes[key_2];
                            //if (json_genes < limit_genes_json) {
                                list_json_genes.push(item);
                                json_genes++;
                            //}
                        }
                    }
                    if (nb == 0) {
                        initStatusPatients();
                        initStatusFamilies();
                        view_all_in_attic();
                        var json = {
                            "name":             "No Result",
                            "id":               "No Result",
                            "stop":             0,
                            "heterozygote":     0,
                            "genes":            0,
                            "coding":           0,
                            "deletions":        0,
                            "insertions":       0,
                            "variations":       0,
                            "substitutions":    0,
                            "cnvs":             0,
                            "homozygote":       0,
                        }
                        list_json_genes.push(json);
                        cgi_args = cgi_args.replace(/&/, '');
                        var lObjFilters = [];
                        var lArgs = cgi_args.split('&');
                        var i;
                        for ( i = 0; i< lArgs.length; i++ ) {
                            var lArgs2 = lArgs[i].split('=');
                            var name = 'filter_' + lArgs2[0];
                            var value = lArgs2[1];
                            value = value.replace(/\+/g, ' ');
                            name = name.replace('filter_filter_', 'filter_');
                            name = name.replace('dejavu_ho', 'dejavuho');
                            name = name.replace('filter_model', 'filter_genetic_model');
                            if (name == 'filter_attic' || name == 'filter_patient' || name == 'filter_not_patient' || name == 'filter_fam_not' || name == 'filter_fam_and' || name == 'filter_he' || name == 'filter_ho' || name == 'level_fam' || name == 'level_ind') {
                                var obj = new Filter (name, value);
                                lObjFilters.push(obj);
                            }
                        }
                        if (lObjFilters.length > 0) { changeButtonPatFamStatutOnly(lObjFilters); }
                        // dijit.byId('at_least_genes').set('value', '1');
                        // do_at_least_genes();
                    }
                    var data_genes = { "items": list_json_genes };
                    var newStore_genes = new dojo.data.ItemFileWriteStore({ data: data_genes });
                    gridListGenes.setStore(newStore_genes);
                    setTimeout(function () {
                        dijit.byId('waiting_progress').hide();
                    }, 1000);
                    var data_reg = { "items": list_json_regions };
                    store_region = new dojo.data.ItemFileWriteStore({ data: data_reg });
                    gridRegion.setStore( store_region );
                    dijit.byId("gridRegion").setSortIndex(1, true);
                    if (get_value_slider_regionho() > 1) {
                    	var list_json_regions_ho_rec_sorted = sortListJsonByChr(list_json_regions_ho_rec);
                    	var data_reg_ho_rec = { "items": list_json_regions_ho_rec_sorted };
	                    store_regions_ho_rec = new dojo.data.ItemFileWriteStore({ data: data_reg_ho_rec });
	                    gridRegionsHoRec.setStore( store_regions_ho_rec );
	                    document.getElementById('b_viewRegionsHoRec').style.visibility = 'visible';
	                    dijit.byId("b_viewRegionsHoRec").set("disabled", false);
					    if (filtering_mode == 'fam') {
					        gridRegionsHoRec.layout.setColumnVisibility(4, false);
					        gridRegionsHoRec.layout.setColumnVisibility(5, false);
					    }
					    else {
					        gridRegionsHoRec.layout.setColumnVisibility(4, true);
					        gridRegionsHoRec.layout.setColumnVisibility(5, true);
					    }
	                }
	                else {
	                	document.getElementById('b_viewRegionsHoRec').style.visibility = 'hidden';
	                    dijit.byId("b_viewRegionsHoRec").set("disabled", true);
                		//gridListGenes.setSortIndex(19, false);
				    	//gridListGenes.layout.setColumnVisibility(19, false);
				    	if (can_use_hgmd == 'yes') {
				    		gridListGenes.layout.setColumnVisibility(30, false);
				    		if (is_cache_updated == 'yes') {
				    			//gridListGenes.layout.setColumnVisibility(19, true);
				    			gridListGenes.layout.setColumnVisibility(30, true);
			    			}
				    	}
				    	else {
                    		gridListGenes.setSortIndex(18, false);
				    		document.getElementById('b_show_hgmd_dejavu_gene').style.visibility = 'hidden';
				    		document.getElementById('b_show_hgmd_dejavu_patient').style.visibility = 'hidden';
				    		//gridListGenes.layout.setColumnVisibility(10, false);
						}
					}
                    refreshGridFilter();
                    dijit.byId("gridChromosome").setSortIndex(1, true);
                    isRunning = 0;
                    document.getElementById("img_run_1").src="../images/polyicons/run_2.png";
                    document.getElementById("img_run_2").src="../images/polyicons/run_2.png";
					if (genetic_model == 'compound_multi' || genetic_model == 'recessif_compound_multi' || genetic_model == 'uniparental_recessif_compound_multi') {
						document.getElementById("span_run_msg").innerHTML = "<b>&nbsp;&nbsp;2nd VAR&nbsp;</b>";
					}
					else {
                    	document.getElementById("span_run_msg").innerHTML = "<b>&nbsp;&nbsp;RUN&nbsp;</b>";
					}
                    document.getElementById("span_run_msg_all_genes").innerHTML = "<b>&nbsp;&nbsp;LIST ALL Genes&nbsp;</b>";
                    document.getElementById("startButton").disabled = false;
                    document.getElementById("startButtonAllGenes").disabled = false;
                    document.getElementById("b_view_all_genes").disabled = false;
                    // if ((global_uniq <= 500) && (global_genes == list_json_genes.length)) {
                        // document.getElementById("b_viewAllVar").disabled = false;
                    // }
                    if (export_vcf_available == 1) { dijit.byId("b_export_xls_vcf").set("disabled", false); }
                    view_all_genes = 0;
                    limit_genes_json = 100;
                    gridPatient.layout.setColumnVisibility(0, false);
                    gridFamilies.layout.setColumnVisibility(0, false);
                    if (mem_isIntersectGenes == 1) {
                        gridListGenes.layout.setColumnVisibility(1, true);
                        getNbCommonPatientsAfterGeneIntersect();
                        dijit.byId("gridPatient").setSortIndex(0, true);
                    }
                    else {
                        gridListGenes.layout.setColumnVisibility(1, false);
                    }
                    mem_isIntersectGenes = null;
                    display_b_viewSelectedGenesVar();
                    args_pat_inattic_genes_filters = check_pat_fam_to_intersect_from_genes_filters();
                    hide_attic();
                    setTimeout(function() {
                        dijit.byId("gridChromosome").render();
                        dijit.byId("gridFamilies").render();
                        dijit.byId("gridPatient").render();
                    }, 400);
                    if (use_args) {
                        lObjFilters = [];
                        var lArgs = use_args.split('&');
                        var i;
                        for ( i = 0; i< lArgs.length; i++ ) {
                            var lArgs2 = lArgs[i].split('=');
                            var name = 'filter_' + lArgs2[0];
                            var value = lArgs2[1];
                            value = value.replace(/\+/g, ' ');
                            name = name.replace('filter_filter_', 'filter_');
                            name = name.replace('dejavu_ho', 'dejavuho');
                            name = name.replace('filter_model', 'filter_genetic_model');
                            var obj = new Filter (name, value);
                            lObjFilters.push(obj);
                        }
                        changeButtonStatut(lObjFilters);
                        use_args = null;
                    }
				    if (can_use_hgmd == 'yes' && get_value_slider_regionho() > 1) {
				    	if (document.getElementById("stat_filtering_type").textContent == "Individual") {
			    			dijit.byId("gridListGenes").set("structure", "layoutListGenesWithRegionHoHgmd");
				    	}
				    	else if (document.getElementById("stat_filtering_type").textContent == "Familial") {
			    			dijit.byId("gridListGenes").set("structure", "layoutListGenesWithRegionRecHgmd");
				    	}
				    }
				    else if (can_use_hgmd == 'yes' && get_value_slider_regionho() == 0) {
			    		dijit.byId("gridListGenes").set("structure", "layoutListGenesHgmd");
				    }
    				if (is_cache_updated == 'yes') {
    					//dijit.byId("b_go_to_polydiag").set("disabled", false);
	                    //document.getElementById('b_go_to_polydiag').style.visibility = 'visible';
				    	//gridListGenes.layout.setColumnVisibility(19, true);
				    	//gridListGenes.layout.setColumnVisibility(30, true);
					}
					else {
						dijit.byId("b_go_to_polydiag").set("disabled", true);
	                    document.getElementById('b_go_to_polydiag').style.visibility = 'hidden';
	                    if (can_use_hgmd == 'yes') {
					    	//gridListGenes.layout.setColumnVisibility(19, false);
					    	//gridListGenes.layout.setColumnVisibility(30, false);
				    	}
					}
                }
                return deferred.promise;
            },
            onComplete: function (item, result) {
                deferred.resolve(chr_id + "_OK");
            },
            error: function(error) {
                alert("ERROR.... " + error);
                console.log(hurl);
            }
        };
        var deferred = dojo.xhrGet(xhrArgs);
    }
});

function sortListJsonByChr(list_json_regions_ho_rec) {
	var nb_regions = 0;
	var list_json_regions_ho_rec_sort = [];
	var chr_id = 1;
	var color = '#2D2F30';
    while (chr_id <= 25) {
    	var chr_name = 'chr' + chr_id;
    	if (chr_id == 23) { chr_name = 'chrX'; }
    	if (chr_id == 24) { chr_name = 'chrY'; }
    	if (chr_id == 25) { chr_name = 'chrMT'; }
    	var i = 0;
    	var old_common = '';
    	var pos_min;
    	var pos_max;
    	while (i < list_json_regions_ho_rec.length) {
    		var json = list_json_regions_ho_rec[i];
    		var json_chr = String(json.chr);
    		if (String(json_chr) == 'chrM') { json_chr = 'chrMT'; }
    		if (String(json_chr) == String(chr_name)) {
    			var this_common = String(json.common_regions);
				if (String(this_common) == String(old_common)) {}
    			else {
    				nb_regions++;
    				old_common = String(this_common);
    				var json_null = {
	            		"region_id":        '',
	                    "id":               '',
	                    "fam":             '',
	                    "name":             '',
	                    "status":           '',
	                    "chr":              '',
	                    "start":            '',
	                    "end":              '',
	                    "length":           '',
	                    "nb_var_ho_before": '',
	                    "nb_var_ho_after":  '',
	                    "genes":            '',
	                    "common_regions":   '',
	                    "has_gene_diag":	'',
	                    "is_omim":			'',
	                    "has_hgmd_dm":		'',
	                    "link_ucsc":		'',
	                    "link_ensembl":		'',
	                };
    				list_json_regions_ho_rec_sort.push(json_null);
    				old_common = String(this_common);
    				if (color == '#2D2F30') { color = '#0000FF'; }
    				else if (color == '#0000FF') { color = '#2D2F30'; }
    			}
				var json_color = {
            		"region_id":        String(json.region_id),
                    "id":               String(json.id) + ';' + String(color),
                    "fam":				String(json.fam) + ';' + String(color),
                    "name":             String(json.name) + ';' + String(color),
                    "status":           String(json.status),
                    "chr":              String(json.chr) + ';' + String(color),
                    "start":            String(json.start) + ';' + String(color),
                    "end":              String(json.end) + ';' + String(color),
                    "length":           String(json.length) + ';' + String(color),
                    "nb_var_ho_before": String(json.nb_var_ho_before) + ';' + String(color),
                    "nb_var_ho_after":  String(json.nb_var_ho_after) + ';' + String(color),
                    "genes":            String(json.genes),
                    "common_regions":   String(json.common_regions),
                    "has_gene_diag":	String(json.has_gene_diag),
                    "is_omim":			String(json.is_omim),
                    "has_hgmd_dm":		String(json.has_hgmd_dm),
                    "link_ucsc":		String(json.link_ucsc),
                    "link_ensembl":		String(json.link_ensembl),
                };
    			pos_min = parseInt(json.start);
    			pos_end = parseInt(json.end);
    			list_json_regions_ho_rec_sort.push(json_color);
    		}
    		i++;
    	}
    	chr_id++;
    }
    if (document.getElementById("stat_filtering_type").textContent == "Individual") {
		dijit.byId('dialog_regions_ho_rec').set('title', 'List Ho Regions');
		document.getElementById("span_view_regions_ho_rec").innerHTML = 'View <b>' + nb_regions + ' Ho Regions</b>';
		can_search_ho_rec = 'patient';
    }
    else if (document.getElementById("stat_filtering_type").textContent == "Familial") {
    	dijit.byId('dialog_regions_ho_rec').set('title', 'List Rec Regions');
    	document.getElementById("span_view_regions_ho_rec").innerHTML = 'View <b>' + nb_regions + ' Rec Regions</b>';
    	can_search_ho_rec = 'family';
    }
    return list_json_regions_ho_rec_sort;
}

function checkKeyPressed(event) {
    if (event.keyCode == 13) {
        if (isRunning == 0) {
            require([ "dijit/focus" ], function(focusUtil){
                var activeElement = focusUtil.curNode;
                if (activeElement.id == 'filter_identical_number') { focusUtil.focus(document.getElementById("startButton")); }
                // if (activeElement.id == 'at_least_genes') { return do_at_least_genes(); }
                isRunning = 1;
                document.getElementById("startButton").click();
            });
        }
    }
}

var view_all_genes = 0;
var limit_genes_json = 100;
function run_view_all_genes() {
    if (document.getElementById("b_view_all_genes").checked == true) {
        view_all_genes = 1;
        limit_genes_json = 99999999999999;
    }
    else {
        view_all_genes = 0;
        limit_genes_json = 100;
    }
}
    
function unCheckedAllGenes() {
    var root1 = tree.getChildren();
    for (var d in tree.model.root.children) {
        var ds = tree.model.root.children[d];
        for (var b in ds.children){
            var bs = ds.children[b];
            tree.model.setChecked(bs,false);
        }
    }
}
    
function addRowGenes() {
    isRunning = 1;
    //closeAllNodes();
    dialog_list_genes.show();
}
    
function closeAllNodes() {
    tree.collapseAll();
}

function check_slider_frequence_2() {
	if (parseInt(dijit.byId("slider_frequence_2").get("value")) < parseInt(dijit.byId("slider_frequence").get("value"))) {
		dijit.byId("slider_frequence_2").set("value", parseInt(dijit.byId("slider_frequence").get("value")));
	}
}

 
var lGenesOk = {};
var lOnlyThesesGenes = [];
var lOnlyThesesGenes_coverage = [];
var lOnlyThesesGenes_json = [];

function addGenes() {
    lGenesOk = {};
    lOnlyThesesGenes = [];
	lOnlyThesesGenes_coverage = [];
    lOnlyThesesGenes_json = [];
    addListGenes('[\n]+','[ \t]+');
}

function addCapturesGenes() {
    var root1 = tree.getChildren();
    for (var d in tree.model.root.children) {
    	var all_capture_checked = 'false';
        var ds = tree.model.root.children[d];
        for (var b in ds.children){
            var bs = ds.children[b];
	        if (bs.checked == 'true') {
	            var lGenes = String(bs.genes).split(',');
            	for (var l in lGenes) {
                    var name = lGenes[l];
                    if (!lGenesOk[name]) {
                        lGenesOk[name] = 1;
		                var found = 'false';
		                if (listGenesName[name]) { found = 'yes'; }
		                var json = {
		                    "name":   name.toUpperCase(),
		                    "id":     name.toUpperCase(),
		                    "found":  found,
		                }
		                lOnlyThesesGenes_json.push(json);
	                }
	        	}
	        	var lCol = String(bs.name).split(' ');
	            lOnlyThesesGenes.push('capture:'+lCol[0]);
	            lOnlyThesesGenes_coverage.push('capture:'+lCol[0]);
	    	}
        }
    }
}


function addListGenes(regexp1,regexp2) {
	var old_waiting_text = document.getElementById("waiting_text").textContent;
    document.getElementById("waiting_text").textContent = "PolyQuery check if your gene(s) name(s) exist...";
    dijit.byId('waiting').show();
    var hurl;
    var tableau = [];
    var text = text_list_genes.get("value");
    var arguments = 'project=' + projectName;
    if (text == '') {
    	arguments += "&check_genes=+";
    }
    else {
	    var reg = new RegExp(regexp1, "g");
	    tableau = text.split(reg);
	    var i = 0;
        dojo.forEach(tableau, function(item) {
        	tableau[i] = tableau[i].replace(/ /g, '');
        	i++;
        });
	    arguments += "&check_genes=" + tableau.join('+');
    }

    var lGenesExists = {};
	var xhr = new XMLHttpRequest();
	xhr.responseType = 'json';
	xhr.open('POST', cache_all_url, true);
	xhr.setRequestHeader('Content-type', 'application/x-www-form-urlencoded');
	xhr.onload = function () {
		var json_reponse = xhr.response;
		var items = json_reponse.items;
        dojo.forEach(items, function(item) {
        	lGenesExists[item] = 'ok';
        });
        for (var i=0; i<tableau.length; i++) {
            var name  = tableau[i].toUpperCase();
            if (name == '') {}
            else {
                if (!lGenesOk[name]) {
                    lGenesOk[name] = 1;
                    var found = 'false';
                    if (listGenesName[name] == 'NEVER') { found = 'NEVER'; }
                    else if (listGenesName[name]) {
                    	found = 'yes';
                    	lOnlyThesesGenes_coverage.push(name);
	                    var json = {
	                        "name": name,
	                        "id":   name,
	                        "found":  found,
	                    }
	                    lOnlyThesesGenes_json.push(json);
	                    lOnlyThesesGenes.push(name);
                    }
                    else if (lGenesExists[name]) {
                    	found = 'false';
                    	lOnlyThesesGenes_coverage.push(name);
	                    var json = {
	                        "name": name,
	                        "id":   name,
	                        "found":  found,
	                    }
	                    lOnlyThesesGenes_json.push(json);
	                    lOnlyThesesGenes.push(name);
            		}
                    else {
                    	alert('This gene '+name+' doesn\'t exist...');
                    	found = 'NEVER';
                    }
                }
            }
        }
	    addCapturesGenes();
	    document.getElementById("b_view_all_genes").checked = true;
	    run_view_all_genes();
	    var data_tmp = { "items": lOnlyThesesGenes_json };
	    var newStore_list_genes = new dojo.data.ItemFileReadStore({ data: data_tmp });
	    dijit.byId("gridGenesUser").setStore( newStore_list_genes );
	    dijit.byId("gridGenesUser").setSortIndex(2, true);
	    var nb = lOnlyThesesGenes_json.length;
	    if (nb == 1) {
	        dijit.byId("title_genes").set("title", "<font color='green'><b>1 Gene</b></font>");
	    }
	    else if (nb > 1) {
	        dijit.byId("title_genes").set("title", "<font color='green'><b>"+nb+" Genes</b></font>");
	    }
	    isRunning = 0;
	    dialog_list_genes.hide();
		dijit.byId('waiting').hide();
	    document.getElementById("waiting_text").textContent = old_waiting_text;
	};
	xhr.send(arguments);
}

function addListGenes_OLD(regexp1,regexp2) {
	var old_waiting_text = document.getElementById("waiting_text").textContent;
    document.getElementById("waiting_text").textContent = "PolyQuery check if your gene(s) name(s) exist...";
    dijit.byId('waiting').show();
    var hurl;
    var tableau = [];
    var text = text_list_genes.get("value");
    if (text == '') {
    	hurl = cache_all_url + "&check_genes=+";
    }
    else {
	    var reg=new RegExp(regexp1, "g");
	    tableau=text.split(reg);
	    hurl = cache_all_url + "&check_genes=" + tableau.join('+');
    }
    var store_genes = new dojo.data.ItemFileWriteStore({ url: hurl });
    
    alert('HURL: '+hurl);
    
    store_genes.fetch({
        onComplete: function(items){
	        var lGenesExists = [];
	            dojo.forEach(items, function(item) {
	            	lGenesExists[item] = 'ok';
	            });
	        for (var i=0; i<tableau.length; i++) {
	            var name  = tableau[i].toUpperCase();
	            if (name == '') {}
	            else {
	                if (!lGenesOk[name]) {
	                    lGenesOk[name] = 1;
	                    var found = 'false';
	                    if (listGenesName[name] == 'NEVER') { found = 'NEVER'; }
	                    else if (listGenesName[name]) {
	                    	found = 'yes';
	                    	lOnlyThesesGenes_coverage.push(name);
	                    }
	                    else if (lGenesExists[name]) {
	                    	found = 'false';
	                    	lOnlyThesesGenes_coverage.push(name);
                		}
	                    else { found = 'NEVER'; }
	                    var json = {
	                        "name": name,
	                        "id":   name,
	                        "found":  found,
	                    }
	                    lOnlyThesesGenes_json.push(json);
	                    lOnlyThesesGenes.push(name);
	                }
	            }
	        }
		    addCapturesGenes();
		    document.getElementById("b_view_all_genes").checked = true;
		    run_view_all_genes();
		    var data_tmp = { "items": lOnlyThesesGenes_json };
		    var newStore_list_genes = new dojo.data.ItemFileReadStore({ data: data_tmp });
		    dijit.byId("gridGenesUser").setStore( newStore_list_genes );
		    dijit.byId("gridGenesUser").setSortIndex(2, true);
		    var nb = lOnlyThesesGenes_json.length;
		    if (nb == 1) {
		        dijit.byId("title_genes").set("title", "<font color='green'><b>1 Gene</b></font>");
		    }
		    else if (nb > 1) {
		        dijit.byId("title_genes").set("title", "<font color='green'><b>"+nb+" Genes</b></font>");
		    }
		    isRunning = 0;
		    dialog_list_genes.hide();
			dijit.byId('waiting').hide();
		    document.getElementById("waiting_text").textContent = old_waiting_text;
        }
    });
}

function deleteListGenes() {
    lOnlyThesesGenes = [];
    var list_json_filter_genes = [];
    var data_tmp = { "items": list_json_filter_genes };
    var newStore_list_genes = new dojo.data.ItemFileReadStore({ data: data_tmp });
    dijit.byId("gridGenesUser").setStore( newStore_list_genes );
    dijit.byId("title_genes").set("title", "Genes");
    document.getElementById("b_view_all_genes").checked = false;
    run_view_all_genes();
}


function get_export_url() {
    var base_url = window.location.href ;
    var lTmp = base_url.split("?");
    var website = lTmp[0];
    var args = construct_url_filter_data();
    args = args.replace('&', "");
    args = args.replace(/\&/g, ";");
    if (lOnlyThesesGenes.length > 0) {
        args += ";only_genes="+lOnlyThesesGenes.join(",");
    }
    var export_url = website + "?project=" + projectName + '&type=' + project_type + '&use_args=' + args;
	return export_url;
}

function export_url() {
	var export_url = get_export_url();
    document.getElementById("span_export_url").textContent = export_url;
    dijit.byId('dialog_export_url').show();
}

var run_check_project = 0;
var run_check_project_quick = 0;
function check_project(type) {
    if (type == 'quick') { run_check_project_quick = 1; }
    else { run_check_project_quick = 0; }
    run_check_project = 1;
    if (isRunning == 0) {
        var all_chr = '1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,X,Y,MT';
        var list = all_chr.split(',');
        dojo.forEach(list, function(chr_id) {
            var name = "status_check_" + chr_id;
            document.getElementById(name).innerHTML = "<i>Please Wait</i>";
        });
        document.getElementById("startButton").click();
    }
}

function show_resume_check_project() {
    dijit.byId('resume_check').show();
}

function show_genes_in_capture(capture_name, genes) {
	var lGenes = genes.split(',');
	var this_title = 'Genes in capture file ' + capture_name;
	var n = 1;
	var lJson = [];
	for (var i=0; i<lGenes.length; i++) {
        var name  = lGenes[i].toUpperCase();
        var found = 'false';
        if (listGenesName[name]) {
        	found = 'yes';
        	var json = {
            	"name": name,
            	"id":   name,
            	"found":  found,
        	};
        	lJson.push(json);
        }
    }
    var data_tmp = { "items": lJson };
    var newStore_list_genes = new dojo.data.ItemFileReadStore({ data: data_tmp });
    dijit.byId("gridGenesInCapture").setStore( newStore_list_genes );
    dijit.byId("gridGenesInCapture").setSortIndex(1, false);
	dijit.byId('dialog_genes_capture').set('title', this_title);
	dijit.byId('dialog_genes_capture').show();
}

function show_regions_ho_rec() {
	gridRegionsHoRec.store.fetch({
        onComplete: function(items, request) {
		    for (i=0; i<items.length; i++) {
		    	var item = items[i];
		        if (String(item.name) == '') {
		        	gridRegionsHoRec.selection.setSelected(i, true);
		        }
		        else {
		        	gridRegionsHoRec.selection.setSelected(i, false);
		        }
	        }
        }
    });
    document.getElementById('text_search_region_ho_rec').value = '';
	dijit.byId('dialog_regions_ho_rec').show();
}


// var at_least_genes_used = false;
// function do_at_least_genes(nb) {
    // if (!nb) { nb = dijit.byId('at_least_genes').getValue(); }
    // if (!nb) {
        // dijit.byId('at_least_genes').set('value', '1');
        // nb = 1;
    // }
    // if (nb > 1) { at_least_genes_used = true; }
    // else { at_least_genes_used = false; }
    // var store = gridListGenes.store;
    // var ok  = 0;
    // var all = 0;
    // store.fetch ({
        // onItem: function (item, result) {
            // all++;
            // if (famind == 'Fam') {
                // if (nb == 1) { document.getElementById("at_least_genes_text").textContent = "Family"; }
                // else { document.getElementById("at_least_genes_text").textContent = "Families"; }
                // var nbFam = store.getValue(item, 'nb_fam');
                // if (nb <= nbFam) {
                    // store.setValue(item, 'to_keep', 'yes');
                    // ok++;
                // }
                // else { store.setValue(item, 'to_keep', 'no'); }   
            // }
            // else {
                // if (nb == 1) { document.getElementById("at_least_genes_text").textContent = "Patient"; }
                // else { document.getElementById("at_least_genes_text").textContent = "Patients"; }
                // var nbPat = store.getValue(item, 'p_all');
                // if (nb <= nbPat) {
                    // store.setValue(item, 'to_keep', 'yes');
                    // ok++;
                // }
                // else { store.setValue(item, 'to_keep', 'no'); }   
            // }
        // },
        // onComplete: function() {
            // gridListGenes.filter({to_keep: "yes"});
            // if (nb == 1) {
                // document.getElementById("stat_gene").textContent = all;
                // document.getElementById("span_nb_sel_genes").innerHTML = 'View <b>ALL</b> Genes';
                // if (global_uniq <= 500) {
                    // if (json_genes == document.getElementById("stat_gene").textContent) { dijit.byId("b_viewSelectedGenesVar").set("disabled", false); }
                    // else { dijit.byId("b_viewSelectedGenesVar").set("disabled", true); }
                // }
                // else { dijit.byId("b_viewSelectedGenesVar").set("disabled", true); }
            // }
            // else {
                // document.getElementById("stat_gene").textContent = ok + ' / ' + all;
                // document.getElementById("span_nb_sel_genes").innerHTML = 'View <b>FILTERED</b> Genes';
                // if (ok <= 100) { dijit.byId("b_viewSelectedGenesVar").set("disabled", false); }
                // else { dijit.byId("b_viewSelectedGenesVar").set("disabled", true); }
            // }
            // setTimeout(function() { dijit.byId("gridListGenes").render(); }, 250);
        // }
    // });
// }

function selectPatients_horegion(value){
	gridListGenes.layout.setColumnVisibility(1, false);
	gridFamilies.layout.setColumnVisibility(0, true);
	gridPatient.layout.setColumnVisibility(0, true);
    var h_patfam_found = {};
    var lPat = value.split(',');
    var i = 0;
    while (i < lPat.length) {
    	h_patfam_found[lPat[i]] = 1;
    	i++;
    }
    gridPatient.store.fetch({
        onComplete: function(items, request) {
            var n = 0;
            var max = gridPatient.rowCount;
            while (n < max) {
                var selectedItem = items[n];
                var id = gridPatient.store.getValue(selectedItem, "id");
                var fam = gridPatient.store.getValue(selectedItem, "fam");
            	var to_get;
				if (famind == 'Ind') { to_get = id; }
				else if (famind == 'Fam') { to_get = fam; }
	            if (id in h_patfam_found) {
	            	gridPatient.store.setValue(selectedItem, "found", 'yes');
	            	h_patfam_found[fam] = 1;
            	}
            	else { gridPatient.store.setValue(selectedItem, "found", ''); }
				n++;
            }
            gridFamilies.store.fetch({
		        onComplete: function(items, request) {
		            var n = 0;
		            var max = gridFamilies.rowCount;
		            while (n < max) {
		                var selectedItem = items[n];
		                var name = gridFamilies.store.getValue(selectedItem, "name");
		            	var to_get;
			            if (name in h_patfam_found) {
			            	gridFamilies.store.setValue(selectedItem, "found", 'yes');
		            	}
		            	else { gridFamilies.store.setValue(selectedItem, "found", ''); }
						n++;
		            }
        			dijit.byId("gridPatient").setSortIndex(0, false);
		        	dijit.byId("gridFamilies").setSortIndex(0, false);
		        }
		    });
        }
    });
}

function selectFamilies_recregion(value) {
	gridListGenes.layout.setColumnVisibility(1, false);
	gridFamilies.layout.setColumnVisibility(0, true);
	gridPatient.layout.setColumnVisibility(0, false);
    var h_patfam_found = {};
    var lFam = value.split(',');
    var i = 0;
    while (i < lFam.length) {
    	h_patfam_found[lFam[i]] = 1;
    	i++;
    }
	gridFamilies.store.fetch({
        onComplete: function(items, request) {
            var n = 0;
            var max = gridFamilies.rowCount;
            while (n < max) {
                var selectedItem = items[n];
                var name = gridFamilies.store.getValue(selectedItem, "name");
            	var to_get;
	            if (name in h_patfam_found) {
	            	gridFamilies.store.setValue(selectedItem, "found", 'yes');
            	}
            	else { gridFamilies.store.setValue(selectedItem, "found", ''); }
				n++;
            }
        	dijit.byId("gridFamilies").setSortIndex(0, false);
        }
    });
}

</script>
    </head>
    <body class="claro"  style ="font-size:9px;" onkeydown="checkKeyPressed(event)">
 <div id="header_apple">
    <span class="title_page">Projects List</span>
    <span class="insetheader2"><img src="/icons/Polyicons/bipd4.png" width="50%" height="50%"></span>
    <span class="insetheader3">Bioinformatics Paris Descartes</span>
    <span class="title_credit">Universit Paris Descartes , Institut Imagine</span>
        <div id="header-content">
                <span class="insetheader_projectname"> <label class ="label1" id="stat_project">---</label>
                    <img id="image_info_details" onMouseOver="checkMessageError()" style="visibility:visible"/>
                    <div data-dojo-type="dijit/Tooltip" data-dojo-props="connectId:'image_info_details',position:['below']">
                        <div id="div_resume" style="width: 350px;height: 360px;">
                            <span><font color="red"><b><u>Global Informations</u></b></font></span><br>
                            
                            <table border="2px" align-text="center">
                                <tr>
                                    <td style="width: 100px;"><span><b>NAME</b></span></td>
                                    <td style="width: 250px;"><span id="info_name">---</span></td>
                                </tr>
                                <tr>
                                    <td style="width: 100px;"><span><b>DESCRIPTION</b></span></td>
                                    <td style="width: 150px;"><span id="info_description">---</span></td>
                                </tr>
                                <tr>
                                    <td style="width: 100px;"><span><b>PROJECT TYPE</b></span></td>
                                    <td style="width: 150px;"><span id="info_project_type">---</span></td>
                                </tr>
                                <tr hidden>
                                    <td style="width: 100px;"><span><b>IS BIG PROJECT</b></span></td>
                                    <td style="width: 150px;"><span id="info_big_data">---</span></td>
                                </tr>
                            </table>
                            <br><span><font color="red"><b><u>Analyse Informations</u></b></font></span><br>
                            <table border="2px" align-text="center">
                                <tr>
                                    <td style="width: 100px;"><span><b>BUILD</b></span></td>
                                    <td style="width: 250px;"><span id="info_build">---</span></td>
                                </tr>
                                <tr>
                                    <td style="width: 100px;"><span><b>ANNOTATION VERSION</b></span></td>
                                    <td style="width: 250px;"><span id="info_annotation_version">---</span></td>
                                </tr>
                                <tr>
                                    <td style="width: 100px;"><span><b>IS GENOME</b></span></td>
                                    <td style="width: 150px;"><span id="info_genome">---</span></td>
                                </tr>
                                <tr>
                                    <td style="width: 100px;"><span><b>IS EXOME</b></span></td>
                                    <td style="width: 150px;"><span id="info_exome">---</span></td>
                                </tr>
                                <tr>
                                    <td style="width: 100px;"><span><b>IS DIAGNOSTIC</b></span></td>
                                    <td style="width: 150px;"><span id="info_diag">---</span></td>
                                </tr>
                                <tr>
                                    <td style="width: 100px;"><span><b>CAPTURE</b></span></td>
                                    <td style="width: 150px;"><span id="info_capture">---</span></td>
                                </tr>
                                <tr>
                                    <td style="width: 100px;"><span><b>ALIGN METHOD</b></span></td>
                                    <td style="width: 150px;"><span id="info_align">---</span></td>
                                </tr>
                                <tr>
                                    <td style="width: 100px;"><span><b>CALLING METHOD</b></span></td>
                                    <td style="width: 150px;"><span id="info_calling">---</span></td>
                                </tr>
                                <tr>
                                    <td style="width: 100px;"><span><b>VERSION DBSNP</b></span></td>
                                    <td style="width: 150px;"><span id="info_dbsnp">---</span></td>
                                </tr>
                                <tr>
                                    <td style="width: 100px;"><span><b>VERSION EVS</b></span></td>
                                    <td style="width: 150px;"><span id="info_evs">---</span></td>
                                </tr>
                                <tr>
                                    <td style="width: 100px;"><span><b>VERSION 1000 GENOMES</b></span></td>
                                    <td style="width: 150px;"><span id="info_1k">---</span></td>
                                </tr>
                                <tr>
                                    <td style="width: 100px;"><span><b>VERSION EXAC</b></span></td>
                                    <td style="width: 150px;"><span id="info_exac">---</span></td>
                                </tr>
                                <tr>
                                    <td style="width: 100px;"><span><b>VERSION COSMIC</b></span></td>
                                    <td style="width: 150px;"><span id="info_cosmic">---</span></td>
                                </tr>
                                <tr>
                                    <td style="width: 100px;"><span><b>VERSION PREDICTION MATRIX</b></span></td>
                                    <td style="width: 150px;"><span id="info_matrix">---</span></td>
                                </tr>
                                <tr>
                                    <td style="width: 100px;"><span><b>CACHE STRICT_DENOVO</b></span></td>
                                    <td style="width: 150px;"><span id="info_strict_denovo">---</span></td>
                                </tr>
                                <tr>
                                    <td style="width: 100px;"><span><b>CACHE DEJAVU</b></span></td>
                                    <td style="width: 150px;"><span id="info_dejavu">---</span></td>
                                </tr>
                            </table>
                            <br>
                            <table>
                            	<!--
                                <td style="padding-left: 2px">
                                    <center>
                                        <button id="b_view_resume_check_project" type="button" onclick="show_resume_check_project()">View Resume Check Project</button>
                                    </center>
                                </td>
                                -->
                                <td style="padding-left: 5px">
                                    <center>
                                        <button id="b_export_url" type="button" onclick="export_url()">Export URL</button>
                                    </center>
                                </td>
                            </table>
                        </div>
                    </div>
                </span>
                <br>
                <span class="insetheader_description2">
                    <span class="insetheader_description"><label class = "label1" id="stat_description">---</label></span>
                
                </span>
        </div>
</div>

        <div  id="toolbar" dojoType="dijit.Toolbar" style="height:22px;">
            <span class="myspan">Samples  <label class = "label2" id="stat_sample">??</label></span>
            <span class="myspan"><a>Chr</a ><label class = "label2" id="stat_chr">??</label></span> 
            <span class="myspan"><a>Genes</a> <label class = "label2" id="stat_gene">??</label></span>
            <span class="myspan"><a>Variations</a> <label class = "label2" id="stat_var">??</label></span>
            <span class="myspan"><a>Uniq</a><label class = "label2" id="stat_dif">??</label></span>
            <!--
            <span class="myspan"><a>He</a>  <label class = "label2" id="stat_he">??</label></span>
            <span class="myspan"><a>Ho</a><label class = "label2" id="stat_ho">??</label></span>
            -->
            <span class="span_toolbar_right"><a >Filtration Level <label class = "label2" id="stat_filter_level">Variations</label></a> </span>
            <span class="span_toolbar_right"><a >Type <label class = "label2" id="stat_filtering_type">Individual</label></a></span>
            <span class="span_toolbar_right"><a >Model <label class = "label2" id="stat_filter_model">-</label></a></span>
            <span class="span_toolbar_right"><a >Annot Version </a>
	            <div jsId="dd_score" data-dojo-type="dijit.form.DropDownButton">
	                <span><label class = "label2" id="span_annot_version_option">-</label></span>
	                <div data-dojo-type="dijit.TooltipDialog" style ="font-size:10px;" id="tooltip_annot_version">
	                	<center>
	                		Use version:<br>
                        	<div data-dojo-type="dijit/DropDownMenu" id="div_dropdownmenu_annotations" jsId="div_dropdownmenu_annotations"></div>
	                    </center>
	                </div>
	            </div>
            </span>
            
            
            <div data-dojo-type="dijit/Tooltip" data-dojo-props="connectId:'span_annot_version_option',position:['below']">
				<div><span id="span_tooltip_annot_version">This is the LAST annotation version.</span></div>
			</div>
            <span><div id="lock_button"  jsId="lock_button" dojoType="dijit.form.Button" iconClass="loginIcon" onClick='relogin();' showLabel="true" style="padding-left=15px;float:right">Login</div></span>
            <!--
            <span><div id="div_check"  jsId="lock_button"style="padding-left=15px;float:right"><span class="span_toolbar_right"><a >Check <label class = "label2" id="stat_check"><img id='img_check' src='/icons/Polyicons/ajax-loader.gif' style='width:14px;heigth:14px;'/></label></a></span></div></span>
            -->
    </div>
					<!--
                        <div data-dojo-type="dijit/Tooltip" data-dojo-props="connectId:'img_check',position:['above']">
                            <span id="tooltip_span_stat_check">Checking ALL chromosomes. Finished: 0/25 chromosomes.</span>
                        </div>
					-->
    
    



    <div class="container" style="border: solid white 2px;border-style:outset;" >
        
        <div dojoType="dijit/TitlePane" id= "t1" title="Graphical View" onShow="show_graph=1;" onHide="show_graph=0" open="false">
  
                <!--<div dojotype="dijit.layout.ContentPane" id="div_viewer" layoutalign="client" style="height:200px"  title="Graphic" >
                -->
                <div dojoType="dijit.layout.BorderContainer"  style="height:400px" design="sidebar" gutters="true" liveSplitters="true" id="borderContainer" title="Graphic"  > 
            
                    <div dojoType="dijit.layout.ContentPane" splitter="false" region="bottom" style="display:none" > 
                        <span id="over" class="infoSpan" style="height:1px"> </span>
                
                    </div>
                    <div dojoType="dijit.layout.ContentPane" splitter="false" region="top"> 
                         <div  dojoType="dijit.Toolbar">

                            view specific region :
                            chr <select jsId="chr_number" name ="select" dojoType="dijit.form.Select" >                          
                                <option value="1">1</option>
                                <option value="2">2</option>
                                <option value="3">3</option>
                                <option value="4">4</option>
                                <option value="5">5</option>
                                <option value="6">6</option>
                                <option value="7">7</option>
                                <option value="8">8</option>
                                <option value="9">9</option>
                                <option value="10">10</option>
                                <option value="11">11</option>
                                <option value="12">12</option>
                                <option value="13">13</option>
                                <option value="14">14</option>
                                <option value="15">15</option>
                                <option value="16">16</option>
                                <option value="17">17</option>
                                <option value="18">18</option>
                                <option value="19">19</option>
                                <option value="20">20</option>
                                <option value="21">21</option>
                                <option value="22">22</option>
                                <option value="X">X</option>
                                <option value="Y">Y</option>
                                <option value="MT">MT</option>
                            </select>
                            <input jsId="start_number" type="text" dojoType="dijit.form.NumberTextBox" 
                        value="0" constraints="{min:-1,places:0}" 
                    invalidMessage="Invalid number." style="width: 8em;">-
                        <input jsId="end_number" type="text" dojoType="dijit.form.NumberTextBox" 
                        value="0" constraints="{min:-1,places:0}" 
                    invalidMessage="Invalid number." style="width: 8em;">
                    
                    <input dojoType="dijit.form.FilteringSelect"  
                    
                                name="name"
                                
                                jsId="filterGenes"
                                id="label"
                                labelAttr= "label"
                                onChange = "displayGeneCover();"
                                
                                 />
                                
                
                    
                            <span dojoType="dijit.ToolbarSeparator"></span> IGV Viewer 
                            <div dojoType="dijit.form.Button" iconClass="igvIcon" onClick='launch_web_igv();' showLabel="true">
                                Load 
                            </div>
                            <div dojoType="dijit.form.Button" jsId ="view_igv" iconClass="igvView" onClick='viewIGV();'  showLabel="true">
                                View
                            </div>
                            
                            <span dojoType="dijit.ToolbarSeparator">
                            </span> 
                            Zoom 
                                <div dojoType="dijit.form.Button"  iconClass="zoominIcon" onClick='zoomIn()'  showLabel="false">
                            
                            </div>
                            <div dojoType="dijit.form.Button"  iconClass="zoomoutIcon" onClick='zoomOut()'  showLabel="false">
                            
                            </div>
                            coverage : 
                            
                            <select  jsId="select_coverage" data-dojo-type="dijit.form.Select" onChange="change_coverage()">
                            <option value="cov0">0</option>
                            <option value="cov5" selected="selected">5</option>
                            <option value="cov10">10</option>
                             <option value="cov15">15</option>
                            <option value="cov20">20</option>
                            </select>
                            
                            </div>
                            <div  dojoType="dijit.Toolbar">Bip-d Tools&nbsp;
                                <input dojoType="dijit.form.ComboBox"  
                                name="name"
                                queryExpr="${0}"
                               
                                jsId="listcompletion"
                                id="listcompletion"
                                labelAttr= "label"
                                labelType="html"
                                promptMessage="Please enter a Gene name"
                                selectOnClick="true"
                                />    
                               <div dojoType="dijit.form.Button" iconClass="zoomIcon" onClick='viewGraphic();' showLabel="true">
                                Region View
                            </div>
                            <div dojoType="dijit.form.Button" iconClass="coverageIcon" onClick='show_coverage_detail();' showLabel="true">
                                Coverage View
                            </div>
                            <div dojoType="dijit.form.Button" iconClass="dejavuIcon" onClick='show_deja_vu();' showLabel="true">
                                DejaVu
                            </div>
                        
                        </div>
                
                    </div>
                    
                   <div id="right" dojoType="dijit.layout.ContentPane" splitter="true" region="center" >
                        <div id='map' style="height:35px;overflow-x:hidden;overflow-y:auto;border:1px solid #7EABCD;resize:vertical;"></div>
                        <br>
                        <div id='drawing_transcripts' style="height:115px;overflow-x:hidden;overflow-y:auto;border:1px solid #7EABCD;resize:vertical;"></div>
                        <br>
                        <div id='drawing_patients' style="height:115px;overflow-x:auto;overflow-y:auto;border:1px solid #7EABCD;resize:vertical;"></div>
                    </div>          
                </div> <!-- end div graphic accordion -->
                </div> <!-- title -->
                
             <div dojoType="dijit.TitlePane" title="Workspace" style ="padding:1px">
            <div dojotype="dijit.layout.BorderContainer" style="height:330px;padding:1px;min-width:290px;" design="sidebar" gutters="true" liveSplitters="true" id="div_chr" layoutalign="client" title="Workspace" selected="true">
              <div dojoType="dijit.layout.ContentPane"  style="width:25%;padding:1px"  data-dojo-props="splitter:true, region:'leading'">
        <div dojoType="dijit.layout.TabContainer" style="padding:1px">
        <div dojoType="dijit.layout.ContentPane" title="Chromosomes" style="padding:1px">
            <div dojoType="dijit.layout.ContentPane" region="top" style="padding:0px;height:14%" splitter="false"> 
             <div  dojoType="dijit.Toolbar">
                    <div dojoType="dijit.form.Button" iconClass="eyeIcon" onClick='viewAllChromosome();' showLabel="true">
                        Get All
                    </div>
                    <span dojoType="dijit.ToolbarSeparator"></span>
                    <button id="b_export_xls_genes" dojoType="dijit.form.Button" onClick='export_filter_by_genes()' iconClass="exportIcon" style="padding-left:3px" disabled>
                        <b>XLS</b> genes
                    </button>
                    <span dojoType="dijit.ToolbarSeparator"></span>
                    <button id="b_export_xls_var" dojoType="dijit.form.Button" onClick='export_filter_by_variations()' iconClass="exportIcon" style="padding-left:3px" disabled>
                        <b>XLS</b> variants
                    </button>  
             </div>
             
             </div>
        <div dojoType="dijit.layout.ContentPane" style="padding:1px;height:86%;width:98%" region="center" >
            <!-- <table style="border: 1px solid #9f9f9f;">
                <tr><td  style="height:auto" >
                -->
                <div  id="gridChromosome" data-dojo-type="dojox.grid.EnhancedGrid" data-dojo-props="plugins:{indirectSelection:true}, rowSelector:'0px'" style="width:100%;padding:1px;"  jsId="gridChromosome" rowcount="10000" structure="layoutChromosome"></div>
                <!--</td>
                </tr>
                </table>
                -->
            </div>
            
        </div>
                
        
        <div dojoType="dijit.layout.ContentPane" title="Regions">
       <div  dojoType="dijit.Toolbar" >
       			<center>
                        <div dojoType="dijit.form.Button" iconClass="plusIcon" onClick='addRow();' showLabel="true">
                            ADD Region(s)
                        </div>
                        <div dojoType="dijit.form.Button"  iconClass="dijitEditorIcon dijitEditorIconRemoveFormat" showLabel="true" onclick="delete_filter()"> 
                            Delete
                        </div>
                        <div dojoType="dijit.ToolbarSeparator"></div>
                        <div dojoType="dijit.form.Button" iconClass="dijitEditorIcon dijitEditorIconCreateLink" onClick='changeRegionsState(0,"include");' showLabel="true">
                            And
                            </div>
                        <div dojoType="dijit.form.Button"  iconClass="dijitEditorIcon dijitEditorIconDelete" showLabel="true" onClick='changeRegionsState(-1,"include");' > 
                            Exclude
                        </div>
                        <!--
                        <div dojoType="dijit.ToolbarSeparator"></div>
                        <div>
	                        <table>
		                        <td>
			                        <div dojoType="dijit.form.Button" iconClass="plusIcon" onClick='addBedFile();' showLabel="true">
			                            ADD BED File
			                        </div>
		                        </td>
		                        <td>
		                        	<input type="file"  id="inputBed">
		                        </td>
	                        </table>
                        </div>
                        <div dojoType="dijit.form.Button"  iconClass="dijitEditorIcon dijitEditorIconUnlink" showLabel="true" onClick='changeRegionsState(2,"include");'> 
                            Remove
                        </div>
                        -->
				</center>
            </div> <!-- END TOOLBAR -->
            
            <div id="gridRegion"  class="grid" dojoType="dojox.grid.DataGrid" jsId="gridRegion"  selectable="1" style="width=100%;height:85%;padding:1px" structure="layoutRegion"> </div>  
                     
        </div><!-- END REGION TAB -->
        
        <div dojoType="dijit.layout.ContentPane" id="title_genes" title="Genes">
       <div  dojoType="dijit.Toolbar" >
                    <div dojoType="dijit.form.Button" iconClass="plusIcon" onClick='addRowGenes();' showLabel="true">
                        Add Genes
                    </div>
                    <div dojoType="dijit.form.Button" iconClass="dijitEditorIcon dijitEditorIconDelete" onClick='deleteListGenes();' showLabel="true">
                        Delete All
                    </div>
                    <div dojoType="dijit.ToolbarSeparator"></div>
                    <div dojoType="dijit.form.Button" iconClass="coverageIcon" onClick='show_coverage_detail_multi_genes();' showLabel="true">
                        Coverage View
                    </div>
                    <div dojoType="dijit.form.Button" id="b_show_hgmd_dejavu_gene" iconClass="dijitEditorIcon dijitEditorIconSelectAll" onClick='showHgmdDejaVu_genes();' showLabel="true">
                         HGMD DejaVu
                    </div>
            </div> <!-- END TOOLBAR -->
            
            <div id="gridGenesUser"  class="grid" dojoType="dojox.grid.DataGrid" jsId="gridGenesUser"  selectable="1" style="width=100%;height:85%;padding:1px" structure="layoutGridGenesUser"> </div>  
                     
        </div><!-- END REGION TAB -->
        
          <!--<div dojoType="dijit.layout.ContentPane" title="Diseases"  style="display: hidden">
            <div id="tree_gene_atlas">
            </div>
          </div>-->  

                
                <div dojoType="dijit.layout.ContentPane" title="Save/Load Filters">
                   <table  style="border: 1px solid #9f9f9f;width:100%;height:100%" cellspacing="0">
                        <tr><td style="width:100%;height:15%"> 
                            <div id="toolbar1" dojoType="dijit.Toolbar">
                                <div dojoType="dijit.form.Button" id="toolbar1.copy" iconClass="dijitEditorIcon dijitEditorIconSelectAll" onClick='viewFilter(this);' showLabel="true">
                                     Load Filter
                                </div>
                            <div dojoType="dijit.form.Button" id="toolbar1.cut" iconClass="dijitEditorIcon dijitEditorIconSave" showLabel="true" onClick='showFilter();'> 
                                Save
                            </div>
       
                            <div dojoType="dijit.form.Button" id="toolbar1.paste" iconClass="dijitEditorIcon dijitEditorIconRemoveFormat" showLabel="true" onClick='deleteFilter();'>
                                Delete
                            </div>
                            
                            </div> 
                        </td></tr>  
                
                        <tr><td style="width:100%;height:85%"> 
                            <div  style="width:100%;height:100%" id="gridFilter" selectable="1" dojoType="dojox.grid.DataGrid" jsId="gridFilter" rowcount="10" structure="layoutFilter">
                            </div>
                        </td></tr>  

                    </table>
                </div>  
            </div>
                
        
              </div> <!-- end div grid chromosome -->

              <div dojoType="dijit.layout.ContentPane" style="padding:0px;" data-dojo-props="splitter:true, region:'center'">
              
              <div dojoType="dijit.layout.BorderContainer" style="padding:5px;">
                 <div dojoType="dijit.layout.ContentPane" id="content_pane_pat_fam" style="padding:0px;box-shadow: #B3B3B3 3px 3px 2px;" data-dojo-props="splitter:true, region:'top'"  >
                 
                        <div  dojoType="dijit.Toolbar" id="toolbar_1" style ="font-size : 10px;">
                                
                    <span>Filter </span>
                            <span dojoType="dijit.ToolbarSeparator">
                            </span>
                            <div dojoType="dijit.form.Button" iconClass="dijitEditorIcon dijitEditorIconCreateLink" onClick='changePatientsState(0,"include");' showLabel="true">
                                Intersect
                            </div>
                        <div dojoType="dijit.form.Button"  iconClass="dijitEditorIcon dijitEditorIconDelete" showLabel="true" onClick='changePatientsState(-1,"include");'> 
                            Exclude
                        </div>
   
                        <div dojoType="dijit.form.Button"  iconClass="dijitEditorIcon dijitEditorIconUnlink" showLabel="true" onClick='changePatientsState(1,"include");'>
                            Or
                        </div>
                        <div dojoType="dijit.form.Button"  iconClass="trashIcon" showLabel="true" onClick='changePatientsState(2,"include");'>
                            In The Attic
                        </div>
                        
                        <span dojoType="dijit.ToolbarSeparator"></span>
                        <span>&nbsp; At Least </span> 
                        <input id="filter_identical_number" jsId="filter_identical_number" type="text" dojoType="dijit.form.NumberTextBox" value="" constraints="{min:-1,max:999,places:0}"  invalidMessage="Invalid number." style="width:18px;"/>
                        <span id='at_least_var_text'>Pat</span> 
                        <span dojoType="dijit.ToolbarSeparator"></span>
                </span>
            
                
            
                <div data-dojo-type="dijit/form/DropDownButton" id="drop_type_filter" data-dojo-props="iconClass:'individualIcon'"> 
                    <span>Individual</span> 
                                        
                <div data-dojo-type="dijit/DropDownMenu" >
                    <div data-dojo-type="dijit/MenuItem" data-dojo-props="iconClass:'individualIcon24'" onClick="change_filtering_type('ind')">
                        Individual
                    </div>
                    <div data-dojo-type="dijit/MenuSeparator"></div>
                    <div data-dojo-type="dijit/MenuItem" data-dojo-props="iconClass:'familyIcon24'" onClick="change_filtering_type('fam')" id="button_fam_model" disabled>
                        Familial
                    </div>
                    <div data-dojo-type="dijit/MenuSeparator"></div>
                    <div data-dojo-type="dijit/MenuItem" data-dojo-props="iconClass:'individualIcon24'" onClick="change_filtering_type('somatic')" id="button_somatic_model" disabled>
                        Somatic
                    </div>
                </div>
                </div>
                <span dojoType="dijit.ToolbarSeparator">
                        </span>
                <span id="div_select_model_families" hidden>
                <div id="drop_type_model_families"  data-dojo-type="dijit/form/DropDownButton" data-dojo-props="iconClass:'treeIcon32nb'" > 
                    <span>Genetic Model (-)</span>  
                    <div data-dojo-type="dijit/DropDownMenu" style="font-size:12px">
                        <div data-dojo-type="dijit/MenuItem"  onClick="change_filtering_model('None')">None</div>
                        <div data-dojo-type="dijit/MenuSeparator"></div>
                        <div data-dojo-type="dijit/MenuItem" data-dojo-props="iconClass:'treeIcon32'" onClick="change_filtering_model('recessif')" id='b_fam_recessif' disabled>
                            Recessif &nbsp;&nbsp;&nbsp;<img id='help_models_fam_recessif' src="../images/menu/help_2.png" margin-bottom="inherit"/>
                        </div>
                        <div data-dojo-type="dijit/Tooltip" data-dojo-props="connectId:'help_models_fam_recessif',position:['above']">
                            <span>
                                <b>Variations :</b><br>
                                &nbsp;&nbsp;-&nbsp;Ho in affected children<br>
                                &nbsp;&nbsp;-&nbsp;He or Not Found in non affected children<br>
                            </span>
                        </div>
                        <!--
                        <div data-dojo-type="dijit/MenuSeparator"></div>
                        <div data-dojo-type="dijit/MenuItem" data-dojo-props="iconClass:'treeIcon32'" onClick="change_filtering_model('compound')" id='b_fam_compound' disabled>
                            Compound &nbsp;&nbsp;
                            <img  style="padding-left:2px;" id='help_models_fam_compound' src="../images/menu/help_2.png" margin-bottom="inherit"/>
                        </div>
                        <div data-dojo-type="dijit/Tooltip" data-dojo-props="connectId:'help_models_fam_compound',position:['above']">
                            <span>
                                <b>Genes :</b><br>
                                &nbsp;&nbsp;-&nbsp;with 2+ He variations in affected children<br>
                                &nbsp;&nbsp;-&nbsp;never found in non affected children<br>
                                &nbsp;&nbsp;-&nbsp;never found in ALL parents in a same variation<br>
                                &nbsp;&nbsp;-&nbsp;with 1+ in father but not in mother<br>
                                &nbsp;&nbsp;-&nbsp;with 1+ in mother but not in father<br>
                            </span>
                        </div>
                        -->
                        <div data-dojo-type="dijit/MenuSeparator"></div>
                        <div data-dojo-type="dijit/MenuItem" data-dojo-props="iconClass:'treeIcon32'" onClick="change_filtering_model('compound_multi')" id='b_fam_compound_multi' disabled>
                            Compound&nbsp;&nbsp;
                            <img  style="padding-left:2px;" id='help_models_fam_compound_multi' src="../images/menu/help_2.png" margin-bottom="inherit"/>
                        </div>
                        <div data-dojo-type="dijit/Tooltip" data-dojo-props="connectId:'help_models_fam_compound_multi',position:['above']">
                            <span>
                                <b>Genes :</b><br>
                                &nbsp;&nbsp;-&nbsp;with 2+ He variations in affected children<br>
                                &nbsp;&nbsp;-&nbsp;never found in non affected children<br>
                                &nbsp;&nbsp;-&nbsp;never found in ALL parents in a same variation<br>
                                &nbsp;&nbsp;-&nbsp;with 1+ in father but not in mother<br>
                                &nbsp;&nbsp;-&nbsp;with 1+ in mother but not in father<br>
                            </span>
                        </div>
                        <!--
                        <div data-dojo-type="dijit/MenuSeparator"></div>
                        <div data-dojo-type="dijit/MenuItem" data-dojo-props="iconClass:'treeIcon32'" onClick="change_filtering_model('recessif_compound')" id='b_fam_recessif_compound' disabled>
                            Recessif OR Compound &nbsp;&nbsp;
                            <img style="padding-left:2px" id='help_models_fam_recessif_compound' src="../images/menu/help_2.png" margin-bottom="inherit"/>
                        </div>
                        <div data-dojo-type="dijit/Tooltip" data-dojo-props="connectId:'help_models_fam_recessif_compound',position:['above']">
                            <span>
                                <b>Variations :</b><br>
                                &nbsp;&nbsp;-&nbsp;pass Recessif Model <b>OR</b><br>
                                &nbsp;&nbsp;-&nbsp;pass Compound Model
                            </span>
                        </div>
						-->
                        <div data-dojo-type="dijit/MenuSeparator"></div>
                        <div data-dojo-type="dijit/MenuItem" data-dojo-props="iconClass:'treeIcon32'" onClick="change_filtering_model('recessif_compound_multi')" id='b_fam_recessif_compound_multi' disabled>
                            Recessif OR Compound&nbsp;&nbsp;
                            <img style="padding-left:2px" id='help_models_fam_recessif_compound_multi' src="../images/menu/help_2.png" margin-bottom="inherit"/>
                        </div>
                        <div data-dojo-type="dijit/Tooltip" data-dojo-props="connectId:'help_models_fam_recessif_compound_multi',position:['above']">
                            <span>
                                <b>Variations :</b><br>
                                &nbsp;&nbsp;-&nbsp;pass Recessif Model <b>OR</b><br>
                                &nbsp;&nbsp;-&nbsp;pass Compound Model
                            </span>
                        </div>
                        
                        <div data-dojo-type="dijit/MenuSeparator"></div>
                        <div data-dojo-type="dijit/MenuItem" data-dojo-props="iconClass:'treeIcon32'" onClick="change_filtering_model('uniparental_recessif_compound_multi')" id='b_fam_uniparental_recessif_compound_multi'>
                            Recessif OR Compound OR Uniparental Disomy&nbsp;&nbsp;
                            <img style="padding-left:2px" id='help_models_fam_uniparental_recessif_compound_multi' src="../images/menu/help_2.png" margin-bottom="inherit"/>
                        </div>
                        <div data-dojo-type="dijit/Tooltip" data-dojo-props="connectId:'help_models_fam_uniparental_recessif_compound_multi',position:['above']">
                            <span>
                                <b>Variations :</b><br>
                                &nbsp;&nbsp;-&nbsp;pass Recessif Model <b>OR</b><br>
                                &nbsp;&nbsp;-&nbsp;pass Compound Model <b>OR</b><br>
                                &nbsp;&nbsp;-&nbsp;pass Uniparental Disomy Model
                            </span>
                        </div>

                        <div data-dojo-type="dijit/MenuSeparator"></div>
                        <div data-dojo-type="dijit/MenuItem" data-dojo-props="iconClass:'treeIcon32'" onClick="change_filtering_model('denovo')" id='b_fam_denovo' disabled>
                            Denovo &nbsp;&nbsp;&nbsp;<img id='help_models_fam_denovo' src="../images/menu/help_2.png" margin-bottom="inherit"/>
                        </div>
                        <div data-dojo-type="dijit/Tooltip" data-dojo-props="connectId:'help_models_fam_denovo',position:['above']">
                            <span>
                                <b>Variations :</b><br>
                                &nbsp;&nbsp;-&nbsp;found in affected children<br>
                                &nbsp;&nbsp;-&nbsp;never found in non affected patients
                                <br>
                                <b>OR</b>
                                <br>
                                &nbsp;&nbsp;-&nbsp;HO in each parent<br>
                                &nbsp;&nbsp;-&nbsp;HE in affected children
                            </span>
                        </div>
                        <div data-dojo-type="dijit/MenuSeparator"></div>
                        <div data-dojo-type="dijit/MenuItem" data-dojo-props="iconClass:'treeIcon32'" onClick="change_filtering_model('strict-denovo')" id='b_fam_strict_denovo'>
                            Strict-denovo &nbsp;&nbsp;&nbsp;<img id='help_models_fam_strictdenovo' src="../images/menu/help_2.png" margin-bottom="inherit"/>
                        </div>
                        <div data-dojo-type="dijit/Tooltip" data-dojo-props="connectId:'help_models_fam_strictdenovo',position:['above']">
                            <span>
                                <b>Variations :</b><br>
                                &nbsp;&nbsp;-&nbsp;found in affected children<br>
                                &nbsp;&nbsp;-&nbsp;never found in non affected patients
                            </span>
                        </div>
                        <div data-dojo-type="dijit/MenuSeparator"></div>
                        <div data-dojo-type="dijit/MenuItem" data-dojo-props="iconClass:'treeIcon32'"  onClick="change_filtering_model('dominant')" id='b_fam_dominant' disabled="">
                            Dominant &nbsp;&nbsp;&nbsp;<img id='help_models_fam_dominant' src="../images/menu/help_2.png" margin-bottom="inherit"/>
                        </div>
                        <div data-dojo-type="dijit/Tooltip" data-dojo-props="connectId:'help_models_fam_dominant',position:['above']">
                            <span>
                                <b>Variations :</b><br>
                                &nbsp;&nbsp;-&nbsp;found in affected children<br>
                                &nbsp;&nbsp;-&nbsp;never found in non affected patients
                            </span>
                        </div>
                        <div data-dojo-type="dijit/MenuSeparator"></div>
                        <div data-dojo-type="dijit/MenuItem" data-dojo-props="iconClass:'treeIcon32'"  onClick="change_filtering_model('mosaic')" id='b_fam_mosaic' disabled="">
                            Mosaic Transmission &nbsp;&nbsp;&nbsp;<img id='help_models_fam_mosaic' src="../images/menu/help_2.png" margin-bottom="inherit"/>
                        </div>
                        <div data-dojo-type="dijit/Tooltip" data-dojo-props="connectId:'help_models_fam_mosaic',position:['above']">
                            <span>
                            </span>
                        </div>
                        <div data-dojo-type="dijit/MenuSeparator"></div>
                        <!--
                        <div data-dojo-type="dijit/MenuItem" data-dojo-props="iconClass:'treeIcon32'"  onClick="change_filtering_model('incomplete_penetrance')" id='b_fam_incomplete_penetrance' disabled="">
                            Incomplete Penetrance &nbsp;&nbsp;&nbsp;<img id='help_models_fam_incomplete_penetrance' src="../images/menu/help_2.png" margin-bottom="inherit"/>
                        </div>
                        <div data-dojo-type="dijit/Tooltip" data-dojo-props="connectId:'help_models_fam_incomplete_penetrance',position:['above']">
                            <span>
                            	<b>Used for families with :</b><br>
                            	&nbsp;&nbsp;-&nbsp;at least, 1 patient with status ill<br>
                            	&nbsp;&nbsp;-&nbsp;2 parents with status healthy<br>
                            	<br>
                                <b>Variations :</b><br>
                                &nbsp;&nbsp;found in affected children AND found in mother AND NOT found in father<br>
                                &nbsp;&nbsp;+&nbsp;found in affected children AND NOT found in mother AND found in father
                            </span>
                        </div>
                        -->
                        <div data-dojo-type="dijit/MenuSeparator" hidden></div>
                        <div data-dojo-type="dijit/MenuItem" data-dojo-props="iconClass:'treeIcon32'" onClick="change_filtering_model('uniparental_disomy')" id='b_fam_uniparental_disomy' disabled="" >
                            Uniparental Disomy &nbsp;&nbsp;&nbsp;<img id='help_models_fam_no_model' src="../images/menu/help_2.png" margin-bottom="inherit"/>
                        </div>
                        <div data-dojo-type="dijit/Tooltip" data-dojo-props="connectId:'help_models_fam_no_model',position:['above']">
                            <span>
                                <b>Variations :</b><br>
                                &nbsp;&nbsp;-&nbsp;found HO in ill children<br>
                                &nbsp;&nbsp;-&nbsp;found HE only in 1 parent and max 2 reads found with var_allele
                            </span>
                        </div>
                    </div>
                </div>
                </span>
                <span id="div_select_model_individual">
                <div id="drop_type_model_individual"  data-dojo-type="dijit/form/DropDownButton" data-dojo-props="iconClass:'oneIconnb'">   
                    <span>Genetic Model (-)</span>          
                    <div data-dojo-type="dijit/DropDownMenu" style="font-size:12px">
                        <div data-dojo-type="dijit/MenuItem"  onClick="change_filtering_model('None')">None</div>
                        <div data-dojo-type="dijit/MenuSeparator"></div>
                        <div data-dojo-type="dijit/MenuItem" data-dojo-props="iconClass:'oneIcon'" onClick="change_filtering_model('recessif')">
                            Recessif &nbsp;&nbsp;&nbsp;<img id='help_models_ind_recessif' src="../images/menu/help_2.png" margin-bottom="inherit"/> 
                        </div>
                        <div data-dojo-type="dijit/Tooltip" data-dojo-props="connectId:'help_models_ind_recessif',position:['above']">
                            <span>
                                <b>Genes :</b><br>
                                &nbsp;&nbsp;-&nbsp;with 2+ variations He <b>OR</b><br>
                                &nbsp;&nbsp;-&nbsp;with 1+ variations Ho
                            </span>
                        </div>
                        <div data-dojo-type="dijit/MenuSeparator"></div>
                        <div data-dojo-type="dijit/MenuItem" data-dojo-props="iconClass:'oneIcon'" onClick="change_filtering_model('compound')">
                            Compound &nbsp;&nbsp;
                            <span hidden><input type="checkbox" id="ind_compound_multi_filters"> Multi Annot</span>
                            <img id='help_models_ind_compound' src="../images/menu/help_2.png" margin-bottom="inherit"/>
                        </div>
                        <div data-dojo-type="dijit/Tooltip" data-dojo-props="connectId:'help_models_ind_compound',position:['above']">
                            <span>
                                <b>Genes :</b><br>
                                &nbsp;&nbsp;-&nbsp;with 2+ variations He
                            </span>
                        </div>
                    </div>
                </div>
                </span>
                <span id="div_select_model_somatic" hidden>
                <div id="drop_type_model_somatic"  data-dojo-type="dijit/form/DropDownButton" data-dojo-props="iconClass:'treeIcon32nb'">   
                    <span>Genetic Model (-)</span>          
                    <div data-dojo-type="dijit/DropDownMenu" style="font-size:12px">
                        <div data-dojo-type="dijit/MenuItem"  onClick="change_filtering_model('None')">None</div>
                        <div data-dojo-type="dijit/MenuSeparator"></div>
                        <div data-dojo-type="dijit/MenuItem" data-dojo-props="iconClass:'treeIcon32'" onClick="change_filtering_model('dbl_evt')">
                            Dbl Evt &nbsp;&nbsp;&nbsp;<img id='help_models_som_dblevt' src="../images/menu/help_2.png" margin-bottom="inherit"/>
                        </div>
                        <div data-dojo-type="dijit/Tooltip" data-dojo-props="connectId:'help_models_som_dblevt',position:['above']">
                            <span><b>Variations :</b></span>
                        </div>
                        <div data-dojo-type="dijit/MenuSeparator"></div>
                        <div data-dojo-type="dijit/MenuItem" data-dojo-props="iconClass:'treeIcon32'" onClick="change_filtering_model('loh')">
                            Loh &nbsp;&nbsp;&nbsp;<img id='help_models_som_loh' src="../images/menu/help_2.png" margin-bottom="inherit"/>
                        </div>
                        <div data-dojo-type="dijit/Tooltip" data-dojo-props="connectId:'help_models_som_loh',position:['above']">
                            <span><b>Variations :</b></span>
                        </div>
                        <div data-dojo-type="dijit/MenuSeparator"></div>
                        <div data-dojo-type="dijit/MenuItem" data-dojo-props="iconClass:'treeIcon32'" onClick="change_filtering_model('only_tissues_somatic')">
                            Only in tissues somatics &nbsp;&nbsp;&nbsp;<img id='help_models_som_only_tissues_somatic' src="../images/menu/help_2.png" margin-bottom="inherit"/>
                        </div>
                        <div data-dojo-type="dijit/Tooltip" data-dojo-props="connectId:'help_models_som_only_tissues_somatic',position:['above']">
                            <span><b>Variations found in patients somatics and not in germinals</b></span>
                        </div>
                        
                    </div>
                </div>
                </span>
                
                
                    </div>
                    
                 </div>
                 <div dojoType="dijit.layout.ContentPane" id="content_pane_pat" style="border-color:#73C8A9;padding:0px; box-shadow: #B3B3B3 3px 3px 2px;width=610px;" data-dojo-props="splitter:true, region:'center'"  > 
            <div dojoType="dijit.layout.BorderContainer" jsId="border_individual" id="border_individual"  style="padding:2px;">
                <div dojoType="dijit.layout.ContentPane" region="top" style="padding:0px; " splitter="false"> 
                    <div  dojoType="dijit.Toolbar" jsId="toolbar_patients" id="toolbar_patients" style ="font-size : 9px;padding:0px;">
                        <img src="../images/polyicons/man-icon24.png" style="vertical-align:middle" height="20" width="20"/>
                        
                        <span dojoType="dijit.ToolbarSeparator">
                        </span>
                        <div dojoType="dijit.form.Button"  iconClass="dijitEditorIcon dijitEditorIconDelete" showLabel="true" onClick='changePatientsState(1,"filter_heho");'>
                            Homozygous
                        </div>
                        <div dojoType="dijit.form.Button"  iconClass="dijitEditorIcon dijitEditorIconDelete" showLabel="true" onClick='changePatientsState(0,"filter_heho");'>
                            Heterozygous
                        </div>
                            <span dojoType="dijit.ToolbarSeparator">
                            </span>
                        <div dojoType="dijit.form.Button"  iconClass="plusIcon" showLabel="true" onClick='changePatientsState(-1,"filter_heho");'>
                            Add All
                        </div>
                        
                        <span dojoType="dijit.ToolbarSeparator">
                        </span>
                        <div dojoType="dijit.form.Button" id='b_view_all_pat' iconClass="refreshIcon" showLabel="true" onClick="view_all_in_attic()">
                            View ALL
                        </div>
                        <button jsId="button_hide_attic" dojoType="dijit.form.ToggleButton" checked="false" label="Hide attic" iconClass="dijitRadioIcon" onChange="hide_attic();">
                        </button>
                         
                        <span dojoType="dijit.ToolbarSeparator">
                        </span>
                        <div id="select_individual_type_ind" data-dojo-type="dijit/form/DropDownButton" data-dojo-props="iconClass:'variationIcon'">    
                            <span>Variation</span>  
                            <div data-dojo-type="dijit/DropDownMenu" >
                                <div data-dojo-type="dijit/MenuItem" data-dojo-props="iconClass:'variationIcon'" onClick="change_filtering_level_ind('variation')">Variation</div>
                                <div data-dojo-type="dijit/MenuItem" data-dojo-props="iconClass:'geneIcon'" onClick="change_filtering_level_ind('gene')">Genes</div>
                            </div>
                        </div>
                        <span dojoType="dijit.ToolbarSeparator"></span>
                        <button id="b_export_xls_vcf" dojoType="dijit.form.Button" onClick='exportVcf()' style="padding-right:2px" disabled>
                            <span><img id='img_vcf' src="../images/polyicons/vcf.png" style="width:16px;height:16px;"></span>
                            <span>VCF</span>
                        </button> 
                        <span dojoType="dijit.ToolbarSeparator"></span>
                        <div dojoType="dijit.form.Button" id="b_show_hgmd_dejavu_patient" iconClass="dijitEditorIcon dijitEditorIconSelectAll" onClick='showHgmdDejaVu_patients();' showLabel="true">
                             HGMD DejaVu
                        </div>
                        <!--
                        <div dojoType="dijit.form.Button" id="b_show_polydiag_patient" iconClass="dijitEditorIcon dijitEditorIconSelectAll" onClick='showPopupDiag();' showLabel="true">
                             PolyDiag
                        </div>
                        -->
                    </div> <!-- END TOOLBAR -->     
                </div> <!-- END TOP --> 
                    <div dojoType="dijit.layout.ContentPane"  jsId="PanePatient" id="PanePatient" style="padding-right:3px;width:98%;" design="sidebar" gutters="true" liveSplitters="true" region="leading" splitter="false">
                        
                        <div id="gridPatient"  dojoType="dojox.grid.DataGrid" selectable="1" jsId="gridPatient" rowcount="10000" style="width:100%;height:100%;" structure="layoutPatient">
                        </div>
                        
                    
                    </div>  
                </div>
            </div>  <!-- end div grid Patient -->
            

                <div dojoType="dijit.layout.ContentPane" id="PaneFamilies" jsId="PaneFamilies" style="box-shadow: #B3B3B3 3px 3px 2px;width:350px;padding:2px" id="resume_filter"   data-dojo-props="splitter:true, region:'trailing'" >
                    <div dojoType="dijit.layout.BorderContainer" style="padding:0px;width:100%">
                        <div dojoType="dijit.layout.ContentPane" region="top" style="padding:0px;width:100%;" splitter="false"> 
                            <div  dojoType="dijit.Toolbar"  jsId="toolbar_families" id="toolbar_families" style ="font-size : 9px">
                                <img src="../images/polyicons/family-on.png" style="vertical-align:middle" height="20" width="20"/>
                                <span dojoType="dijit.ToolbarSeparator"></span>
                                <div id="select_individual_type_fam" data-dojo-type="dijit/form/DropDownButton" data-dojo-props="iconClass:'variationIcon'">    
                                    <span>Variation</span>  
                                    <div data-dojo-type="dijit/DropDownMenu" >
                                        <div data-dojo-type="dijit/MenuItem" data-dojo-props="iconClass:'variationIcon'" onClick="change_filtering_level_fam('variation')">Variation</div>
                                        <div data-dojo-type="dijit/MenuItem" data-dojo-props="iconClass:'geneIcon'" onClick="change_filtering_level_fam('gene')">Genes</div>
                                    </div>
                                </div>
                                <!--
                                <span dojoType="dijit.ToolbarSeparator"></span>
                                <span>
                                    <button id="b_edit_group" dojoType="dijit.form.Button" onClick='edit_group()'>
                                        <span><img id='img_groups' src="../images/polyicons/edit-icon.png" style="width:16px;height:16px;"></span>
                                        <span>Edit <b>Fam / Gr.</b></span>
                                    </button>
                                </span>
                                -->
                            </div><!-- end toolbar famille -->
                         </div>
                         <div   dojoType="dijit.layout.ContentPane" region="center" style="padding:3px;width:100%;" splitter="false"> 
                             <div dojoType="dijit.layout.TabContainer" style="padding:1px">
                                <div dojoType="dijit.layout.ContentPane" title="Families" id="div_stats_fam" style="padding:1px">
                                    <div id="gridFamilies" dojoType="dojox.grid.DataGrid" selectable="1" jsId="gridFamilies" structure="layoutFamilies" style="width:100%"></div>
                                </div>
                                <div dojoType="dijit.layout.ContentPane" title="Groups" id="div_stats_groups" style="padding:1px" disabled>
                                    <div id="gridGroups" dojoType="dojox.grid.DataGrid" selectable="1" jsId="gridGroups" structure="layoutGroups" style="width:100%"></div>
                                </div>
                            </div>
                         </div>
            </div><!--  end div families -->
            </div><!--  end div families + individual -->
        </div>
        </div>
        </div>
        </div><!-- end div Accordion workspace -->
        <!--</div> end div Accordion !!!!! -->

    <div dojoType="dijit.TitlePane"  title="Main Filters" open="true" style="height:auto">
        <div dojoType="dijit.layout.ContentPane" region="top" style="padding:0px; box-shadow: 1px 0 1px rgba(0, 0, 0, 1);" splitter="false">
            <div  dojoType="dijit.Toolbar" style ="font-size : 9px;">
                <center>
                <table>
                    <td style="padding-left:10px;"> 
                        <div><span class="filterLabelActif2" id="span_db_public_gnomad_ac"><span style='color:red;'>DB Public</span> / gnomAD AC</div>
                        <br>
                        <div>
                            <table align="center" valign="center">
                                <td><img id='help_db_public' src="../images/menu/help_2.png" margin-bottom="inherit"/></td>
                            </table>
                        </div>
                        <div data-dojo-type="dijit/Tooltip" data-dojo-props="connectId:'help_db_public',position:['above']">
                            Check each frequence variantion in DB Public databases (<b>dbSnp</b>, <b>1000 genomes</b>, <b>Evs</b>, <b>Exac</b>, and <b>gnomAD</b>).<br><br>
                            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span><b>Clinical:      </b> get variants indexed with a associated phenotype.</span><br>
                            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span><b>No Freq:       </b> get variants indexed into theses databases but without frequence.</span><br>
                            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span><b>None:          </b> get variants not indexed into theses databases.</span><br>
                            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span><b><font color="#EA3434">&#10877; 1&#8241;</font>:    </b> get variants indexed into theses databases with a frequence less-than or slanted equal to 0,0001.</span><br>
                            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span><b><font color="#EA3434">&#10877; 1&#8240;</font>:          </b> get variants indexed into theses databases with a frequence less-than or slanted equal to 0,001.</span><br>
                            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span><b><font color="#EAA134">&#10877; 1&#37;</font>:          </b> get variants indexed into theses databases with a frequence less-than or slanted equal to 0,01.</span><br>
                            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span><b><font color="#EACC34">&#10877; 5&#37;</font>:          </b> get variants indexed into theses databases with a frequence less-than or slanted equal to 0,05.</span><br>
                            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span><b><font color="#28A24C">All</font>:           </b> get all variants indexed into theses databases if a frequence is available.</span><br>
                        </div>
                    </td>
                    <td>
                        <!-- DB public -->
                        <div jsId="dd_db_public" data-dojo-type="dijit.form.DropDownButton" id="drop_db_public_gnomad" data-dojo-props="iconClass:'dijitIconFilter'">
                            <span>Options (All)</span>
                            <div data-dojo-type="dijit.TooltipDialog" onHide='update_choice_filter()' >
                                <div  dojoType="dijit.Toolbar" style ="font-size : 10px;">
                                    <table style="border:1px solid #9f9f9f;">
                                        <td style="padding:5px;"><input type="checkbox" id="use_db_freq_gnomad_ac" onClick="update_slider_db_freq_or_gnomac_ac()" data-dojo-type="dojox/mobile/Switch" value="on" leftLabel="Use gnomAD AC" rightLabel="Use DB Freq" style="width:90px;"></td>
                                        <td style="padding:5px;"><input type="checkbox" id="filter_clinical" data-dojo-type="dojox/mobile/Switch" value="on" leftLabel="Clinical" rightLabel="Clinical" style="width:65px;"></td>
                                        <td style="padding:5px;"><input type="checkbox" id="filter_hgmd_dm" data-dojo-type="dojox/mobile/Switch" value="on" leftLabel="HGMD DM" rightLabel="HGMD DM" style="width:85px;"></td>
                                        <td style="padding:5px;display:none;"><input type="checkbox" id="filter_nofreq" data-dojo-type="dojox/mobile/Switch" value="off"  leftLabel="No Freq" rightLabel="No Freq" style="width: 65px;"></td>
                                        <td style="padding:5px;display:none;"><input type="checkbox" onmouseleave="checkSomaticButton('filter_not_cosmic')" id="filter_not_cosmic" data-dojo-type="dojox/mobile/Switch" value="on"  leftLabel="Not Cosmic" rightLabel="Not Cosmic" style="width: 90px;"></td>
                                        <td style="padding:5px;display:none;"><input type="checkbox" onmouseleave="checkSomaticButton('filter_cosmic')" id="filter_cosmic" data-dojo-type="dojox/mobile/Switch" value="on"  leftLabel="In Cosmic" rightLabel="In Cosmic" style="width: 90px;"></td>
                                    </table>
                                </div>
                            </div>
                        </div>
                        <br>
                        <div>
                            <table align="center" valign="center">
                                <td id="td_slider_frequence">
                                    <div id="slider_frequence" jsId="slider_frequence" onChange="check_slider_frequence_2" data-dojo-type="dijit/form/HorizontalSlider" aria-label="slider 3" data-dojo-props='name:"horizontal2",minimum:1,value:1,maximum:5,discreteValues:5,showButtons:false,intermediateChanges:true,slideDuration:0,style:"width:150px; height: 25px;"'>
                                        <div data-dojo-type="dijit/form/HorizontalRule" data-dojo-props='container:"bottomDecoration", count:5, style:{height:"5px"}'> </div>
                                        <ol data-dojo-type="dijit/form/HorizontalRuleLabels" data-dojo-props='container:"bottomDecoration", style:{height:"1em", fontSize:"100%"}'>
                                            <li><font color="#EA3434">&#10877;1&#8241;</font></li>
                                            <li><font color="#EA3434">&#10877;1&#8240;</font></li>
                                            <li><font color="#EAA134">&#10877;1&#37;</font></li>
                                            <li><font color="#EACC34">&#10877;5&#37;</font></li>
                                            <li><font color="#28A24C">All</font></li>
                                        </ol>
                                    </div>
                                </td>
                                <td id="td_slider_gnomad_ac" hidden>
                                	<div id="slider_gnomad_ac" jsId="slider_gnomad_ac" data-dojo-type="dijit/form/HorizontalSlider" aria-label="slider 3" data-dojo-props='name:"horizontal2",minimum:1,value:2,maximum:6,discreteValues:6,showButtons:false,intermediateChanges:true,slideDuration:0,style:"width:150px; height: 10px;"'>
						                <div data-dojo-type="dijit/form/HorizontalRule" data-dojo-props='container:"bottomDecoration", count:6, style:{height:"5px"}'> </div>
						                <ol data-dojo-type="dijit/form/HorizontalRuleLabels" data-dojo-props='container:"bottomDecoration", style:{height:"1em", fontSize:"75%"}'>
						                    <li>5</li>
						                    <li>10</li>
						                    <li>20</li>
						                    <li>50</li>
						                    <li>100</li>
						                    <li>All</li>
						                </ol>
					                </div>
                                </td>
                            </table>
                        </div>
                    </td>
                    <td style="padding-left: 10px"> 
                        <div><span class="filterLabelActif2">Check Deja Vu</span></div>
                        <br>
                        <div>
                            <table align="center" valign="center">
                                <td><img id='help_dejavu' src="../images/menu/help_2.png" margin-bottom="inherit"/></td>
                            </table>
                        </div>
                        <div data-dojo-type="dijit/Tooltip" data-dojo-props="connectId:'help_dejavu',position:['above']">
                            <b>Examples :</b>
                            <br><br>
                            <span><b>0 + <font color="#28A24C">Ho/He</font>:</b> Only keep variants of this project never found on OTHERS projects.</span>
                            <br>
                            <span><b>10 + <font color="#28A24C">He/He</font>:</b> Keep variants of this project but found in 10 (or less) OTHERS projects too.</span>
                            <br><br>
                            <span><b>0 + <font color="#EA3434">Only Ho</font>:</b> Only keep Ho variants of this project, but never foud Ho on others projects (can be found He in OTHER projects).</span>
                            <br>
                            <span><b>10 + <font color="#EA3434">Only Ho</font>:</b> Keep variants of this project but found in 10 (or less) OTHERS projects Ho too (can be found He in 10+ OTHERS projects).</span>
                            <br><br>
                            <span>Last DEJAVU update for this project: <b><span id="info_dejavu_2"---</span></b></span>
                        </div>
                  </td>
                   <td>
                        <div id="slider_dejavu" jsId="slider_dejavu" onChange="check_slider_dejavu()" data-dojo-type="dijit/form/HorizontalSlider" aria-label="slider 3" data-dojo-props='name:"horizontal2",minimum:0,value:100,maximum:100,discreteValues:100,showButtons:false,intermediateChanges:true,slideDuration:0,style:"width:230px; height: 25px;margin-left:20px;"' >
                            <div>
                                <div data-dojo-type="dijit/form/HorizontalRule" data-dojo-props='container:"bottomDecoration", count:11, style:{height:"5px"}'> </div>
                                <ol data-dojo-type="dijit/form/HorizontalRuleLabels" data-dojo-props='container:"bottomDecoration", style:{height:"1em", fontSize:"100%"}'>
                                    <li><span><font color="#EA3434">0</font></span></li>
                                    <li><span><font color="#EA3434">10</font></span></li>
                                    <li><span><font color="#EAA134">20</font></span></li>
                                    <li><span><font color="#EAA134">30</font></span></li>
                                    <li><span><font color="#EACC34">40</font></span></li>
                                    <li><span><font color="#EACC34">50</font></span></li>
                                    <li><span><font color="#28A24C">60</font></span></li>
                                    <li><span><font color="#28A24C">70</font></span></li>
                                    <li><span><font color="#28A24C">80</font></span></li>
                                    <li><span><font color="#28A24C">90</font></span></li>
                                    <li><span id="nb_projects"/></li>
                                </ol>
                                <ol data-dojo-type="dijit/form/HorizontalRuleLabels" data-dojo-props="container: 'topDecoration'" style="height: 1.3em;">
                                    <li><font color="#EA3434"><span><i>None</i></span></font></li>
                                    <li><span id="text_dejavu"><i><b>Others</b> Projects: </i></span><span style="font-weight: bold;color: #28A24C" id ="nb_dejavu"></li>
                                    <li><font color="#28A24C"><span><i>All</i></span></font></li>
                                </ol>
                            </div>
                        </div>
                    </td>
                    <td style="padding-left: 10px;">
                        <div>
                            <input type="checkbox" id="dejavu_ho" data-dojo-type="dojox/mobile/Switch" value="on"  leftLabel="Ho / He" rightLabel="Only Ho" style="width: 70px;">
                        </div>
                    </td>
                    <td style="padding-left:25px;"><span><input jsId="filter_text" id="filter_text" style="border-radius:0px;width:14em;float:right;background:#FFFFFF url(../images/polyicons/search.png) no-repeat 2px 2px;" onClick="checkTextValue()" onBlur="checkTextValue()" dojoType="dijit.form.TextBox" value="Search gene or onthology..."/></span></td>
                </table>
                </center>
            </div>
            <div  dojoType="dijit.Toolbar" style ="font-size : 9px;">
                <center>
                <table>
                    <td>
                        <div><span class="filterLabelActif2" style="padding:0px 5px 0px 10px;">Impact Factor</span></div>
                        <br>
                        <div>
                            <table align="center" valign="center">
                                <td><img id='help_predictions_2' src="../images/menu/help_2.png" margin-bottom="inherit"/></td>
                            </table>
                        </div>
                            <div data-dojo-type="dijit/Tooltip" data-dojo-props="connectId:'help_predictions_2',position:['above']">
                                <div dojoType="dijit.layout.BorderContainer" style="width:640px;height:120px;background-color: #F4F4F4;padding: 3px;" hidden>
                                    <table text-align="center" style="width:100%">
                                        <td style="width:100%">
                                            <table text-align="center" border="2px" style="width:100%">
                                                <tr>
                                                    <td style="width: 20%" align="center"><b>IMPACT</b></td>
                                                    <td style="width: 80%" align="center"><b>GET VAR TYPES</b></td>
                                                </tr>
                                                <tr>
                                                    <td style="width: 20%" align="center"><font color="#EA3434"><i>High Impact</i></font></td>
                                                    <td style="width: 80%" align="left" id="help_impact_high"></td>
                                                </tr>
                                                <tr>
                                                    <td style="width: 20%" align="center"><font color="#EAA134"><i>Medium Impact</i></font></td>
                                                    <td style="width: 80%" align="left" id="help_impact_medium"></td>
                                                </tr>
                                                <tr>
                                                    <td style="width: 20%" align="center"><font color="#EACC34"><i>Low Impact</i></font></td>
                                                    <td style="width: 80%" align="left" id="help_impact_low"></td>
                                                </tr>
                                                <tr>
                                                    <td style="width: 20%" align="center"><font color="green"><i>All Variants</i></font></td>
                                                    <td style="width: 80%" align="left">&nbsp;All variants</td>
                                                </tr>
                                            </table>
                                        </td>
                                    </table>
                                </div>
                                <div dojoType="dijit.layout.BorderContainer" style="width:750px;height:260px;">
                                    <img src="../images/polyicons/img_annotations_v2.png" />
                                </div>
                            </div>
                   </td> 
                
                   <td>
                        <div id="slider_impact" jsId="slider_impact" onChange="get_slider_impact()" data-dojo-type="dijit/form/HorizontalSlider" aria-label="slider 3" data-dojo-props='name:"horizontal2",minimum:1,value:1,maximum:4,discreteValues:4,showButtons:false,intermediateChanges:true,slideDuration:0,style:"width:150px; height: 25px;margin-left:20px;"' >
                            <div data-dojo-type="dijit/form/HorizontalRule" data-dojo-props='container:"bottomDecoration", count:4, style:{height:"5px"}'> </div>
                            <ol data-dojo-type="dijit/form/HorizontalRuleLabels" data-dojo-props='container:"bottomDecoration", style:{height:"1em", fontSize:"100%"}'>
                                <li><span><font color="#EA3434"><i>Impact</i></font></span></li>
                                <li><span><font color="#EAA134"><i>Impact</i></font></span></li>
                                <li><span><font color="#EACC34"><i>Impact</i></font></span></li>
                                <li><span><font color="#28A24C"><i>Variants</i></font></span></li>
                            </ol>
                            <ol data-dojo-type="dijit/form/HorizontalRuleLabels" data-dojo-props="container: 'topDecoration'" style="height: 1.3em;">
                                <li><span><font color="#EA3434"><i>High</i></font></span></li>
                                <li><span><font color="#EAA134"><i>Medium</i></font></span></li>
                                <li><span><font color="#EACC34"><i>Low</i></font></span></li>
                                <li><span><font color="#28A24C"><i>All</i></font></span></li>
                            </ol>
                        </div>
                    </td>
               
               <td>
                   <div style="width:25px"></div>
               </td>
                
                <td>
                    <table>
                        <tr>
                            <td style="font-size:9px;">
                                <input type="checkbox" dojoType="dijit.form.CheckBox" id="filter_maturemirna" onClick="click_annot('filter_maturemirna')">
                                <span id="span_maturemirna"></span><span style="color:red;" id="span_filter_maturemirna_multi_compound"></span>
                            </td>
                            <td style="font-size:9px;">
                                <input type="checkbox" dojoType="dijit.form.CheckBox" id="filter_essential_splicing" onClick="click_annot('filter_essential_splicing')">
                                <span id="span_essential_splicing"></span><span style="color:red;" id="span_filter_essential_splicing_multi_compound"></span>
                            </td>
                            <td style="font-size:9px;">
                                <input type="checkbox" dojoType="dijit.form.CheckBox" id="filter_frameshift" onClick="click_annot('filter_frameshift')">
                                <span id="span_frameshift"></span><span style="color:red;" id="span_filter_frameshift_multi_compound"></span>
                            </td>
                            <td style="font-size:9px;">
                                <input type="checkbox" dojoType="dijit.form.CheckBox" id="filter_stop" onClick="click_annot('filter_stop')">
                                <span id="span_stop"></span><span style="color:red;" id="span_filter_stop_multi_compound"></span>
                            </td>
                            <td style="font-size:9px;">
                                <input type="checkbox" dojoType="dijit.form.CheckBox" id="filter_phase" onClick="click_annot('filter_phase')">
                                <span id="span_phase"></span><span style="color:red;" id="span_filter_phase_multi_compound"></span>
                            </td>
                        </tr>
                        <tr>
                            <td style="font-size:9px;">
                                <input type="checkbox" dojoType="dijit.form.CheckBox" id="filter_ncrna" onClick="click_annot('filter_ncrna')">
                                <span id="span_ncrna"></span><span style="color:red;" id="span_filter_ncrna_multi_compound"></span>
                            </td>
                            <td style="font-size:9px;">
                                <input type="checkbox" dojoType="dijit.form.CheckBox" id="filter_splice_site" onClick="click_annot('filter_splice_site')">
                                <span id="span_splice_site"></span><span style="color:red;" id="span_filter_splice_site_multi_compound"></span>
                            </td>
                            <td style="font-size:9px;">
                                <input type="checkbox" dojoType="dijit.form.CheckBox" id="filter_predicted_splice_site" onClick="click_annot('filter_predicted_splice_site')">
                                <span id="span_predicted_splice_site"></span><span style="color:red;" id="span_filter_predicted_splice_site_multi_compound"></span>
                            </td>
                            <td style="font-size:9px;">
                                <input type="checkbox" dojoType="dijit.form.CheckBox" id="filter_nonsynonymous" onClick="click_annot('filter_nonsynonymous')">
                                <span id="span_nonsynonymous"></span><span style="color:red;" id="span_filter_nonsynonymous_multi_compound"></span>
                            </td>
                            <td style="font-size:9px;">
                                <input type="checkbox" dojoType="dijit.form.CheckBox" id="filter_nonframeshift" onClick="click_annot('filter_nonframeshift')">
                                <span id="span_nonframeshift"></span><span style="color:red;" id="span_filter_nonframeshift_multi_compound"></span>
                            </td>
                        </tr>
                        <tr>
                            <td style="font-size:9px;">
                                <input type="checkbox" dojoType="dijit.form.CheckBox" id="filter_pseudogene" onClick="click_annot('filter_pseudogene')">
                                <span id="span_pseudogene"></span><span style="color:red;" id="span_filter_pseudogene_multi_compound"></span>
                            </td>
                            <td style="font-size:9px;">
                                <input type="checkbox" dojoType="dijit.form.CheckBox" id="filter_utr" onClick="click_annot('filter_utr')">
                                <span id="span_utr"></span><span style="color:red;" id="span_filter_utr_multi_compound"></span>
                            </td>
                            <td style="font-size:9px;">
                                <input type="checkbox" dojoType="dijit.form.CheckBox" id="filter_silent" onClick="click_annot('filter_silent')">
                                <span id="span_silent"></span><span style="color:red;" id="span_filter_silent_multi_compound"></span>
                            </td>
                            <td style="font-size:9px;">
                                <input type="checkbox" dojoType="dijit.form.CheckBox" id="filter_upstream_downstream" onClick="click_annot('filter_upstream_downstream')">
                                <span id="span_upstream_downstream"></span><span style="color:red;" id="filter_upstream_downstream_multi_compound"></span>
                            </td>
                            <td style="font-size:9px;">
                                <input type="checkbox" dojoType="dijit.form.CheckBox" id="filter_intronic" onClick="click_annot('filter_intronic')">
                                <span id="span_intronic"></span><span style="color:red;" id="span_filter_intronic_multi_compound"></span>
                            </td>
                            <td style="font-size:9px;">
                                <input type="checkbox" dojoType="dijit.form.CheckBox" id="filter_intergenic" onClick="click_annot('filter_intergenic')">
                                <span id="span_intergenic"></span><span style="color:red;" id="span_filter_intergenic_multi_compound"></span>
                            </td>
                        </tr>
                    </table>
                </td>
                
                
                    <td style="padding-left:25px;padding-right:10px;">
                        <div><span class="filterLabelActif2" style="padding:0px 0px 0px 10px;">Run</span></div>
                        <br>
                        <div>
                            <table align="center" valign="center">
                                <td><img id='help_annotations_4' src="../images/menu/help_2.png" margin-bottom="inherit"/></td>
                            </table>
                        </div>
                        <div data-dojo-type="dijit/Tooltip" data-dojo-props="connectId:'help_annotations_4',position:['above']">
                            <span><font color="#EAA134">WARNING !</font> With ''<b><i>View ALL genes</i></b>'' option, it can be long to execute...</span>
                        </div>
                    </td>
                    <td style="padding-left:15px;padding-right:5px;">
                        <button type="button" id="startButton" onMouseOver="checkMessageError()" style="float=right" disabled>
                            <table>
                                <td>
                                    <span style="font-size:10px;padding-bottom: 0px;"><img id='img_run_1' src="../images/polyicons/run_2.png"></span>
                                </td>
                                <td>
                                    <span id="span_run_msg" style="font-size:12px;"><b>&nbsp;&nbsp;RUN&nbsp;</b></span>
                                </td>
                            </table>
                        </button>
                    </td>
                </table>
                </center>
            </div>
        </div>
    </div>
    
      <div dojoType="dijit.TitlePane" id="panel_custom_filters" title="Others Filters" open="false">
            <div dojoType="dijit.layout.ContentPane" region="top" style="padding:0px; box-shadow: 1px 0 1px rgba(0, 0, 0, 1);" splitter="false">
                            
        <div  dojoType="dijit.Toolbar" style ="font-size : 9px;">
            <center>
            <table>
                
                <td style="padding-left: 10px;padding-right: 10px"> 
                    <div><span class="filterLabelActif2" style="padding:0px 0px 0px 10px;">Global</span></div>
                    <br>
                    <div>
                        <table align="center" valign="center">
                            <td><img id='help_annotations_3' src="../images/menu/help_2.png" margin-bottom="inherit"/></td>
                        </table>
                    </div>
                    <div data-dojo-type="dijit/Tooltip" data-dojo-props="connectId:'help_annotations_3',position:['above']">
                        Get Substitutions / Insertions / Deletions / Cnvs (= Large_Del + Large_Ins).
                    </div>
                </td>
                <td>
                    <div>
                        <!--  variation type-->
                        <div jsId="dd_type" data-dojo-type="dijit.form.DropDownButton"  data-dojo-props="iconClass:'dijitIconFilter'">
                            <span>Variants Type (All)</span>
                            <div data-dojo-type="dijit.TooltipDialog" onHide='update_choice_filter()' >
                                <div  dojoType="dijit.Toolbar" style ="font-size : 10px;">
                                    <table style="border:1px solid #9f9f9f">
                                        <td style="padding:5px;"><input type="checkbox" id="filter_substitution" data-dojo-type="dojox/mobile/Switch" value="on"  leftLabel="Substitution" rightLabel="Substitution" style="width: 85px;"></td>
                                        <td style="padding:5px;"><input type="checkbox" id="filter_deletion" data-dojo-type="dojox/mobile/Switch" value="on"  leftLabel="Deletion" rightLabel="Deletion" style="width: 75px;"></td>
                                        <td style="padding:5px;"><input type="checkbox" id="filter_insertion" data-dojo-type="dojox/mobile/Switch" value="on"  leftLabel="Insertion" rightLabel="Insertion" style="width: 75px;"></td>
                                        <td style="padding:5px;"><input type="checkbox" id="filter_cnv" data-dojo-type="dojox/mobile/Switch" value="on"  leftLabel="CNV" rightLabel="CNV" style="width: 95px;"></td>
                                    </table>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div hidden>
                        <div jsId="dd_score" data-dojo-type="dijit.form.DropDownButton" data-dojo-props="iconClass:'dijitIconFilter'">
                            <span>Confidence (All)</span>
                            <div data-dojo-type="dijit.TooltipDialog" onHide='update_choice_filter()' >
                                <div  dojoType="dijit.Toolbar" style ="font-size : 10px;">
                                    <table style="border:1px solid #9f9f9f;">   
                                        <td style="padding:5px;"><input type="checkbox" id="filter_score2" data-dojo-type="dojox/mobile/Switch" value="on"  leftLabel="Strong" rightLabel="Strong" style="width: 75px;"></td>
                                        <td style="padding:5px;"><input type="checkbox" id="filter_score1" data-dojo-type="dojox/mobile/Switch" value="on"  leftLabel="Medium" rightLabel="Medium" style="width: 75px;"></td>
                                        <td style="padding:5px;"><input type="checkbox" id="filter_score0" data-dojo-type="dojox/mobile/Switch" value="on"  leftLabel="Low" rightLabel="Low" style="width: px;"></td>
                                    </table>
                                </div>
                            </div>
                        </div>
                    </div>
                </td>
                
                <td style="padding-left: 3px"> 
                    <div><span class="filterLabelActif2">Predictions</span></div>
                    <br>
                    <div>
                        <table align="center" valign="center">
                            <td><img id='help_predictions' src="../images/menu/help_2.png" margin-bottom="inherit"/></td>
                        </table>
                    </div>
                    <div data-dojo-type="dijit/Tooltip" data-dojo-props="connectId:'help_predictions',position:['above']">
                        <div dojoType="dijit.layout.BorderContainer" style="width:500px;height:230px;background-color: #F4F4F4;padding: 3px;">
                            <table text-align="center" align="center" border="2px" style="width:100%">
                                <tr>
                                    <td style="width: 20%;" align="center"><span></span></td>
                                    <td style="width: 35%;" align="center"><span><b>POLYPHEN STATUS</b></span></td>
                                    <td style="width: 10%;" align="center"></td>
                                    <td style="width: 35%;" align="center"><span><b>SIFT STATUS</b></span></td>
                                </tr>
                                <tr>
                                    <td style="width: 20%;" align="center"><span><i>Surely Damaging</i></span></td>
                                    <td style="width: 35%;" align="center"><img src="../images/polyicons/difficulty_2_1.png"/></td>
                                    <td style="width: 10%;" align="center"><b><font color="red">AND</font></b></td>
                                    <td style="width: 35%;" align="center"><img src="../images/polyicons/difficulty_2_1.png"/></td>
                                </tr>
                                <tr>
                                    <td style="width: 20%;" align="center"><span><i>Probably Damaging</i></span></td>
                                    <td style="width: 35%;" align="center"><img src="../images/polyicons/difficulty_2_1.png"/></td>
                                    <td style="width: 10%;" align="center"><b><font color="red">OR</font></b></td>
                                    <td style="width: 35%;" align="center"><img src="../images/polyicons/difficulty_2_1.png"/></td>
                                </tr>
                                <tr>
                                    <td style="width: 20%;" align="center"><span><i>Possibly Damaging</i></span></td>
                                    <td style="width: 35%;" align="center"><img src="../images/polyicons/difficulty_2_1.png"/>&nbsp;&nbsp;<b>OR</b>&nbsp;&nbsp;<img src="../images/polyicons/difficulty_1.png"/></td>
                                    <td style="width: 10%;" align="center"><b>OR</b></td>
                                    <td style="width: 35%;" align="center"><img src="../images/polyicons/difficulty_2_1.png"/></td>
                                </tr>
                                <tr>
                                    <td style="width: 20%;" align="center"><span><i>All</i></span></td>
                                    <td style="width: 35%;" align="center"><b>ALL STATUS</b></td>
                                    <td style="width: 10%;" align="center"><b>OR</b></td>
                                    <td style="width: 35%;" align="center"><b>ALL STATUS</b></td>
                                </tr>
                            </table>
                            <br>
                            <table text-align="center" style="width:100%">
                                <td style="width:49%">
                                    <table text-align="center" border="3px" style="width:100%">
                                        <tr>
                                            <td style="width: 20%" align="center"></td>
                                            <td style="width: 80%" align="center"><b>POLYPHEN STATUS</b></td>
                                        </tr>
                                        <tr>
                                            <td style="width: 20%" align="center"><img src="../images/polyicons/difficulty_2_1.png"/></td>
                                            <td style="width: 80%" align="center">&nbsp;Probably Damaging</td>
                                        </tr>
                                        <tr>
                                            <td style="width: 20%" align="center"><img src="../images/polyicons/difficulty_1.png"/></td>
                                            <td style="width: 80%" align="center">&nbsp;Possibly Damaging</td>
                                        </tr>
                                        <tr>
                                            <td style="width: 20%" align="center"><img src="../images/polyicons/difficulty_0.png"/></td>
                                            <td style="width: 80%" align="center">&nbsp;All</td>
                                        </tr>
                                        <tr>
                                            <td style="width: 20%" align="center"><img src="../images/polyicons/difficulty_3_b.png"/></td>
                                            <td style="width: 80%" align="center">&nbsp;Uknown</td>
                                        </tr>
                                    </table>
                                </td>
                                <td style="width:2%">
                                    <div style="width: 100%";
                                </td>
                                <td style="width:49%">
                                    <table text-align="center" border="3px" style="width:100%">
                                        <tr>
                                            <td style="width: 20%" align="center"></td>
                                            <td style="width: 80%" align="center"><b>SIFT STATUS</b></td>
                                        </tr>
                                        <tr>
                                            <td style="width: 20%" align="center"><img src="../images/polyicons/difficulty_2_1.png"/></td>
                                            <td style="width: 80%" align="center">&nbsp;Deleterious</td>
                                        </tr>
                                        <tr>
                                            <td style="width: 20%" align="center"><img src="../images/polyicons/difficulty_0.png"/></td>
                                            <td style="width: 80%" align="center">&nbsp;All</td>
                                        </tr>
                                        <tr>
                                            <td style="width: 20%" align="center"><img src="../images/polyicons/difficulty_3_b.png"/></td>
                                            <td style="width: 80%" align="center">&nbsp;Uknown</td>
                                        </tr>
                                    </table>
                                </td>
                            </table>
                        </div>
                    </div>
              </td>
              <td style="padding:3px">
                    <div id="slider_predictions" jsId="slider_predictions" data-dojo-type="dijit/form/HorizontalSlider" aria-label="slider 3" data-dojo-props='name:"horizontal2",minimum:1,value:4,maximum:4,discreteValues:4,showButtons:false,intermediateChanges:true,slideDuration:0,style:"width:165px; height: 25px;margin-left:4px;"' >
                        <div data-dojo-type="dijit/form/HorizontalRule" data-dojo-props='container:"bottomDecoration", count:4, style:{height:"5px"}'> </div>
                        <ol data-dojo-type="dijit/form/HorizontalRuleLabels" data-dojo-props='container:"bottomDecoration", style:{height:"1em", fontSize:"100%"}'>
                            <li><span><font color="#EA3434"><i>Damaging</i></font></span></li>
                            <li><span><font color="#EAA134"><i>Damaging</i></font></span></li>
                            <li><span><font color="#EACC34"><i>Damaging</i></font></span></li>
                            <li><span><font color="green"><i>All</i></font></span></li>
                        </ol>
                        <ol data-dojo-type="dijit/form/HorizontalRuleLabels" data-dojo-props="container: 'topDecoration'" style="height: 1.3em;">
                            <li><span><font color="#EA3434"><i>Surely</i></font></span></li>
                            <li><span><font color="#EAA134"><i>Probably</i></font></span></li>
                            <li><span><font color="#EACC34"><i>Possibly</i></font></span></li>
                            <li></li>
                        </ol>
                    </div>
               </td>
              <td style="padding-left:3px">
                    <div style="padding-bottom:30px"><span class="filterLabelActif2">Confidence</span></div>
                    <!--
                    <br>
                    <div>
                        <table align="center" valign="center">
                            <td><img id='help_confidence' src="../images/menu/help_2.png" margin-bottom="inherit"/></td>
                        </table>
                    </div>
                    -->
              </td>
              <td style="padding-left:3px">
                    <div id="slider_confidence" jsId="slider_confidence" data-dojo-type="dijit/form/HorizontalSlider" aria-label="slider 4" data-dojo-props='name:"horizontal2",minimum:1,value:3,maximum:3,discreteValues:3,showButtons:false,intermediateChanges:true,slideDuration:0,style:"width:90px; height: 25px;margin-left:4px;"' >
                        <div data-dojo-type="dijit/form/HorizontalRule" data-dojo-props='container:"bottomDecoration", count:3, style:{height:"5px"}'> </div>
                        <ol data-dojo-type="dijit/form/HorizontalRuleLabels" data-dojo-props='container:"bottomDecoration", style:{height:"1em", fontSize:"100%"}'>
                            <li><span><font color="#EA3434"><i>High</i></font></span></li>
                            <li><span><font color="#EACC34"><i>Medium</i></font></span></li>
                            <li><span><font color="green"><i>All</i></font></span></li>
                        </ol>
                        <ol data-dojo-type="dijit/form/HorizontalRuleLabels" data-dojo-props="container: 'topDecoration'" style="height: 1.3em;">
                            <li><span></span></li>
                            <li><span></span></li>
                            <li><span></span></li>
                            <li></li>
                        </ol>
                    </div>
               </td>
                        
               <td style="padding-left: 15px;display:none"> 
                    <div><span class="filterLabelActif2">Run Option</span></div>
               </td>
               <!--
               <td style="font-size:9px;padding-left:5px"><input type="checkbox" id="b_view_all_genes" onClick='run_view_all_genes()' disabled=""><span>  View <b>ALL</b> genes</span> </input></td>
               -->
               <td style="font-size:9px;padding-left:5px;display:none">
                    <button type="button" id="startButtonAllGenes" onMouseOver="checkMessageError()" style="float=right" disabled>
                        <table>
                            <td>
                                <span style="font-size:8px;padding-bottom: 0px;"><img id='img_run_2' src="../images/polyicons/run_2.png"></span>
                            </td>
                            <td>
                                <span id="span_run_msg_all_genes" style="font-size:10px;"><b>&nbsp;&nbsp;LIST ALL Genes&nbsp;</b></span>
                            </td>
                        </table>
                    </button>
                </td>
               <!--
               <td style="padding-left:20px;">
                    <button type="button" id="b_viewAllVar" onClick="goViewAllVar()" style="float=right" disabled>
                        <table>
                            <td>
                                <span style="font-size:10px;padding-bottom: 0px;"><img id='img_run_2' src="../images/polyicons/run_2.png"></span>
                            </td>
                            <td>
                                <span style="font-size:12px;"><b>&nbsp;&nbsp;View ALL Var&nbsp;</b></span>
                            </td>
                        </table>
                    </button>
               <td>
               -->
               <td style="padding-left: 10px"> 
                        <div><span class="filterLabelActif2">Ho Regions</span></div>
                        <br>
                        <div>
                            <table align="center" valign="center">
                                <td><img id='help_regionho' src="../images/menu/help_2.png" margin-bottom="inherit"/></td>
                            </table>
                        </div>
                        <div data-dojo-type="dijit/Tooltip" data-dojo-props="connectId:'help_regionho',position:['above']">
                        	<span>
                        		<b><i>Region</i></b> slider find regions of successive homozygous variants<br>according to the <b><i>Min nb var</i></b> value selected<br><br>
                        	</span>
                        </div>
                  </td>
                   <td>
                   	<table>
                   		<td>
	                        <div id="slider_regionho" jsId="slider_regionho"  onChange="check_slider_regionho()" data-dojo-type="dijit/form/HorizontalSlider" aria-label="slider 3" data-dojo-props='name:"horizontal2",minimum:1,value:5,maximum:5,discreteValues:5,showButtons:false,intermediateChanges:true,slideDuration:0,style:"width:180px; height: 25px;margin-left:20px;"' >
	                            <div>
	                                <div data-dojo-type="dijit/form/HorizontalRule" data-dojo-props='container:"bottomDecoration", count:5, style:{height:"5px"}'> </div>
	                                <ol data-dojo-type="dijit/form/HorizontalRuleLabels" data-dojo-props='container:"bottomDecoration", style:{height:"1em", fontSize:"100%"}'>
	                                    <li><span><font color="#EA3434">Extra Large</font></span></li>
	                                    <li><span><font color=#EAA134">Large</font></span></li>
	                                    <li><span><font color="#EACC34">Medium</font></span></li>
	                                    <li><span><font color="#28A24C">Short</font></span></li>
	                                    <li><span><font color="#999">None</font></span></li>
	                                </ol>
	                                <ol data-dojo-type="dijit/form/HorizontalRuleLabels" data-dojo-props="container: 'topDecoration'" style="height: 1.3em;">
	                                    <li></li>
	                                    <li><span id="text_regionho"><i><b><font color="#EA3434">Not Used</font></i></b></span><span style="font-weight: bold;color: #28A24C" id ="nb_regionho"></li>
	                                	<li></li>
	                                </ol>
	                            </div>
	                        </div>
                        </td>
                        <td style="padding-left: 10px" hidden>
	                        <input type="checkbox" id="filter_region_ho_rec_only_sub" data-dojo-type="dojox/mobile/Switch" value="on"  leftLabel="ALL Var" rightLabel="SUB Only" style="width:80px;" hidden>
                        </td>
                    </table>
                </td>
           </table>
           </center>
      </div><!-- end tool bar -->
      <div dojoType="dijit.Toolbar" style ="font-size : 9px;">
           <center>
 			<table>
              <td style="padding-left: 20px"> 
                <div><span class="filterLabelActif2">NCBoost</span></div>
                    <br>
                    <div>
                        <table align="center" valign="center">
                            <td><img id='help_ncboost_score' src="../images/menu/help_2.png" margin-bottom="inherit"/></td>
                        </table>
                    </div>
                    <div data-dojo-type="dijit/Tooltip" data-dojo-props="connectId:'help_ncboost_score',position:['above']">
                    	<span>
                    		<b><i>NCBoost</i></b> classifies pathogenic non-coding variants in Mendelian diseases through supervised learning on purifying selection signals in humans.<br>
                    		Publication: <a href="https://genomebiology.biomedcentral.com/articles/10.1186/s13059-019-1634-2" target="_blank"><i>PDF</i></a>.<br><br>
                    		<b>High:</b> > 0.90<br>
                    		<b>Medium:</b> > 0.75<br>
                    		<b>Moderate:</b> > 0.50<br><br>
                    	</span>
                    </div>
                </div>
              </td>
              <td style="padding:3px">
                    <div id="slider_ncboost" jsId="slider_ncboost" data-dojo-type="dijit/form/HorizontalSlider" aria-label="slider 3" data-dojo-props='name:"horizontal2",minimum:1,value:4,maximum:4,discreteValues:4,showButtons:false,intermediateChanges:true,slideDuration:0,style:"width:150px; height: 25px;margin-left:4px;"' >
                        <div data-dojo-type="dijit/form/HorizontalRule" data-dojo-props='container:"bottomDecoration", count:4, style:{height:"5px"}'> </div>
                        <ol data-dojo-type="dijit/form/HorizontalRuleLabels" data-dojo-props='container:"bottomDecoration", style:{height:"1em", fontSize:"100%"}'>
                            <li><span><font color="#EA3434"><i>High</i></font></span></li>
                            <li><span><font color="#EAA134"><i>Medium</i></font></span></li>
                            <li><span><font color="#EACC34"><i>Moderate</i></font></span></li>
                            <li><span><font color="green"><i>All</i></font></span></li>
                        </ol>
                        <ol data-dojo-type="dijit/form/HorizontalRuleLabels" data-dojo-props="container: 'topDecoration'" style="height: 1.3em;">
                            <li><span></span></li>
                            <li><span></span></li>
                            <li><span></span></li>
                            <li><span></span></li>
                        </ol>
                    </div>
               </td>
              <td style="padding-left: 20px"> 
                <div><span class="filterLabelActif2">Cadd Score</span></div>
                    <br>
                    <div>
                        <table align="center" valign="center">
                            <td><img id='help_cadd_score' src="../images/menu/help_2.png" margin-bottom="inherit"/></td>
                        </table>
                    </div>
                    <div data-dojo-type="dijit/Tooltip" data-dojo-props="connectId:'help_cadd_score',position:['above']">
                    	<span>
                    		<b><i>CADD</i></b> is a tool for scoring the deleteriousness of single nucleotide variants as well as insertion/deletions variants in the human genome.<br><br>
                    	</span>
                    </div>
                </div>
              </td>
              <td style="padding:3px">
                    <div id="slider_cadd" jsId="slider_cadd" data-dojo-type="dijit/form/HorizontalSlider" aria-label="slider 3" data-dojo-props='name:"horizontal2",minimum:1,value:7,maximum:7,discreteValues:7,showButtons:false,intermediateChanges:true,slideDuration:0,style:"width:130px; height: 25px;margin-left:4px;"' >
                        <div data-dojo-type="dijit/form/HorizontalRule" data-dojo-props='container:"bottomDecoration", count:7, style:{height:"5px"}'> </div>
                        <ol data-dojo-type="dijit/form/HorizontalRuleLabels" data-dojo-props='container:"bottomDecoration", style:{height:"1em", fontSize:"100%"}'>
                            <li><span><font color="#EA3434"><i>30</i></font></span></li>
                            <li><span><font color="#EA3434"><i>25</i></font></span></li>
                            <li><span><font color="#EAA134"><i>20</i></font></span></li>
                            <li><span><font color="#EAA134"><i>15</i></font></span></li>
                            <li><span><font color="green"><i>10</i></font></span></li>
                            <li><span><font color="green"><i>5</i></font></span></li>
                            <li><span><font color="green"><i>All</i></font></span></li>
                        </ol>
                        <ol data-dojo-type="dijit/form/HorizontalRuleLabels" data-dojo-props="container: 'topDecoration'" style="height: 1.3em;">
                            <li><span></span></li>
                            <li><span></span></li>
                            <li><span></span></li>
                            <li><span></span></li>
                            <li><span></span></li>
                            <li><span></span></li>
                            <li><span></span></li>
                            <li><span></span></li>
                        </ol>
                    </div>
               </td>
               <td style="padding:3px">
					<input type="checkbox" dojoType="dijit.form.CheckBox" id="filter_cadd_keep_indels" checked='true'>
                    <span>Keep Indels</span>
               </td>
               
              <td style="padding-left: 20px"> 
                <div><span class="filterLabelActif2">% Ratio Allelic</span></div>
                    <br>
                    <div>
                        <table align="center" valign="center">
                            <td><img id='help_ratio' src="../images/menu/help_2.png" margin-bottom="inherit"/></td>
                        </table>
                    </div>
                    <div data-dojo-type="dijit/Tooltip" data-dojo-props="connectId:'help_ratio',position:['above']">
                    	<span>
                    		<b>TIPS</b>
                    		<br>
                    		To use this filter (Min/Max % ratio):<br>
                    		  1- Select your patient name with "Intersect"<br>
                    		  2- Select all others patients and put them "In The Attic"<br>
                    		  3- RUN<br>
                    	</span>
                    </div>
                </div>
              </td>
              <td style="padding-left:2px">
              		<b><span>MIN:</span></b>
              </td>
              <td style="padding-left:1px">
              	<table>
              		<tr>
              			<td>
		                    <div id="slider_ratio_min" jsId="slider_ratio_min" data-dojo-type="dijit/form/HorizontalSlider" aria-label="slider 3" data-dojo-props='name:"horizontal2",minimum:1,value:0,maximum:5,discreteValues:5,showButtons:false,intermediateChanges:true,slideDuration:0,style:"width:110px; height: 25px;margin-left:4px;"' >
		                        <div data-dojo-type="dijit/form/HorizontalRule" data-dojo-props='container:"bottomDecoration", count:5, style:{height:"5px"}'> </div>
		                        <ol data-dojo-type="dijit/form/HorizontalRuleLabels" data-dojo-props='container:"bottomDecoration", style:{height:"1em", fontSize:"100%"}'>
									<li>0</li>
									<li>10</li>
									<li>20</li>
									<li>40</li>
						            <li>80</li>
		                        </ol>
		                        <ol data-dojo-type="dijit/form/HorizontalRuleLabels" data-dojo-props="container: 'topDecoration'" style="height: 1.3em;">
		                            <li><span></span></li>
		                            <li><span></span></li>
		                            <li><span></span></li>
		                            <li><span></span></li>
		                            <li><span></span></li>
		                        </ol>
		                    </div>
	                    </td>
					</tr>
				</table>
              </td>
              <td style="padding-left:2px">
              		<b><span>MAX:</span></b>
              </td>
              <td style="padding:1px">
	                <div id="slider_ratio_max" jsId="slider_ratio_max" data-dojo-type="dijit/form/HorizontalSlider" aria-label="slider 3" data-dojo-props='name:"horizontal2",minimum:1,value:5,maximum:5,discreteValues:5,showButtons:false,intermediateChanges:true,slideDuration:0,style:"width:110px; height: 25px;margin-left:4px;"' >
	                    <div data-dojo-type="dijit/form/HorizontalRule" data-dojo-props='container:"bottomDecoration", count:5, style:{height:"5px"}'> </div>
	                    <ol data-dojo-type="dijit/form/HorizontalRuleLabels" data-dojo-props='container:"bottomDecoration", style:{height:"1em", fontSize:"100%"}'>
							<li>10</li>
							<li>20</li>
							<li>40</li>
							<li>80</li>
				            <li>All</li>
	                    </ol>
	                    <ol data-dojo-type="dijit/form/HorizontalRuleLabels" data-dojo-props="container: 'topDecoration'" style="height: 1.3em;">
	                        <li><span></span></li>
	                        <li><span></span></li>
	                        <li><span></span></li>
	                        <li><span></span></li>
	                        <li><span></span></li>
	                    </ol>
	                </div>
               </td>
               
               <!--
              <td style="padding-left: 20px"> 
                <div><span class="filterLabelActif2">Poly Score</span></div>
                    <br>
                    <div>
                        <table align="center" valign="center">
                            <td><img id='help_polyscore_score' src="../images/menu/help_2.png" margin-bottom="inherit"/></td>
                        </table>
                    </div>
                    <div data-dojo-type="dijit/Tooltip" data-dojo-props="connectId:'help_polyscore_score',position:['above']">
                    	<span>
                    		<b><i>PolyScore</i></b> home made score for each variation<br><br>
                    	</span>
                    </div>
                </div>
              </td>
              <td style="padding:3px">
                    <div id="slider_polyscore" jsId="slider_polyscore" data-dojo-type="dijit/form/HorizontalSlider" aria-label="slider 3" data-dojo-props='name:"horizontal2",minimum:1,value:4,maximum:4,discreteValues:4,showButtons:false,intermediateChanges:true,slideDuration:0,style:"width:130px; height: 25px;margin-left:4px;"' >
                        <div data-dojo-type="dijit/form/HorizontalRule" data-dojo-props='container:"bottomDecoration", count:4, style:{height:"5px"}'> </div>
                        <ol data-dojo-type="dijit/form/HorizontalRuleLabels" data-dojo-props='container:"bottomDecoration", style:{height:"1em", fontSize:"100%"}'>
                            <li><span><font color="#EA3434"><i>High</i></font></span></li>
                            <li><span><font color="#EAA134"><i>Medium</i></font></span></li>
                            <li><span><font color="green"><i>Low</i></font></span></li>
                            <li><span><font color="green"><i>All</i></font></span></li>
                        </ol>
                        <ol data-dojo-type="dijit/form/HorizontalRuleLabels" data-dojo-props="container: 'topDecoration'" style="height: 1.3em;">
                            <li><span></span></li>
                            <li><span></span></li>
                            <li><span></span></li>
                            <li><span></span></li>
                        </ol>
                    </div>
               </td>
               -->
               
  			</table>
           </center>
      </div>
    </div>
</div>

<!--
 <div dojoType="dijit.TitlePane" id="panel_other_genes_view" title="Others Genes View" style ="padding:0px;font-size : 10px;" open="false" onclick="loadD3()">
    <div dojoType="dijit.layout.BorderContainer" style =" border-color:#037889;box-shadow: #B3B3B3 3px 3px 2px;width:100%;;height:500px;font-size : 10px;">
        <center>
            <div id="svg_container" style="border:1px solid #9f9f9f"></div>
        </center>
        <script type="application/json" id="mis">
            {
                "nodes": [{
                    "name": "Myriel",
                        "group": 1
                }, {
                    "name": "Napoleon",
                        "group": 1
                }, {
                    "name": "Mlle.Baptistine",
                        "group": 1
                }, {
                    "name": "Mme.Magloire",
                        "group": 1
                }, {
                    "name": "CountessdeLo",
                        "group": 1
                }, {
                    "name": "Geborand",
                        "group": 1
                }, {
                    "name": "Champtercier",
                        "group": 1
                }, {
                    "name": "Cravatte",
                        "group": 1
                }, {
                    "name": "Count",
                        "group": 1
                }, {
                    "name": "OldMan",
                        "group": 1
                }, {
                    "name": "Labarre",
                        "group": 2
                }, {
                    "name": "Valjean",
                        "group": 2
                }, {
                    "name": "Marguerite",
                        "group": 3
                }, {
                    "name": "Mme.deR",
                        "group": 2
                }, {
                    "name": "Isabeau",
                        "group": 2
                }, {
                    "name": "Gervais",
                        "group": 2
                }, {
                    "name": "Tholomyes",
                        "group": 3
                }, {
                    "name": "Listolier",
                        "group": 3
                }, {
                    "name": "Fameuil",
                        "group": 3
                }, {
                    "name": "Blacheville",
                        "group": 3
                }, {
                    "name": "Favourite",
                        "group": 3
                }, {
                    "name": "Dahlia",
                        "group": 3
                }, {
                    "name": "Zephine",
                        "group": 3
                }, {
                    "name": "Fantine",
                        "group": 3
                }, {
                    "name": "Mme.Thenardier",
                        "group": 4
                }, {
                    "name": "Thenardier",
                        "group": 4
                }, {
                    "name": "Cosette",
                        "group": 5
                }, {
                    "name": "Javert",
                        "group": 4
                }, {
                    "name": "Fauchelevent",
                        "group": 0
                }, {
                    "name": "Bamatabois",
                        "group": 2
                }, {
                    "name": "Perpetue",
                        "group": 3
                }, {
                    "name": "Simplice",
                        "group": 2
                }, {
                    "name": "Scaufflaire",
                        "group": 2
                }, {
                    "name": "Woman1",
                        "group": 2
                }, {
                    "name": "Judge",
                        "group": 2
                }, {
                    "name": "Champmathieu",
                        "group": 2
                }, {
                    "name": "Brevet",
                        "group": 2
                }, {
                    "name": "Chenildieu",
                        "group": 2
                }, {
                    "name": "Cochepaille",
                        "group": 2
                }, {
                    "name": "Pontmercy",
                        "group": 4
                }, {
                    "name": "Boulatruelle",
                        "group": 6
                }, {
                    "name": "Eponine",
                        "group": 4
                }, {
                    "name": "Anzelma",
                        "group": 4
                }, {
                    "name": "Woman2",
                        "group": 5
                }, {
                    "name": "MotherInnocent",
                        "group": 0
                }, {
                    "name": "Gribier",
                        "group": 0
                }, {
                    "name": "Jondrette",
                        "group": 7
                }, {
                    "name": "Mme.Burgon",
                        "group": 7
                }, {
                    "name": "Gavroche",
                        "group": 8
                }, {
                    "name": "Gillenormand",
                        "group": 5
                }, {
                    "name": "Magnon",
                        "group": 5
                }, {
                    "name": "Mlle.Gillenormand",
                        "group": 5
                }, {
                    "name": "Mme.Pontmercy",
                        "group": 5
                }, {
                    "name": "Mlle.Vaubois",
                        "group": 5
                }, {
                    "name": "Lt.Gillenormand",
                        "group": 5
                }, {
                    "name": "Marius",
                        "group": 8
                }, {
                    "name": "BaronessT",
                        "group": 5
                }, {
                    "name": "Mabeuf",
                        "group": 8
                }, {
                    "name": "Enjolras",
                        "group": 8
                }, {
                    "name": "Combeferre",
                        "group": 8
                }, {
                    "name": "Prouvaire",
                        "group": 8
                }, {
                    "name": "Feuilly",
                        "group": 8
                }, {
                    "name": "Courfeyrac",
                        "group": 8
                }, {
                    "name": "Bahorel",
                        "group": 8
                }, {
                    "name": "Bossuet",
                        "group": 8
                }, {
                    "name": "Joly",
                        "group": 8
                }, {
                    "name": "Grantaire",
                        "group": 8
                }, {
                    "name": "MotherPlutarch",
                        "group": 9
                }, {
                    "name": "Gueulemer",
                        "group": 4
                }, {
                    "name": "Babet",
                        "group": 4
                }, {
                    "name": "Claquesous",
                        "group": 4
                }, {
                    "name": "Montparnasse",
                        "group": 4
                }, {
                    "name": "Toussaint",
                        "group": 5
                }, {
                    "name": "Child1",
                        "group": 10
                }, {
                    "name": "Child2",
                        "group": 10
                }, {
                    "name": "Brujon",
                        "group": 4
                }, {
                    "name": "Mme.Hucheloup",
                        "group": 8
                }],
                    "links": [{
                    "source": 1,
                        "target": 0,
                        "value": 1
                }, {
                    "source": 2,
                        "target": 0,
                        "value": 8
                }, {
                    "source": 3,
                        "target": 0,
                        "value": 10
                }, {
                    "source": 3,
                        "target": 2,
                        "value": 6
                }, {
                    "source": 4,
                        "target": 0,
                        "value": 1
                }, {
                    "source": 5,
                        "target": 0,
                        "value": 1
                }, {
                    "source": 6,
                        "target": 0,
                        "value": 1
                }, {
                    "source": 7,
                        "target": 0,
                        "value": 1
                }, {
                    "source": 8,
                        "target": 0,
                        "value": 2
                }, {
                    "source": 9,
                        "target": 0,
                        "value": 1
                }, {
                    "source": 11,
                        "target": 10,
                        "value": 1
                }, {
                    "source": 11,
                        "target": 3,
                        "value": 3
                }, {
                    "source": 11,
                        "target": 2,
                        "value": 3
                }, {
                    "source": 11,
                        "target": 0,
                        "value": 5
                }, {
                    "source": 12,
                        "target": 11,
                        "value": 1
                }, {
                    "source": 13,
                        "target": 11,
                        "value": 1
                }, {
                    "source": 14,
                        "target": 11,
                        "value": 1
                }, {
                    "source": 15,
                        "target": 11,
                        "value": 1
                }, {
                    "source": 17,
                        "target": 16,
                        "value": 4
                }, {
                    "source": 18,
                        "target": 16,
                        "value": 4
                }, {
                    "source": 18,
                        "target": 17,
                        "value": 4
                }, {
                    "source": 19,
                        "target": 16,
                        "value": 4
                }, {
                    "source": 19,
                        "target": 17,
                        "value": 4
                }, {
                    "source": 19,
                        "target": 18,
                        "value": 4
                }, {
                    "source": 20,
                        "target": 16,
                        "value": 3
                }, {
                    "source": 20,
                        "target": 17,
                        "value": 3
                }, {
                    "source": 20,
                        "target": 18,
                        "value": 3
                }, {
                    "source": 20,
                        "target": 19,
                        "value": 4
                }, {
                    "source": 21,
                        "target": 16,
                        "value": 3
                }, {
                    "source": 21,
                        "target": 17,
                        "value": 3
                }, {
                    "source": 21,
                        "target": 18,
                        "value": 3
                }, {
                    "source": 21,
                        "target": 19,
                        "value": 3
                }, {
                    "source": 21,
                        "target": 20,
                        "value": 5
                }, {
                    "source": 22,
                        "target": 16,
                        "value": 3
                }, {
                    "source": 22,
                        "target": 17,
                        "value": 3
                }, {
                    "source": 22,
                        "target": 18,
                        "value": 3
                }, {
                    "source": 22,
                        "target": 19,
                        "value": 3
                }, {
                    "source": 22,
                        "target": 20,
                        "value": 4
                }, {
                    "source": 22,
                        "target": 21,
                        "value": 4
                }, {
                    "source": 23,
                        "target": 16,
                        "value": 3
                }, {
                    "source": 23,
                        "target": 17,
                        "value": 3
                }, {
                    "source": 23,
                        "target": 18,
                        "value": 3
                }, {
                    "source": 23,
                        "target": 19,
                        "value": 3
                }, {
                    "source": 23,
                        "target": 20,
                        "value": 4
                }, {
                    "source": 23,
                        "target": 21,
                        "value": 4
                }, {
                    "source": 23,
                        "target": 22,
                        "value": 4
                }, {
                    "source": 23,
                        "target": 12,
                        "value": 2
                }, {
                    "source": 23,
                        "target": 11,
                        "value": 9
                }, {
                    "source": 24,
                        "target": 23,
                        "value": 2
                }, {
                    "source": 24,
                        "target": 11,
                        "value": 7
                }, {
                    "source": 25,
                        "target": 24,
                        "value": 13
                }, {
                    "source": 25,
                        "target": 23,
                        "value": 1
                }, {
                    "source": 25,
                        "target": 11,
                        "value": 12
                }, {
                    "source": 26,
                        "target": 24,
                        "value": 4
                }, {
                    "source": 26,
                        "target": 11,
                        "value": 31
                }, {
                    "source": 26,
                        "target": 16,
                        "value": 1
                }, {
                    "source": 26,
                        "target": 25,
                        "value": 1
                }, {
                    "source": 27,
                        "target": 11,
                        "value": 17
                }, {
                    "source": 27,
                        "target": 23,
                        "value": 5
                }, {
                    "source": 27,
                        "target": 25,
                        "value": 5
                }, {
                    "source": 27,
                        "target": 24,
                        "value": 1
                }, {
                    "source": 27,
                        "target": 26,
                        "value": 1
                }, {
                    "source": 28,
                        "target": 11,
                        "value": 8
                }, {
                    "source": 28,
                        "target": 27,
                        "value": 1
                }, {
                    "source": 29,
                        "target": 23,
                        "value": 1
                }, {
                    "source": 29,
                        "target": 27,
                        "value": 1
                }, {
                    "source": 29,
                        "target": 11,
                        "value": 2
                }, {
                    "source": 30,
                        "target": 23,
                        "value": 1
                }, {
                    "source": 31,
                        "target": 30,
                        "value": 2
                }, {
                    "source": 31,
                        "target": 11,
                        "value": 3
                }, {
                    "source": 31,
                        "target": 23,
                        "value": 2
                }, {
                    "source": 31,
                        "target": 27,
                        "value": 1
                }, {
                    "source": 32,
                        "target": 11,
                        "value": 1
                }, {
                    "source": 33,
                        "target": 11,
                        "value": 2
                }, {
                    "source": 33,
                        "target": 27,
                        "value": 1
                }, {
                    "source": 34,
                        "target": 11,
                        "value": 3
                }, {
                    "source": 34,
                        "target": 29,
                        "value": 2
                }, {
                    "source": 35,
                        "target": 11,
                        "value": 3
                }, {
                    "source": 35,
                        "target": 34,
                        "value": 3
                }, {
                    "source": 35,
                        "target": 29,
                        "value": 2
                }, {
                    "source": 36,
                        "target": 34,
                        "value": 2
                }, {
                    "source": 36,
                        "target": 35,
                        "value": 2
                }, {
                    "source": 36,
                        "target": 11,
                        "value": 2
                }, {
                    "source": 36,
                        "target": 29,
                        "value": 1
                }, {
                    "source": 37,
                        "target": 34,
                        "value": 2
                }, {
                    "source": 37,
                        "target": 35,
                        "value": 2
                }, {
                    "source": 37,
                        "target": 36,
                        "value": 2
                }, {
                    "source": 37,
                        "target": 11,
                        "value": 2
                }, {
                    "source": 37,
                        "target": 29,
                        "value": 1
                }, {
                    "source": 38,
                        "target": 34,
                        "value": 2
                }, {
                    "source": 38,
                        "target": 35,
                        "value": 2
                }, {
                    "source": 38,
                        "target": 36,
                        "value": 2
                }, {
                    "source": 38,
                        "target": 37,
                        "value": 2
                }, {
                    "source": 38,
                        "target": 11,
                        "value": 2
                }, {
                    "source": 38,
                        "target": 29,
                        "value": 1
                }, {
                    "source": 39,
                        "target": 25,
                        "value": 1
                }, {
                    "source": 40,
                        "target": 25,
                        "value": 1
                }, {
                    "source": 41,
                        "target": 24,
                        "value": 2
                }, {
                    "source": 41,
                        "target": 25,
                        "value": 3
                }, {
                    "source": 42,
                        "target": 41,
                        "value": 2
                }, {
                    "source": 42,
                        "target": 25,
                        "value": 2
                }, {
                    "source": 42,
                        "target": 24,
                        "value": 1
                }, {
                    "source": 43,
                        "target": 11,
                        "value": 3
                }, {
                    "source": 43,
                        "target": 26,
                        "value": 1
                }, {
                    "source": 43,
                        "target": 27,
                        "value": 1
                }, {
                    "source": 44,
                        "target": 28,
                        "value": 3
                }, {
                    "source": 44,
                        "target": 11,
                        "value": 1
                }, {
                    "source": 45,
                        "target": 28,
                        "value": 2
                }, {
                    "source": 47,
                        "target": 46,
                        "value": 1
                }, {
                    "source": 48,
                        "target": 47,
                        "value": 2
                }, {
                    "source": 48,
                        "target": 25,
                        "value": 1
                }, {
                    "source": 48,
                        "target": 27,
                        "value": 1
                }, {
                    "source": 48,
                        "target": 11,
                        "value": 1
                }, {
                    "source": 49,
                        "target": 26,
                        "value": 3
                }, {
                    "source": 49,
                        "target": 11,
                        "value": 2
                }, {
                    "source": 50,
                        "target": 49,
                        "value": 1
                }, {
                    "source": 50,
                        "target": 24,
                        "value": 1
                }, {
                    "source": 51,
                        "target": 49,
                        "value": 9
                }, {
                    "source": 51,
                        "target": 26,
                        "value": 2
                }, {
                    "source": 51,
                        "target": 11,
                        "value": 2
                }, {
                    "source": 52,
                        "target": 51,
                        "value": 1
                }, {
                    "source": 52,
                        "target": 39,
                        "value": 1
                }, {
                    "source": 53,
                        "target": 51,
                        "value": 1
                }, {
                    "source": 54,
                        "target": 51,
                        "value": 2
                }, {
                    "source": 54,
                        "target": 49,
                        "value": 1
                }, {
                    "source": 54,
                        "target": 26,
                        "value": 1
                }, {
                    "source": 55,
                        "target": 51,
                        "value": 6
                }, {
                    "source": 55,
                        "target": 49,
                        "value": 12
                }, {
                    "source": 55,
                        "target": 39,
                        "value": 1
                }, {
                    "source": 55,
                        "target": 54,
                        "value": 1
                }, {
                    "source": 55,
                        "target": 26,
                        "value": 21
                }, {
                    "source": 55,
                        "target": 11,
                        "value": 19
                }, {
                    "source": 55,
                        "target": 16,
                        "value": 1
                }, {
                    "source": 55,
                        "target": 25,
                        "value": 2
                }, {
                    "source": 55,
                        "target": 41,
                        "value": 5
                }, {
                    "source": 55,
                        "target": 48,
                        "value": 4
                }, {
                    "source": 56,
                        "target": 49,
                        "value": 1
                }, {
                    "source": 56,
                        "target": 55,
                        "value": 1
                }, {
                    "source": 57,
                        "target": 55,
                        "value": 1
                }, {
                    "source": 57,
                        "target": 41,
                        "value": 1
                }, {
                    "source": 57,
                        "target": 48,
                        "value": 1
                }, {
                    "source": 58,
                        "target": 55,
                        "value": 7
                }, {
                    "source": 58,
                        "target": 48,
                        "value": 7
                }, {
                    "source": 58,
                        "target": 27,
                        "value": 6
                }, {
                    "source": 58,
                        "target": 57,
                        "value": 1
                }, {
                    "source": 58,
                        "target": 11,
                        "value": 4
                }, {
                    "source": 59,
                        "target": 58,
                        "value": 15
                }, {
                    "source": 59,
                        "target": 55,
                        "value": 5
                }, {
                    "source": 59,
                        "target": 48,
                        "value": 6
                }, {
                    "source": 59,
                        "target": 57,
                        "value": 2
                }, {
                    "source": 60,
                        "target": 48,
                        "value": 1
                }, {
                    "source": 60,
                        "target": 58,
                        "value": 4
                }, {
                    "source": 60,
                        "target": 59,
                        "value": 2
                }, {
                    "source": 61,
                        "target": 48,
                        "value": 2
                }, {
                    "source": 61,
                        "target": 58,
                        "value": 6
                }, {
                    "source": 61,
                        "target": 60,
                        "value": 2
                }, {
                    "source": 61,
                        "target": 59,
                        "value": 5
                }, {
                    "source": 61,
                        "target": 57,
                        "value": 1
                }, {
                    "source": 61,
                        "target": 55,
                        "value": 1
                }, {
                    "source": 62,
                        "target": 55,
                        "value": 9
                }, {
                    "source": 62,
                        "target": 58,
                        "value": 17
                }, {
                    "source": 62,
                        "target": 59,
                        "value": 13
                }, {
                    "source": 62,
                        "target": 48,
                        "value": 7
                }, {
                    "source": 62,
                        "target": 57,
                        "value": 2
                }, {
                    "source": 62,
                        "target": 41,
                        "value": 1
                }, {
                    "source": 62,
                        "target": 61,
                        "value": 6
                }, {
                    "source": 62,
                        "target": 60,
                        "value": 3
                }, {
                    "source": 63,
                        "target": 59,
                        "value": 5
                }, {
                    "source": 63,
                        "target": 48,
                        "value": 5
                }, {
                    "source": 63,
                        "target": 62,
                        "value": 6
                }, {
                    "source": 63,
                        "target": 57,
                        "value": 2
                }, {
                    "source": 63,
                        "target": 58,
                        "value": 4
                }, {
                    "source": 63,
                        "target": 61,
                        "value": 3
                }, {
                    "source": 63,
                        "target": 60,
                        "value": 2
                }, {
                    "source": 63,
                        "target": 55,
                        "value": 1
                }, {
                    "source": 64,
                        "target": 55,
                        "value": 5
                }, {
                    "source": 64,
                        "target": 62,
                        "value": 12
                }, {
                    "source": 64,
                        "target": 48,
                        "value": 5
                }, {
                    "source": 64,
                        "target": 63,
                        "value": 4
                }, {
                    "source": 64,
                        "target": 58,
                        "value": 10
                }, {
                    "source": 64,
                        "target": 61,
                        "value": 6
                }, {
                    "source": 64,
                        "target": 60,
                        "value": 2
                }, {
                    "source": 64,
                        "target": 59,
                        "value": 9
                }, {
                    "source": 64,
                        "target": 57,
                        "value": 1
                }, {
                    "source": 64,
                        "target": 11,
                        "value": 1
                }, {
                    "source": 65,
                        "target": 63,
                        "value": 5
                }, {
                    "source": 65,
                        "target": 64,
                        "value": 7
                }, {
                    "source": 65,
                        "target": 48,
                        "value": 3
                }, {
                    "source": 65,
                        "target": 62,
                        "value": 5
                }, {
                    "source": 65,
                        "target": 58,
                        "value": 5
                }, {
                    "source": 65,
                        "target": 61,
                        "value": 5
                }, {
                    "source": 65,
                        "target": 60,
                        "value": 2
                }, {
                    "source": 65,
                        "target": 59,
                        "value": 5
                }, {
                    "source": 65,
                        "target": 57,
                        "value": 1
                }, {
                    "source": 65,
                        "target": 55,
                        "value": 2
                }, {
                    "source": 66,
                        "target": 64,
                        "value": 3
                }, {
                    "source": 66,
                        "target": 58,
                        "value": 3
                }, {
                    "source": 66,
                        "target": 59,
                        "value": 1
                }, {
                    "source": 66,
                        "target": 62,
                        "value": 2
                }, {
                    "source": 66,
                        "target": 65,
                        "value": 2
                }, {
                    "source": 66,
                        "target": 48,
                        "value": 1
                }, {
                    "source": 66,
                        "target": 63,
                        "value": 1
                }, {
                    "source": 66,
                        "target": 61,
                        "value": 1
                }, {
                    "source": 66,
                        "target": 60,
                        "value": 1
                }, {
                    "source": 67,
                        "target": 57,
                        "value": 3
                }, {
                    "source": 68,
                        "target": 25,
                        "value": 5
                }, {
                    "source": 68,
                        "target": 11,
                        "value": 1
                }, {
                    "source": 68,
                        "target": 24,
                        "value": 1
                }, {
                    "source": 68,
                        "target": 27,
                        "value": 1
                }, {
                    "source": 68,
                        "target": 48,
                        "value": 1
                }, {
                    "source": 68,
                        "target": 41,
                        "value": 1
                }, {
                    "source": 69,
                        "target": 25,
                        "value": 6
                }, {
                    "source": 69,
                        "target": 68,
                        "value": 6
                }, {
                    "source": 69,
                        "target": 11,
                        "value": 1
                }, {
                    "source": 69,
                        "target": 24,
                        "value": 1
                }, {
                    "source": 69,
                        "target": 27,
                        "value": 2
                }, {
                    "source": 69,
                        "target": 48,
                        "value": 1
                }, {
                    "source": 69,
                        "target": 41,
                        "value": 1
                }, {
                    "source": 70,
                        "target": 25,
                        "value": 4
                }, {
                    "source": 70,
                        "target": 69,
                        "value": 4
                }, {
                    "source": 70,
                        "target": 68,
                        "value": 4
                }, {
                    "source": 70,
                        "target": 11,
                        "value": 1
                }, {
                    "source": 70,
                        "target": 24,
                        "value": 1
                }, {
                    "source": 70,
                        "target": 27,
                        "value": 1
                }, {
                    "source": 70,
                        "target": 41,
                        "value": 1
                }, {
                    "source": 70,
                        "target": 58,
                        "value": 1
                }, {
                    "source": 71,
                        "target": 27,
                        "value": 1
                }, {
                    "source": 71,
                        "target": 69,
                        "value": 2
                }, {
                    "source": 71,
                        "target": 68,
                        "value": 2
                }, {
                    "source": 71,
                        "target": 70,
                        "value": 2
                }, {
                    "source": 71,
                        "target": 11,
                        "value": 1
                }, {
                    "source": 71,
                        "target": 48,
                        "value": 1
                }, {
                    "source": 71,
                        "target": 41,
                        "value": 1
                }, {
                    "source": 71,
                        "target": 25,
                        "value": 1
                }, {
                    "source": 72,
                        "target": 26,
                        "value": 2
                }, {
                    "source": 72,
                        "target": 27,
                        "value": 1
                }, {
                    "source": 72,
                        "target": 11,
                        "value": 1
                }, {
                    "source": 73,
                        "target": 48,
                        "value": 2
                }, {
                    "source": 74,
                        "target": 48,
                        "value": 2
                }, {
                    "source": 74,
                        "target": 73,
                        "value": 3
                }, {
                    "source": 75,
                        "target": 69,
                        "value": 3
                }, {
                    "source": 75,
                        "target": 68,
                        "value": 3
                }, {
                    "source": 75,
                        "target": 25,
                        "value": 3
                }, {
                    "source": 75,
                        "target": 48,
                        "value": 1
                }, {
                    "source": 75,
                        "target": 41,
                        "value": 1
                }, {
                    "source": 75,
                        "target": 70,
                        "value": 1
                }, {
                    "source": 75,
                        "target": 71,
                        "value": 1
                }, {
                    "source": 76,
                        "target": 64,
                        "value": 1
                }, {
                    "source": 76,
                        "target": 65,
                        "value": 1
                }, {
                    "source": 76,
                        "target": 66,
                        "value": 1
                }, {
                    "source": 76,
                        "target": 63,
                        "value": 1
                }, {
                    "source": 76,
                        "target": 62,
                        "value": 1
                }, {
                    "source": 76,
                        "target": 48,
                        "value": 1
                }, {
                    "source": 76,
                        "target": 58,
                        "value": 1
                }]
            }
        </script>
        
        
        
    </div>
 </div>
 -->


<div dojoType="dijit.TitlePane" title="Genes" style ="padding:0px;font-size : 10px;">
    <div dojoType="dijit.layout.BorderContainer" style =" border-color:#037889;box-shadow: #B3B3B3 2px 2px 2px;width:100%;height:555px;font-size : 10px;"> 
        <div dojoType="dijit.layout.ContentPane" region="top" style="padding:0px; " splitter="false"> 
            <div  dojoType="dijit.Toolbar" id="toolbar_2" style ="font-size:9px;height:35px;">
                <center>
                    <table>
                        <td>
                            <div><span class="filterLabelActif2">Gene(s) Selection</span></div>
                        </td>
                        
                        <td style="padding-left: 5px;">
                            <img src="../images/polyicons/man-icon24.png" id="repet_ind_fam_som" style="vertical-align:middle" height="20" width="20"/>
                            <span id="txt_repet_ind_fam_som">Individual</span>
                        </td>
                        
                        <td style="padding-left: 5px;">
                            <span dojoType="dijit.ToolbarSeparator"></span>
                        </td>
                        
                        <td style="padding-left: 5px;">
                            <div id="b_intersect_genes" dojoType="dijit.form.Button" iconClass="dijitEditorIcon dijitEditorIconCreateLink" onClick="viewPatientsImplicated('intersection')" showLabel="true">
                                Intersect
                            </div>
                        </td>
                        
                        <td style="padding-left: 5px;">
                            <div id="b_or_genes" dojoType="dijit.form.Button"  iconClass="dijitEditorIcon dijitEditorIconUnlink" showLabel="true" onClick="viewPatientsImplicated('union')">
                                Or
                            </div>
                        </td>
                        
                        <td style="padding-left: 5px;" id='tr_commons_details'>
                            <table>
                                <tr><div id="div_info_pat_commons"><span id="span_info_pat_commons"></span></div></tr>
                                <tr>
                                    <div id="div_info_fam_commons"><span id="span_info_fam_commons"></span></div>
                                    <!--
                                    <div data-dojo-type="dijit/Tooltip" data-dojo-props="connectId:'div_info_fam_commons',position:['below']">
                                        <div id="div_tooltip_commons" style="width: 350px;height: 350px;">
                                            <div id="gridCommonPatients"  class="grid" dojoType="dojox.grid.DataGrid" jsId="gridCommonPatients"  selectable="1" style="width=100%;height:85%;padding:1px" structure="layoutGridCommonPatients"> </div>
                                        </div>
                                    </div>
                                    -->
                                </tr>
                            </table>
                        </td>
                        
                        <td style="padding-left: 5px;">
                            <span dojoType="dijit.ToolbarSeparator"></span>
                        </td>
                        
                        <!--
                        <td style="padding-left: 5px;">
                            <span>&nbsp; At Least </span> 
                            <input id="at_least_genes" jsId="at_least_genes" type="text" dojoType="dijit.form.NumberTextBox" onchange="do_at_least_genes()" value="1" constraints="{min:-1,max:999,places:0}"  invalidMessage="Invalid number." style="width: 3em;"/>
                            <span id="at_least_genes_text">Patient</span>
                        </td>
                        -->
                        
                        <td style="padding-left: 12px;">
                            <div><span class="filterLabelActif2">Visualization</span></div>
                       </td>
                       
                       <td style="padding-left:5px;">
                            <div dojoType="dijit.form.Button" id='b_viewSelectedGenesVar' iconClass="dijitEditorIcon dijitEditorIconInsertUnorderedList" showLabel="true" onClick="goViewSelectedlVar" disabled>
                                <span id='span_nb_sel_genes'>View <b>ALL</b> Genes</span>
                            </div>
                       </td>
                       
                       <td style="padding-left:5px;" hidden>
	                        <div dojoType="dijit.form.Button" id="b_go_to_polydiag" iconClass="dijitEditorIcon dijitEditorIconSelectAll" onClick='go_to_polydiag();' showLabel="true" disabled hidden>
	                             Diag View
	                        </div>
                       </td>
                       
                       <td style="padding-left:5px;">
                            <div dojoType="dijit.form.Button" id='b_viewRegionsHoRec' iconClass="dijitEditorIcon dijitEditorIconInsertUnorderedList" showLabel="true" onClick="show_regions_ho_rec()" disabled>
                                <span id='span_view_regions_ho_rec'>View <b>Ho Regions</b></span>
                            </div>
                       </td>
                       
                       <!--
                        <td style="padding-left: 5px;">
                            <button type="button" id="startButtonAllGenes" onMouseOver="checkMessageError()" style="float=right" disabled>
                                <table>
                                    <td>
                                        <span style="font-size:8px;padding-bottom: 0px;"><img id='img_run_2' src="../images/polyicons/run_2.png"></span>
                                    </td>
                                    <td>
                                        <span id="span_run_msg_all_genes" style="font-size:10px;"><b>&nbsp;&nbsp;LIST ALL Genes&nbsp;</b></span>
                                    </td>
                                </table>
                            </button>
                            <input type="checkbox" id="b_view_all_genes" onClick='run_view_all_genes()' disabled="" hidden> </input>
                        </td>
                        -->
                        <td>
                            <input type="checkbox" id="b_view_all_genes" onClick='run_view_all_genes()' disabled="" hidden> </input>
                        </td>
                    </table>
                </center>
            </div>
        </div>
        <div id="div_gridListGenes" dojoType="dijit.layout.ContentPane" splitter="false" region="bottom" style="padding:0px;padding:0px;height:500px" splitter="false"> 
            <div id="gridListGenes"  dojoType="dojox.grid.EnhancedGrid" data-dojo-props="plugins:{indirectSelection: true}" jsId="gridListGenes" keepSelection="true" rowcount="10000" structure="layoutListGenes" style="height:500px;" onmousemove="display_b_viewSelectedGenesVar"></div>
        </div>
    </div>          
    </div>
</div>



</div>
    <footer> 
        
    <div id="footer1">
        <span class="div-logo-paris-descartes"> </span>
        <span class="div-logo-imagine"> </span>
    </div>
    </footer>
        <!-- div pour le message de chargement des donnes -->

	<div dojoType="dijit.Dialog" jsId="resume_check" id="resume_check" title="Resume Check Project">
		<center>
            <table>
                <tr>
                    <td style="width:50px"><center>CHR1</center></td>
                    <td style="width:100px"><center><span id="status_check_1">Not Tested</span></center></td>
                </tr>
                <tr>
                    <td style="width:50px"><center>CHR2</center></td>
                    <td style="width:100px"><center><span id="status_check_2">Not Tested</span></center></td>
                </tr>
                <tr>
                    <td style="width:50px"><center>CHR3</center></td>
                    <td style="width:100px"><center><span id="status_check_3">Not Tested</span></center></td>
                </tr>
                <tr>
                    <td style="width:50px"><center>CHR4</center></td>
                    <td style="width:100px"><center><span id="status_check_4">Not Tested</span></center></td>
                </tr>
                <tr>
                    <td style="width:50px"><center>CHR5</center></td>
                    <td style="width:100px"><center><span id="status_check_5">Not Tested</span></center></td>
                </tr>
                <tr>
                    <td style="width:50px"><center>CHR6</center></td>
                    <td style="width:100px"><center><span id="status_check_6">Not Tested</span></center></td>
                </tr>
                <tr>
                    <td style="width:50px"><center>CHR7</center></td>
                    <td style="width:100px"><center><span id="status_check_7">Not Tested</span></center></td>
                </tr>
                <tr>
                    <td style="width:50px"><center>CHR8</center></td>
                    <td style="width:100px"><center><span id="status_check_8">Not Tested</span></center></td>
                </tr>
                <tr>
                    <td style="width:50px"><center>CHR9</center></td>
                    <td style="width:100px"><center><span id="status_check_9">Not Tested</span></center></td>
                </tr>
                <tr>
                    <td style="width:50px"><center>CHR10</center></td>
                    <td style="width:100px"><center><span id="status_check_10">Not Tested</span></center></td>
                </tr>
                <tr>
                    <td style="width:50px"><center>CHR11</center></td>
                    <td style="width:100px"><center><span id="status_check_11">Not Tested</span></center></td>
                </tr>
                <tr>
                    <td style="width:50px"><center>CHR12</center></td>
                    <td style="width:100px"><center><span id="status_check_12">Not Tested</span></center></td>
                </tr>
                <tr>
                    <td style="width:50px"><center>CHR13</center></td>
                    <td style="width:100px"><center><span id="status_check_13">Not Tested</span></center></td>
                </tr>
                <tr>
                    <td style="width:50px"><center>CHR14</center></td>
                    <td style="width:100px"><center><span id="status_check_14">Not Tested</span></center></td>
                </tr>
                <tr>
                    <td style="width:50px"><center>CHR15</center></td>
                    <td style="width:100px"><center><span id="status_check_15">Not Tested</span></center></td>
                </tr>
                <tr>
                    <td style="width:50px"><center>CHR16</center></td>
                    <td style="width:100px"><center><span id="status_check_16">Not Tested</span></center></td>
                </tr>
                <tr>
                    <td style="width:50px"><center>CHR17</center></td>
                    <td style="width:100px"><center><span id="status_check_17">Not Tested</span></center></td>
                </tr>
                <tr>
                    <td style="width:50px"><center>CHR18</center></td>
                    <td style="width:100px"><center><span id="status_check_18">Not Tested</span></center></td>
                </tr>
                <tr>
                    <td style="width:50px"><center>CHR19</center></td>
                    <td style="width:100px"><center><span id="status_check_19">Not Tested</span></center></td>
                </tr>
                <tr>
                    <td style="width:50px"><center>CHR20</center></td>
                    <td style="width:100px"><center><span id="status_check_20">Not Tested</span></center></td>
                </tr>
                <tr>
                    <td style="width:50px"><center>CHR21</center></td>
                    <td style="width:100px"><center><span id="status_check_21">Not Tested</span></center></td>
                </tr>
                <tr>
                    <td style="width:50px"><center>CHR22</center></td>
                    <td style="width:100px"><center><span id="status_check_22">Not Tested</span></center></td>
                </tr>
                <tr>
                    <td style="width:50px"><center>CHRX</center></td>
                    <td style="width:100px"><center><span id="status_check_X">Not Tested</span></center></td>
                </tr>
                <tr>
                    <td style="width:50px"><center>CHRY</center></td>
                    <td style="width:100px"><center><span id="status_check_Y">Not Tested</span></center></td>
                </tr>
                <tr>
                    <td style="width:50px"><center>CHRMT</center></td>
                    <td style="width:100px"><center><span id="status_check_MT">Not Tested</span></center></td>
                </tr>
            </table>
		</center>
    </div>
        
    <div dojoType="dijit.Dialog" jsId="checking" id="checking" style="height:80px" title="Please wait...">
        Checking Your Project...<img id="check1" src="../images/polyicons/wait18trans.gif" align="absmiddle">
    </div>
    
    <div dojoType="dijit.Dialog" jsId="waiting" id="waiting" style="height:80px" title="Running...">
        <span id="waiting_text">Loading Data...</span><img id="wait1" src="../images/polyicons/wait18trans.gif" align="absmiddle">
    </div>
    
    <div dojoType="dijit.Dialog" jsId="waiting_progress" id="waiting_progress" style="height:80px" title="Running...">
        <div data-dojo-type="dijit/ProgressBar" style="width:300px" data-dojo-id="myProgressBar" id="myProgressBar" data-dojo-props="maximum:75"></div>
        <br>
        <span id="waiting_progress_text">Loading Data...</span>
    </div>
    
        <!-- div pour le login -->
       <div id="login" dojoType="dijit.Dialog" title="Login">
      <div dojoType="dijit.TooltipDialog" id="dialog1" title="Login Form" execute="setPassword(arguments[0]);">
     <form method="post" class="signin" action="#">
                <fieldset class="textbox">
                <label class="username">
                <span>Username</span>
                <input id="username" name="username" value="" type="text" autocomplete="on" placeholder="Username">
                </label>
                <label class="password">
                <span>Password</span>
                <input id="passwd" name="password" value="" type="password" placeholder="Password"/>
                </label>
                </fieldset>
          </form>
                    <div align="center">
                    <div   type="submit" dojoType="dijit.form.Button" iconClass="loginIcon"  showLabel="true">
                            <div style='width:150px'>Sign in</div>

                    </div>
            </div>
                  
                       
            </div>
        </div>

<div dojoType="dijit.Dialog" jsId="dialog_export_url" id="dialog_export_url" title="Export URL">
    <span id='span_export_url'></span>
</div>
      
<div id="dialog_view_capture" jsId = "dialog_view_capture" dojoType="dijit.Dialog" title="view" style="height:300px;width:500px" >
    
    <div  style="height:200px;width:100%;" id="gridViewCapture" class="grid" dojoType="dojox.grid.DataGrid" jsId="gridViewCapture" structure="layoutViewCapture">          
    </div>  
    <br>
    <center>
        <div dojoType="dijit.form.Button" id="cancelListGenes" iconClass="dijitEditorIcon dijitEditorIconSelectAll" onClick='dialog_view_capture.hide();' showLabel="true">
              Cancel
        </div>
        <div dojoType="dijit.form.Button" id="loadListGenes" iconClass="dijitEditorIcon dijitEditorIconSave" showLabel="true" onClick='run_capture();'> 
              Load
        </div>           
    </center>
 
</div>
        
        
<div id="dialog_view_filter" jsId = "dialog_view_filter" dojoType="dijit.Dialog" title="view" style="height:300px;width:500px" >
    
    <div  style="height:200px;width:100%;" id="gridViewFilter" class="grid" dojoType="dojox.grid.DataGrid" jsId="gridViewFilter" structure="layoutViewFilter">          
    </div>  
    <br>
    <center>
     <div dojoType="dijit.form.Button" id="cancel1" iconClass="dijitEditorIcon dijitEditorIconSelectAll" onClick='dialog_view_filter.hide();' showLabel="true">
                                 Cancel
                            </div>
    <div dojoType="dijit.form.Button" id="load1" iconClass="dijitEditorIcon dijitEditorIconSave" showLabel="true" onClick='loadFilter();'> 
                            Load
            </div>
    </center>
 
</div>


<div id="dialog_patient_polydiag" jsId = "dialog_patient_polydiag" dojoType="dijit.Dialog" title="PolyDiag View" style="height:99%;width:99%;" onHide="hidePopupDiag()">
    <div  id="div_res_patient_polydiag" jsId="div_res_patient_polydiag" data-dojo-type="dijit/layout/ContentPane">
	</div>
</div>

<div id="dialog_filter" jsId = "dialog_filter" dojoType="dijit.Dialog" title="Save your filter" style="overflow-y:scroll;">
    <div dojoType="dijit.form.Form" id="myForm" jsId="myForm" encType="multipart/form-data" action="save_filter.pl" method="post" style="overflow-y:scroll;">
         <table style="border: 1px solid #9f9f9f;overflow-y:scroll;" cellspacing="10">
             <tr>
                <td > <label for="name"> Name:</label> </td>
                <td><input type="text" name="name" required="true" dojoType="dijit.form.ValidationTextBox"/></td>
            </tr>
            <tr>
                <td ><label for="filter Region">  Region</label></td>
                <td><input type="text"  name="filter_region"  dojoType="dijit.form.ValidationTextBox"/></td>
            </tr>
            <tr><td><hr></td><td><hr></td></tr>
            <tr>
                <td > <label for="filter_not_patient"> Not Samples</label> </td>
                <td><input type="text"  name="filter_not_patient"  dojoType="dijit.form.ValidationTextBox"/></td>
            </tr>
            <tr>
                <td > <label for="filter_attic"> Attic Samples</label> </td>
                <td><input type="text"  name="filter_attic"  dojoType="dijit.form.ValidationTextBox"/></td>
            </tr>
            <tr>
                <td > <label for="filter_patient"> And  Samples</label> </td>
                <td><input type="text"  name="filter_patient"  dojoType="dijit.form.ValidationTextBox"/></td>
            </tr>
            <tr>
                <td > <label for="filter_he"> Heterozygote</label> </td>
                <td><input type="text"  name="filter_he"  dojoType="dijit.form.ValidationTextBox"/></td>
            </tr>
            <tr>
                <td > <label for="filter_ho"> Homozygote</label> </td>
                <td><input type="text"  name="filter_ho"  dojoType="dijit.form.ValidationTextBox"/></td>
            </tr>
            <tr><td><hr></td><td><hr></td></tr>
            <tr>
                <td > <label for="filter_dejavu"> DejaVu</label> </td>
                <td><input type="text"  name="filter_dejavu"  dojoType="dijit.form.ValidationTextBox"/></td>
            </tr>
            <tr>
                <td > <label for="filter_dejavuho"> DejaVu Only Ho</label> </td>
                <td><input type="text"  name="filter_dejavuho"  dojoType="dijit.form.ValidationTextBox"/></td>
            </tr>
            <tr><td><hr></td><td><hr></td></tr>
            <tr>
                <td > <label for="filter_fam"> AND Families</label> </td>
                <td><input type="text"  name="filter_fam"  dojoType="dijit.form.ValidationTextBox"/></td>
            </tr>
            <tr>
                <td > <label for="filter_not_fam"> NOT Families</label> </td>
                <td><input type="text"  name="filter_not_fam"  dojoType="dijit.form.ValidationTextBox"/></td>
            </tr>
            <tr><td><hr></td><td><hr></td></tr> 
            <tr>
                <td > <label for="filter_gene_level"> Gene level</label> </td>
                <td><input type="text"  name="filter_gene_level"  dojoType="dijit.form.ValidationTextBox"/></td>
            </tr>
            <tr>
                <td > <label for="filter_type_variation"> Functional</label> </td>
                <td><input type="text"  name="filter_type_variation"  dojoType="dijit.form.ValidationTextBox"/></td></tr>
            <tr>
                <td > <label for="model"> Genetic model</label> </td>
                <td><input type="text"  name="filter_genetic_model"  dojoType="dijit.form.ValidationTextBox"/></td>
            </tr>
            <tr>
                <td > <label for="type"> Type </label> </td>
                <td><input type="text"  name="filter_mode"  dojoType="dijit.form.ValidationTextBox"/></td>
            </tr>
            <tr>
                <td > <label for="level_ind"> Level individual</label> </td>
                <td><input type="text"  name="filter_level_ind"  dojoType="dijit.form.ValidationTextBox"/></td>
            </tr>
            <tr>
                <td > <label for="level_fam"> Level familial</label> </td>
                <td><input type="text"  name="filter_level_fam"  dojoType="dijit.form.ValidationTextBox"/></td>
            </tr>
            <tr><td><hr></td><td><hr></td></tr> 
            <tr>
                <td > <label for="level_fam"> Only genes</label> </td>
                <td><input type="text"  name="filter_level_only_genes"  dojoType="dijit.form.ValidationTextBox"/></td>
            </tr>
            <tr><td><hr></td><td><hr></td></tr> 
            <tr><td><input type="text"  name="project"  dojoType="dijit.form.ValidationTextBox"/></td></tr>
            <tr><td><input id="filter_username" jsId = "filter_username" type="text"  name="user"  dojoType="dijit.form.ValidationTextBox"/></td></tr>
            <tr><td colspan="2" style="font-size:150%;">
            <button dojoType="dijit.form.Button" type="button" onclick="saveFilter();">SAVE</button>
            </td>
            </tr>
         </table>
    </div>  
</div>

<div dojoType="dijit.Dialog" jsId="dialog_genes_capture" id="dialog_genes_capture" title="Genes In This Capture File">
	<div id="gridGenesInCapture" dojoType="dojox.grid.DataGrid" selectable="1" jsId="gridGenesInCapture" rowcount="10000" style="width:300px;height:600px;" structure="layoutGridGenesUser"></div>
</div>

<div dojoType="dijit.Dialog" jsId="dialog_regions_ho_rec" id="dialog_regions_ho_rec" title="List Ho Regions">
	<center><input style="width:99%;" type="text" id="text_search_region_ho_rec" onkeyup="searchElemInGridHoRec()" placeholder="Search for family / patient name..." hidden></center>
    <button id="b_export_xls_regions_ho" dojoType="dijit.form.Button" onClick='export_regions_ho_xls()' iconClass="exportIcon" style="padding-left:15px">
        <b>XLS</b> regions HO
    </button>
	<div id="gridRegionsHoRec" dojoType="dojox.grid.DataGrid" canSort="false" selectable="1" jsId="gridRegionsHoRec" rowcount="10000" style="width:800px;height:600px;" structure="layoutGridRegionsHoRec"></div>
</div>

  
 <div dojoType="dijit.Dialog" jsId="dialog_region" id="dialog_region" title="Copy / Paste region">  

 <div  style="width: 250px; height: 300px;">
 
  <table>
    <tr><td>Example Format : <b>1 100 10000</b><br> <i>(ie chr1 start 100 ==> end 10000)</i></td></tr>
    <tr><td>
        <button dojoType="dijit.form.Button" type="button" onclick="addRegion('[\n]+','[ \t]+');">Load </button>
    </td></tr>
    <tr><td>
   <textarea jsId="text_region"  dojoType="dijit.form.SimpleTextarea"  style="width:239px;height:244px;"></textarea>
       </td></tr>
      </table> 
    </div>
</div>

<!--TODO: here-->
<!--
<div dojoType="dijit.Dialog" jsId="dialog_list_genes" id="dialog_list_genes" title="Add Genes">
    <div  style="width:500px;height:500px;">
        <div dojoType="dijit.layout.TabContainer" style="width:100%;height:470px">
            <div dojoType="dijit.layout.ContentPane" title="Captures" style="padding:1px">
                <div id="div_tree_captures" style="overflow-x:hidden;overflow-y:auto;height=100%;"></div>
            </div>
            <div dojoType="dijit.layout.ContentPane" title="List Genes" style="padding:2px">
                <div>
                    <br><br><b>One gene name by line:</b><br><br>
                    <textarea jsId="text_list_genes"  dojoType="dijit.form.SimpleTextarea"  style="width:483px;height:385px;"></textarea>
                </div>
            </div>
        </div>
        <div  dojoType="dijit.Toolbar">
            <center>
                <div dojoType="dijit.form.Button" iconClass="plusIcon" onClick='addGenes();' showLabel="true">
                    Add Genes
                </div>
                <span dojoType="dijit.ToolbarSeparator"></span>
                <div dojoType="dijit.form.Button" iconClass="dijitEditorIcon dijitEditorIconDelete" onClick='unCheckedAllGenes();' showLabel="true">
                    Uncheck All
                </div>
                <div dojoType="dijit.form.Button" iconClass="refreshIcon" onClick='closeAllNodes();' showLabel="true">
                    Collapse All Nodes
                </div>
            </center>
        </div>
    </div>
</div>
-->
    
<div dojoType="dijit.Dialog" jsId="dialog_list_genes" id="dialog_list_genes" title="Add Genes" style="width:750px;height:500px;">
    <div dojoType="dijit.layout.BorderContainer" style="width:100%;height:440px">
        <div data-dojo-type="dijit/layout/ContentPane" data-dojo-props="splitter:true, region:'leading'" style="min-width:400px;">
            <b>Select genes from captures files:</b><br>
            <div id="div_tree_captures" style="overflow-x:hidden;overflow-y:auto;"></div>
        </div>
        <div data-dojo-type="dijit/layout/ContentPane" data-dojo-props="splitter:true, region:'center'">
            <b>Your genes </b>(<u>one gene per line, no space</u>):<br><br>
            <textarea jsId="text_list_genes"  dojoType="dijit.form.SimpleTextarea"  style="width:99%;height:396px;resize:none;border-radius:0;font-size:12px;"></textarea>
        </div>
    </div>
    <div  dojoType="dijit.Toolbar">
        <center>
            <div dojoType="dijit.form.Button" iconClass="plusIcon" onClick='addGenes();' showLabel="true">
                Add Genes
            </div>
            <span dojoType="dijit.ToolbarSeparator"></span>
            <div dojoType="dijit.form.Button" iconClass="dijitEditorIcon dijitEditorIconDelete" onClick='unCheckedAllGenes();' showLabel="true">
                Uncheck All
            </div>
            <!--
            <div dojoType="dijit.form.Button" iconClass="refreshIcon" onClick='closeAllNodes();' showLabel="true">
                Collapse All Nodes
            </div>
            -->
        </center>
    </div>
</div>
    
    <div dojoType="dijit.Dialog" jsId="dialog_compound_multi_annot" id="dialog_compound_multi_annot" title="Familial Compound Model - Multi Annotation" style="width:auto;height:auto;" >
			<div dojoType="dijit.layout.ContentPane" region="top">
				<br><br>
				<center><b><span style="font-size:14px;"><font color="red">RESUME</font> FIRST VARIANT</span></b></center>
				<br><br>
	            <div dojoType="dijit.Toolbar" style="font-size:9px;" id="toolbar_fam_compound_init_var">
	                <center>
	                <table>
	                    <td style="padding-left:10px;"> 
	                        <div><span class="filterLabelActif2">DB Public</span></div>
	                    </td>
	                    <td>
	                        <!-- DB public -->
	                        <div jsId="dd_db_public_2" data-dojo-type="dijit.form.DropDownButton" data-dojo-props="iconClass:'dijitIconFilter'">
	                            <span>Options (All)</span>
	                            <div data-dojo-type="dijit.TooltipDialog" onHide='update_choice_filter()' >
	                                <div  dojoType="dijit.Toolbar" style ="font-size : 10px;">
	                                    <table style="border:1px solid #9f9f9f;">
	                                        <!--
	                                        <td>
	                                            <div style="padding:5px;border:1px solid #9f9f9f;" id="div_b_global">
	                                                <table>
	                                                    <tr>
	                                                        <span><i><u>Global</i></u></span>
	                                                    </tr>
	                                                    <tr>
	                                                        <td style="padding:5px;"><input type="checkbox" id="filter_clinical_init" data-dojo-type="dojox/mobile/Switch" value="on"  leftLabel="Clinical" rightLabel="Clinical" style="width: 75px;"></td>
	                                                        <td style="padding:5px;display:none;"><input type="checkbox" id="filter_nofreq_init" data-dojo-type="dojox/mobile/Switch" value="off"  leftLabel="No Freq" rightLabel="No Freq" style="width: 65px;"></td>
	                                                    </tr>
	                                                </table>
	                                                
	                                            </div>
	                                        </td>
	                                        <td>
	                                            <div style="padding:5px;border:1px solid #9f9f9f;" id="div_b_somatic">
	                                                <table>
	                                                    <tr>
	                                                        <span><i><u>With Somatic Model</i></u></span>
	                                                    </tr>
	                                                    <tr>
	                                                        <td style="padding:5px;"><input type="checkbox" onmouseleave="checkSomaticButton('filter_not_cosmic')" id="filter_not_cosmic_init" data-dojo-type="dojox/mobile/Switch" value="on"  leftLabel="Not Cosmic" rightLabel="Not Cosmic" style="width: 90px;"></td>
	                                                        <td style="padding:5px;"><input type="checkbox" onmouseleave="checkSomaticButton('filter_cosmic')" id="filter_cosmic_init" data-dojo-type="dojox/mobile/Switch" value="on"  leftLabel="In Cosmic" rightLabel="In Cosmic" style="width: 90px;"></td>
	                                                    </tr>
	                                                </table>
	                                            </div>
	                                        </td>
	                                        -->
	                                        <td style="padding:5px;"><input type="checkbox" id="filter_clinical_init" data-dojo-type="dojox/mobile/Switch" value="on" leftLabel="Clinical" rightLabel="Clinical" style="width:65px;"></td>
	                                        <td style="padding:5px;display:none;"><input type="checkbox" id="filter_nofreq_init" data-dojo-type="dojox/mobile/Switch" value="off"  leftLabel="No Freq" rightLabel="No Freq" style="width: 65px;"></td>
	                                        <td style="padding:5px;display:none;"><input type="checkbox" onmouseleave="checkSomaticButton('filter_not_cosmic_init')" id="filter_not_cosmic_init" data-dojo-type="dojox/mobile/Switch" value="on"  leftLabel="Not Cosmic" rightLabel="Not Cosmic" style="width: 90px;"></td>
	                                        <td style="padding:5px;display:none;"><input type="checkbox" onmouseleave="checkSomaticButton('filter_cosmic_init')" id="filter_cosmic_init" data-dojo-type="dojox/mobile/Switch" value="on"  leftLabel="In Cosmic" rightLabel="In Cosmic" style="width: 90px;"></td>
	                                    </table>
	                                </div>
	                            </div>
	                        </div>
	                        <br>
	                        <div>
	                            <table align="center" valign="center">
	                                <td>
	                                    <div id="slider_frequence_init" onChange="check_slider_freq_init()" jsId="slider_frequence_init" data-dojo-type="dijit/form/HorizontalSlider" aria-label="slider 3" data-dojo-props='name:"horizontal2",minimum:1,value:5,maximum:5,discreteValues:5,showButtons:false,intermediateChanges:true,slideDuration:0,style:"width:150px; height: 25px;"' disabled>
	                                        <div data-dojo-type="dijit/form/HorizontalRule" data-dojo-props='container:"bottomDecoration", count:5, style:{height:"5px"}'> </div>
	                                        <ol data-dojo-type="dijit/form/HorizontalRuleLabels" data-dojo-props='container:"bottomDecoration", style:{height:"1em", fontSize:"100%"}'>
	                                            <li><font color="#EA3434">&#10877;1&#8241;</font></li>
	                                            <li><font color="#EA3434">&#10877;1&#8240;</font></li>
	                                            <li><font color="#EAA134">&#10877;1&#37;</font></li>
	                                            <li><font color="#EACC34">&#10877;5&#37;</font></li>
	                                            <li><font color="#28A24C">All</font></li>
	                                        </ol>
	                                    </div>
	                                </td>
	                            </table>
	                        </div>
	                    </td>
	                    <td style="padding-left: 10px"> 
	                        <div><span class="filterLabelActif2">Check Deja Vu</span></div>
	                  	</td>
	                   <td>
	                        <div id="slider_dejavu_init" jsId="slider_dejavu_init" onChange="check_slider_dejavu_init()" data-dojo-type="dijit/form/HorizontalSlider" aria-label="slider 3" data-dojo-props='name:"horizontal2",minimum:0,value:100,maximum:100,discreteValues:100,showButtons:false,intermediateChanges:true,slideDuration:0,style:"width:230px; height: 25px;margin-left:20px;"' disabled>
	                            <div>
	                                <div data-dojo-type="dijit/form/HorizontalRule" data-dojo-props='container:"bottomDecoration", count:11, style:{height:"5px"}'> </div>
	                                <ol data-dojo-type="dijit/form/HorizontalRuleLabels" data-dojo-props='container:"bottomDecoration", style:{height:"1em", fontSize:"100%"}'>
	                                    <li><span><font color="#EA3434">0</font></span></li>
	                                    <li><span><font color="#EA3434">10</font></span></li>
	                                    <li><span><font color="#EAA134">20</font></span></li>
	                                    <li><span><font color="#EAA134">30</font></span></li>
	                                    <li><span><font color="#EACC34">40</font></span></li>
	                                    <li><span><font color="#EACC34">50</font></span></li>
	                                    <li><span><font color="#28A24C">60</font></span></li>
	                                    <li><span><font color="#28A24C">70</font></span></li>
	                                    <li><span><font color="#28A24C">80</font></span></li>
	                                    <li><span><font color="#28A24C">90</font></span></li>
	                                    <li><span id="nb_projects_init"/></li>
	                                </ol>
	                                <ol data-dojo-type="dijit/form/HorizontalRuleLabels" data-dojo-props="container: 'topDecoration'" style="height: 1.3em;">
	                                    <li><font color="#EA3434"><span><i>None</i></span></font></li>
	                                    <li><span id="text_dejavu_init"><i><b>Others</b> Projects: </i></span><span style="font-weight: bold;color: #28A24C" id ="nb_dejavu_init"></li>
	                                    <li><font color="#28A24C"><span><i>All</i></span></font></li>
	                                </ol>
	                            </div>
	                        </div>
	                    </td>
	                    <td style="padding-left: 10px"> 
	                        <div><span class="filterLabelActif2">Annotations</span></div>
	                  	</td>
	                    <td style="padding-left: 10px;">
		                    <table>
		                        <tr>
		                            <td style="font-size:9px;">
		                                <input type="checkbox" dojoType="dijit.form.CheckBox" id="filter_maturemirna_init">
		                                <span id="span_maturemirna_init"></span><span style="color:red;" id="span_filter_maturemirna_multi_compound_init"></span>
		                            </td>
		                            <td style="font-size:9px;">
		                                <input type="checkbox" dojoType="dijit.form.CheckBox" id="filter_essential_splicing_init">
		                                <span id="span_essential_splicing_init"></span><span style="color:red;" id="span_filter_essential_splicing_multi_compound_init"></span>
		                            </td>
		                            <td style="font-size:9px;">
		                                <input type="checkbox" dojoType="dijit.form.CheckBox" id="filter_frameshift_init">
		                                <span id="span_frameshift_init"></span><span style="color:red;" id="span_filter_frameshift_multi_compound_init"></span>
		                            </td>
		                            <td style="font-size:9px;">
		                                <input type="checkbox" dojoType="dijit.form.CheckBox" id="filter_stop_init">
		                                <span id="span_stop_init"></span><span style="color:red;" id="span_filter_stop_multi_compound_init"></span>
		                            </td>
		                            <td style="font-size:9px;">
		                                <input type="checkbox" dojoType="dijit.form.CheckBox" id="filter_phase_init">
		                                <span id="span_phase_init"></span><span style="color:red;" id="span_filter_phase_multi_compound_init"></span>
		                            </td>
		                        </tr>
		                        <tr>
		                            <td style="font-size:9px;">
		                                <input type="checkbox" dojoType="dijit.form.CheckBox" id="filter_ncrna_init">
		                                <span id="span_ncrna_init"></span><span style="color:red;" id="span_filter_ncrna_multi_compound_init"></span>
		                            </td>
		                            <td style="font-size:9px;">
		                                <input type="checkbox" dojoType="dijit.form.CheckBox" id="filter_splice_site_init">
		                                <span id="span_splice_site_init"></span><span style="color:red;" id="span_filter_splice_site_multi_compound_init"></span>
		                            </td>
		                            <td style="font-size:9px;">
		                                <input type="checkbox" dojoType="dijit.form.CheckBox" id="filter_predicted_splice_site_init">
		                                <span id="span_predicted_splice_site_init"></span><span style="color:red;" id="span_filter_predicted_splice_site_multi_compound_init"></span>
		                            </td>
		                            <td style="font-size:9px;">
		                                <input type="checkbox" dojoType="dijit.form.CheckBox" id="filter_nonsynonymous_init">
		                                <span id="span_nonsynonymous_init"></span><span style="color:red;" id="span_filter_nonsynonymous_multi_compound_init"></span>
		                            </td>
		                            <td style="font-size:9px;">
		                                <input type="checkbox" dojoType="dijit.form.CheckBox" id="filter_nonframeshift_init">
		                                <span id="span_nonframeshift_init"></span><span style="color:red;" id="span_filter_nonframeshift_multi_compound_init"></span>
		                            </td>
		                        </tr>
		                        <tr>
		                            <td style="font-size:9px;">
		                                <input type="checkbox" dojoType="dijit.form.CheckBox" id="filter_pseudogene_init">
		                                <span id="span_pseudogene_init"></span><span style="color:red;" id="span_filter_pseudogene_multi_compound_init"></span>
		                            </td>
		                            <td style="font-size:9px;">
		                                <input type="checkbox" dojoType="dijit.form.CheckBox" id="filter_utr_init">
		                                <span id="span_utr_init"></span><span style="color:red;" id="span_filter_utr_multi_compound_init"></span>
		                            </td>
		                            <td style="font-size:9px;">
		                                <input type="checkbox" dojoType="dijit.form.CheckBox" id="filter_silent_init">
		                                <span id="span_silent_init"></span><span style="color:red;" id="span_filter_silent_multi_compound_init"></span>
		                            </td>
		                            <td style="font-size:9px;">
		                                <input type="checkbox" dojoType="dijit.form.CheckBox" id="filter_upstream_downstream_init">
		                                <span id="span_upstream_downstream_init"></span><span style="color:red;" id="span_filter_upstream_downstream_multi_compound_init"></span>
		                            </td>
		                            <td style="font-size:9px;">
		                                <input type="checkbox" dojoType="dijit.form.CheckBox" id="filter_intronic_init">
		                                <span id="span_intronic_init"></span><span style="color:red;" id="span_filter_intronic_multi_compound_init"></span>
		                            </td>
		                            <td style="font-size:9px;" id="td_filter_intergenic_multi_compound_init" hidden>
		                                <input type="checkbox" dojoType="dijit.form.CheckBox" id="filter_intergenic_init">
		                                <span id="span_intergenic_init"></span><span style="color:red;" id="span_filter_intergenic_multi_compound_init"></span>
		                            </td>
		                        </tr>
		                    </table>
		                </td>
	                </table>
	                </center>
	            </div>
			    <br><br>
			    <br><br>
				<center><b><span style="font-size:14px;">CHOOSE FILTERS FOR SECOND VARIANT</span></b></center>
				<br><br>
	            <div dojoType="dijit.Toolbar" style="font-size:9px;background-color:#E3F1FF;" id="toolbar_fam_compound_second_var">
	                <center>
	                <table>
	                    <td style="padding-left:10px;"> 
	                        <div><span class="filterLabelActif2">DB Public</span></div>
	                    </td>
	                    <td>
	                        <!-- DB public -->
	                        <div jsId="dd_db_public_2" data-dojo-type="dijit.form.DropDownButton" data-dojo-props="iconClass:'dijitIconFilter'">
	                            <span>Options (All)</span>
	                            <div data-dojo-type="dijit.TooltipDialog" onHide='update_choice_filter()' >
	                                <div  dojoType="dijit.Toolbar" style ="font-size : 10px;">
	                                    <table style="border:1px solid #9f9f9f;">
	                                        <!--
	                                        <td>
	                                            <div style="padding:5px;border:1px solid #9f9f9f;" id="div_b_global">
	                                                <table>
	                                                    <tr>
	                                                        <span><i><u>Global</i></u></span>
	                                                    </tr>
	                                                    <tr>
	                                                        <td style="padding:5px;"><input type="checkbox" id="filter_clinical_2" data-dojo-type="dojox/mobile/Switch" value="on"  leftLabel="Clinical" rightLabel="Clinical" style="width: 75px;"></td>
	                                                        <td style="padding:5px;display:none;"><input type="checkbox" id="filter_nofreq_2" data-dojo-type="dojox/mobile/Switch" value="off"  leftLabel="No Freq" rightLabel="No Freq" style="width: 65px;"></td>
	                                                    </tr>
	                                                </table>
	                                                
	                                            </div>
	                                        </td>
	                                        <td>
	                                            <div style="padding:5px;border:1px solid #9f9f9f;" id="div_b_somatic">
	                                                <table>
	                                                    <tr>
	                                                        <span><i><u>With Somatic Model</i></u></span>
	                                                    </tr>
	                                                    <tr>
	                                                        <td style="padding:5px;"><input type="checkbox" onmouseleave="checkSomaticButton('filter_not_cosmic')" id="filter_not_cosmic_2" data-dojo-type="dojox/mobile/Switch" value="on"  leftLabel="Not Cosmic" rightLabel="Not Cosmic" style="width: 90px;"></td>
	                                                        <td style="padding:5px;"><input type="checkbox" onmouseleave="checkSomaticButton('filter_cosmic')" id="filter_cosmic_2" data-dojo-type="dojox/mobile/Switch" value="on"  leftLabel="In Cosmic" rightLabel="In Cosmic" style="width: 90px;"></td>
	                                                    </tr>
	                                                </table>
	                                            </div>
	                                        </td>
	                                        -->
	                                        <td style="padding:5px;"><input type="checkbox" id="filter_clinical_2" data-dojo-type="dojox/mobile/Switch" value="on" leftLabel="Clinical" rightLabel="Clinical" style="width:65px;"></td>
	                                        <td style="padding:5px;display:none;"><input type="checkbox" id="filter_nofreq_2" data-dojo-type="dojox/mobile/Switch" value="off"  leftLabel="No Freq" rightLabel="No Freq" style="width: 65px;"></td>
	                                        <td style="padding:5px;display:none;"><input type="checkbox" onmouseleave="checkSomaticButton('filter_not_cosmic_2')" id="filter_not_cosmic_2" data-dojo-type="dojox/mobile/Switch" value="on"  leftLabel="Not Cosmic" rightLabel="Not Cosmic" style="width: 90px;"></td>
	                                        <td style="padding:5px;display:none;"><input type="checkbox" onmouseleave="checkSomaticButton('filter_cosmic_2')" id="filter_cosmic_2" data-dojo-type="dojox/mobile/Switch" value="on"  leftLabel="In Cosmic" rightLabel="In Cosmic" style="width: 90px;"></td>
	                                    </table>
	                                </div>
	                            </div>
	                        </div>
	                        <br>
	                        <div>
	                            <table align="center" valign="center">
	                                <td>
	                                    <div id="slider_frequence_2" onChange="check_slider_frequence_2()" jsId="slider_frequence_2" data-dojo-type="dijit/form/HorizontalSlider" aria-label="slider 3" data-dojo-props='name:"horizontal2",minimum:1,value:5,maximum:5,discreteValues:5,showButtons:false,intermediateChanges:true,slideDuration:0,style:"width:150px; height: 25px;"'>
	                                        <div data-dojo-type="dijit/form/HorizontalRule" data-dojo-props='container:"bottomDecoration", count:5, style:{height:"5px"}'> </div>
	                                        <ol data-dojo-type="dijit/form/HorizontalRuleLabels" data-dojo-props='container:"bottomDecoration", style:{height:"1em", fontSize:"100%"}'>
	                                            <li><font color="#EA3434">&#10877;1&#8241;</font></li>
	                                            <li><font color="#EA3434">&#10877;1&#8240;</font></li>
	                                            <li><font color="#EAA134">&#10877;1&#37;</font></li>
	                                            <li><font color="#EACC34">&#10877;5&#37;</font></li>
	                                            <li><font color="#28A24C">All</font></li>
	                                        </ol>
	                                    </div>
	                                </td>
	                            </table>
	                        </div>
	                    </td>
	                    <td style="padding-left: 10px"> 
	                        <div><span class="filterLabelActif2">Check Deja Vu</span></div>
	                  	</td>
	                   <td>
	                        <div id="slider_dejavu_2" jsId="slider_dejavu_2" onChange="check_slider_dejavu('second_slider')" data-dojo-type="dijit/form/HorizontalSlider" aria-label="slider 3" data-dojo-props='name:"horizontal2",minimum:0,value:100,maximum:100,discreteValues:100,showButtons:false,intermediateChanges:true,slideDuration:0,style:"width:230px; height: 25px;margin-left:20px;"' >
	                            <div>
	                                <div data-dojo-type="dijit/form/HorizontalRule" data-dojo-props='container:"bottomDecoration", count:11, style:{height:"5px"}'> </div>
	                                <ol data-dojo-type="dijit/form/HorizontalRuleLabels" data-dojo-props='container:"bottomDecoration", style:{height:"1em", fontSize:"100%"}'>
	                                    <li><span><font color="#EA3434">0</font></span></li>
	                                    <li><span><font color="#EA3434">10</font></span></li>
	                                    <li><span><font color="#EAA134">20</font></span></li>
	                                    <li><span><font color="#EAA134">30</font></span></li>
	                                    <li><span><font color="#EACC34">40</font></span></li>
	                                    <li><span><font color="#EACC34">50</font></span></li>
	                                    <li><span><font color="#28A24C">60</font></span></li>
	                                    <li><span><font color="#28A24C">70</font></span></li>
	                                    <li><span><font color="#28A24C">80</font></span></li>
	                                    <li><span><font color="#28A24C">90</font></span></li>
	                                    <li><span id="nb_projects_2"/></li>
	                                </ol>
	                                <ol data-dojo-type="dijit/form/HorizontalRuleLabels" data-dojo-props="container: 'topDecoration'" style="height: 1.3em;">
	                                    <li><font color="#EA3434"><span><i>None</i></span></font></li>
	                                    <li><span id="text_dejavu_2"><i><b>Others</b> Projects: </i></span><span style="font-weight: bold;color: #28A24C" id ="nb_dejavu_2"></li>
	                                    <li><font color="#28A24C"><span><i>All</i></span></font></li>
	                                </ol>
	                            </div>
	                        </div>
	                    </td>
	                    <td style="padding-left: 10px"> 
	                        <div><span class="filterLabelActif2">Annotations</span></div>
	                  	</td>
	                    <td style="padding-left: 10px;">
		                    <table>
		                        <tr>
		                            <td style="font-size:9px;">
		                                <input type="checkbox" dojoType="dijit.form.CheckBox" id="filter_maturemirna_2">
		                                <span id="span_maturemirna_2"></span><span style="color:red;" id="span_filter_maturemirna_multi_compound_2"></span>
		                            </td>
		                            <td style="font-size:9px;">
		                                <input type="checkbox" dojoType="dijit.form.CheckBox" id="filter_essential_splicing_2">
		                                <span id="span_essential_splicing_2"></span><span style="color:red;" id="span_filter_essential_splicing_multi_compound_2"></span>
		                            </td>
		                            <td style="font-size:9px;">
		                                <input type="checkbox" dojoType="dijit.form.CheckBox" id="filter_frameshift_2">
		                                <span id="span_frameshift_2"></span><span style="color:red;" id="span_filter_frameshift_multi_compound_2"></span>
		                            </td>
		                            <td style="font-size:9px;">
		                                <input type="checkbox" dojoType="dijit.form.CheckBox" id="filter_stop_2">
		                                <span id="span_stop_2"></span><span style="color:red;" id="span_filter_stop_multi_compound_2"></span>
		                            </td>
		                            <td style="font-size:9px;">
		                                <input type="checkbox" dojoType="dijit.form.CheckBox" id="filter_phase_2">
		                                <span id="span_phase_2"></span><span style="color:red;" id="span_filter_phase_multi_compound_2"></span>
		                            </td>
		                        </tr>
		                        <tr>
		                            <td style="font-size:9px;">
		                                <input type="checkbox" dojoType="dijit.form.CheckBox" id="filter_ncrna_2">
		                                <span id="span_ncrna_2"></span><span style="color:red;" id="span_filter_ncrna_multi_compound_2"></span>
		                            </td>
		                            <td style="font-size:9px;">
		                                <input type="checkbox" dojoType="dijit.form.CheckBox" id="filter_splice_site_2">
		                                <span id="span_splice_site_2"></span><span style="color:red;" id="span_filter_splice_site_multi_compound_2"></span>
		                            </td>
		                            <td style="font-size:9px;">
		                                <input type="checkbox" dojoType="dijit.form.CheckBox" id="filter_predicted_splice_site_2">
		                                <span id="span_predicted_splice_site_2"></span><span style="color:red;" id="span_filter_predicted_splice_site_multi_compound_2"></span>
		                            </td>
		                            <td style="font-size:9px;">
		                                <input type="checkbox" dojoType="dijit.form.CheckBox" id="filter_nonsynonymous_2">
		                                <span id="span_nonsynonymous_2"></span><span style="color:red;" id="span_filter_nonsynonymous_multi_compound_2"></span>
		                            </td>
		                            <td style="font-size:9px;">
		                                <input type="checkbox" dojoType="dijit.form.CheckBox" id="filter_nonframeshift_2">
		                                <span id="span_nonframeshift_2"></span><span style="color:red;" id="span_filter_nonframeshift_multi_compound_2"></span>
		                            </td>
		                        </tr>
		                        <tr>
		                            <td style="font-size:9px;">
		                                <input type="checkbox" dojoType="dijit.form.CheckBox" id="filter_pseudogene_2">
		                                <span id="span_pseudogene_2"></span><span style="color:red;" id="span_filter_pseudogene_multi_compound_2"></span>
		                            </td>
		                            <td style="font-size:9px;">
		                                <input type="checkbox" dojoType="dijit.form.CheckBox" id="filter_utr_2">
		                                <span id="span_utr_2"></span><span style="color:red;" id="span_filter_utr_multi_compound_2"></span>
		                            </td>
		                            <td style="font-size:9px;">
		                                <input type="checkbox" dojoType="dijit.form.CheckBox" id="filter_silent_2">
		                                <span id="span_silent_2"></span><span style="color:red;" id="span_filter_silent_multi_compound_2"></span>
		                            </td>
		                            <td style="font-size:9px;">
		                                <input type="checkbox" dojoType="dijit.form.CheckBox" id="filter_upstream_downstream_2">
		                                <span id="span_upstream_downstream_2"></span><span style="color:red;" id="span_filter_upstream_downstream_multi_compound_2"></span>
		                            </td>
		                            <td style="font-size:9px;">
		                                <input type="checkbox" dojoType="dijit.form.CheckBox" id="filter_intronic_2">
		                                <span id="span_intronic_2"></span><span style="color:red;" id="span_filter_intronic_multi_compound_2"></span>
		                            </td>
		                            <td style="font-size:9px;" id="td_filter_intergenic_multi_compound_2" hidden>
		                                <input type="checkbox" dojoType="dijit.form.CheckBox" id="filter_intergenic_2">
		                                <span id="span_intergenic_2"></span><span style="color:red;" id="span_filter_intergenic_multi_compound_2"></span>
		                            </td>
		                        </tr>
		                    </table>
		                </td>
	                </table>
	                </center>
	            </div>
	            <br>
	            <!--
	            <div id="drop_type_model_families_compound_multi"  data-dojo-type="dijit/form/DropDownButton" data-dojo-props="iconClass:'treeIcon32nb'" style="float:right;"> 
                    <span>Genetic Model (None)</span>  
                    <div data-dojo-type="dijit/DropDownMenu" style="font-size:12px">
                        <div data-dojo-type="dijit/MenuItem" onClick="change_filtering_model_compound_multi('None')">None</div>
                        <div data-dojo-type="dijit/MenuSeparator"></div>
                        <div data-dojo-type="dijit/MenuItem" data-dojo-props="iconClass:'treeIcon32'" onClick="change_filtering_model_compound_multi('denovo')" id='b_fam_denovo_compound_multi'>
                            Denovo &nbsp;&nbsp;&nbsp;<img id='help_models_fam_denovo_compound_multi' src="../images/menu/help_2.png" margin-bottom="inherit"/>
                        </div>
                        <div data-dojo-type="dijit/Tooltip" data-dojo-props="connectId:'help_models_fam_denovo_compound_multi',position:['above']">
                            <span>
                                <b>Variations :</b><br>
                                &nbsp;&nbsp;-&nbsp;found in affected children<br>
                                &nbsp;&nbsp;-&nbsp;never found in non affected patients
                                <br>
                                <b>OR</b>
                                <br>
                                &nbsp;&nbsp;-&nbsp;HO in each parent<br>
                                &nbsp;&nbsp;-&nbsp;HE in affected children
                            </span>
                        </div>
                        <div data-dojo-type="dijit/MenuSeparator"></div>
                        <div data-dojo-type="dijit/MenuItem" data-dojo-props="iconClass:'treeIcon32'" onClick="change_filtering_model_compound_multi('strict-denovo')" id='b_fam_strict_denovo_compound_multi'>
                            Strict-denovo &nbsp;&nbsp;&nbsp;<img id='help_models_fam_strictdenovo_compound_multi' src="../images/menu/help_2.png" margin-bottom="inherit"/>
                        </div>
                        <div data-dojo-type="dijit/Tooltip" data-dojo-props="connectId:'help_models_fam_strictdenovo_compound_multi',position:['above']">
                            <span>
                                <b>Variations :</b><br>
                                &nbsp;&nbsp;-&nbsp;found in affected children<br>
                                &nbsp;&nbsp;-&nbsp;never found in non affected patients
                            </span>
                        </div>
                    </div>
                </div>
                -->
			</div>
		    <br><br>
		    <center>
                <button type="button" id="startButton_multi_compound" onClick="launch_compound_multi_annot()" onMouseOver="checkMessageError()" style="float=right">
                    <table>
                        <td>
                            <span style="font-size:10px;padding-bottom: 0px;"><img id='img_run_1' src="../images/polyicons/run_2.png"></span>
                        </td>
                        <td>
                            <span style="font-size:12px;"><b>&nbsp;&nbsp;RUN&nbsp;</b></span>
                        </td>
                    </table>
                </button>
            </center>
		    <br><br>
	    </div>
    </div>
    
    <div id="popup_hgmd" dojoType="dojox.widget.Dialog" dimensions="[600,300]" style="background-color:white">
        <div  id="div_popup_hgmd" jsId="div_popup_hgmd" data-dojo-type="dijit/layout/ContentPane" style="background-color:white">
		</div>
	</div>
 
<div dojoType="dijit.Dialog" jsId="dialog_edit_group" id="dialog_edit_group" title="Edit Groups">  
    <div  style="width:600px; height:300px;">
        <table>
            <tr>
                <td>
                    <center>
                        <div style="width:590px;height:270px;" dojoType="dojox.grid.DataGrid" id="gridEditGroup" jsId="gridEditGroup" structure="layoutEdit" style="dojoxGridHeader:none"></div>
                    </center>
                </td>
            </tr>
            <tr>
                <td>
                    <div dojoType="dijit.form.Button"  iconClass="plusIcon" showLabel="true" onClick='create_groups()'>
                        Add Groups
                    </div>
                    <div dojoType="dijit.form.Button"  iconClass="refreshIcon" showLabel="true" onClick="revert_group()" style="padding-left: 10px;">
                        Init All
                    </div>
                </td>
            </tr>
        </table> 
    </div>
</div>

<div dojoType="dijit.Dialog" jsId="waiting_xls_progress" id="waiting_xls_progress" style="width:350px;height:290px" >
    <center>
        <img id="wait2" src="../images/polyicons/wait18trans.gif" align="absmiddle"><span id="waiting_xls_progress_text"><br><br>Loading Data...</span>
        <br><br>
        <div data-dojo-type="dijit/ProgressBar" style="width:300px" data-dojo-id="myProgressBarXls" id="myProgressBarXls" data-dojo-props="maximum:125" hidden></div>
        <span><br><br><u>URL if necessary:</u><br><br></span>
        <textarea id="url_xls" name="url_xls" data-dojo-type="dijit/form/SimpleTextarea" style="width:300px; height:150px;overflow-x:auto;"/>
    </center>
</div>
 
    <div dojoType="dijit.Dialog" jsId="dialog_xls_alert" id="dialog_xls_alert" title="Export XLS" style="width:500px;height:280px" >
        <center>
            <table>
                <tr><br><br></tr>
                <tr>
                    <span><u><b>Sorry, export XLS by var is impossible: ERROR process or too much variants (LIMIT: 10000 uniq variants)....</u></b><br><br>Please reduce your number of variant or use export on a single chromosome... Thanks !</span><br>
                </tr>
                <tr><br><br><br></tr>
                <tr>
                    <span><b><u>URL ARGUMENTS FOR XLS EXPORT:</u></b></span><br>
                </tr>
                <tr><br><br></tr>
                <tr>
                    <textarea id="url_xls_error" name="url_xls_error" data-dojo-type="dijit/form/SimpleTextarea" style="width:450px; height:150px;overflow-x:auto;"/>
                </tr>
            </table>
        </center>
    </div>

<!-- formulaire pour exporter les donnes du tableau au format xls (cf cgi authentification.pl-->    
     <form id="formexport" name="formexport" enctype="multipart/form-data"  action="/polymorphism-cgi/authentification.pl" method="post">
        <input name="type"  value="export" type = "hidden">
        <input id="filename"  name="filename"  value="zzz" type = "hidden">
     </form>
    
    <!-- POPUP PROJECT DETAILS 
    
    <div id="popupDetailsProject" jsId="popupDetailsProject" dojoType="dojox.widget.Dialog" sizeToViewport="true" viewPortHeight="85%" viewportPadding="200">
        <center>
            <br><br>
            <div>
                <span style="margin-left:3px;" id="popup_text"></span> [ PROJECT DETAILS ]
            </div>
            <br><br><br>
        </center>
    </div>
    
    -->

    </body>
    </html>

