<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Login OTP</title>
    <!-- Lien vers Bootstrap 5 -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
	<script type="text/javascript" src="../js/polyjs/include.polyviewer.js" djConfig="parseOnLoad:true"></script>
	
	
	<script type="text/javascript" >
	
		function get_global_infos(){
			document.getElementById("s_id").innerHTML = "<img src='../images/polyicons/wait18trans.gif' align='absmiddle'/> Please wait...";
			document.getElementById("s_nom").innerHTML = '';
			document.getElementById("s_prenom").innerHTML = '';
			document.getElementById("s_mail").innerHTML = '';
			document.getElementById("s_login").innerHTML = '';
			document.getElementById("s_equipeid").innerHTML = '';
			document.getElementById("s_pw").innerHTML = '';
			document.getElementById("s_otp_infos").innerHTML = '';
			document.getElementById("s_alamut_infos").innerHTML = '';
			
			var login = document.getElementById('username').value;
			var url = url_path + "/login/get_login_infos.pl";
			url += "?login=" + login;
			url += "&show_global_infos=1";
			
			$.getJSON( url, function( data ) {
				document.getElementById("s_id").innerHTML = data.USER_ID;
				document.getElementById("s_nom").innerHTML = data.NOM_RESPONSABLE;
				document.getElementById("s_prenom").innerHTML = data.PRENOM_U;
				document.getElementById("s_mail").innerHTML = data.EMAIL;
				document.getElementById("s_login").innerHTML = data.LOGIN;
				document.getElementById("s_equipeid").innerHTML = data.EQUIPE_ID;
				document.getElementById("s_pw").innerHTML = data.PW;
				document.getElementById("s_otp_infos").innerHTML = data.otp;
				document.getElementById("s_alamut_infos").innerHTML = data.alamut;
		    })
		};
		
		function generate_otp_key(login) {
			document.getElementById("s_otp_infos").innerHTML = "<img src='../images/polyicons/wait18trans.gif' align='absmiddle'/> Please wait...";
			var url = url_path + "/login/get_login_infos.pl";
			url += "?login=" + login;
			url += "&generate_otp_key=1";
			$.getJSON( url, function( data ) {
				document.getElementById("s_otp_infos").innerHTML = data.otp;
		    })
		}
		
	</script>
</head>





<body>

    <div class="container mt-5">
        <h2 class="mb-4">Login infos</h2>
        <div class="mb-3">
            <label for="username" class="form-label">Check login</label>
            <input type="text" class="form-control" id="username" placeholder="Entrez votre nom d'utilisateur">
        </div>
        <button class="btn btn-primary" onClick="get_global_infos()">Get USER infos</button>
        
        <br><br>
        
        <!-- Tableau -->
        <table class="table table-bordered">
            <thead>
                <tr>
                    <th>UserId</th>
                    <th>NOM</th>
                    <th>Prenom</th>
                    <th>Mail</th>
                    <th>Login</th>
                    <th>EquipeID</th>
                    <th>PW</th>
                    <th>OTP Auth</th>
                    <th>Alamut Auth</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td> <span id='s_id'></span> </td>
                    <td> <span id='s_nom'></span> </td>
                    <td> <span id='s_prenom'></span> </td>
                    <td> <span id='s_mail'></span> </td>
                    <td> <span id='s_login'></span> </td>
                    <td> <span id='s_equipeid'></span> </td>
                    <td> <span id='s_pw'></span> </td>
                    <td> <span id='s_otp_infos'></span> </td>
                    <td> <span id='s_alamut_infos'></span> </td>
                </tr>
            </tbody>
        </table>
        
    </div>

</body>
</html>